FILE_NAME,QUERY_NAME,SECONDARY_FLAG,DESCR,PRIORITIZATION,ERROR_LEVEL,ERROR_WEIGHT,AB977_IND,STATUS,SYNTAX
AFFILIATION,AFFILIATION_1,N,DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE, 'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
AFFILIATION,AFFILIATION_2,N,DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
AFFILIATION,AFFILIATION_3,N,USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
AFFILIATION,AFFILIATION_4,N,EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then SRC.STG_MD5_HASH_VALUE else  AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) AS BUSINESS_KEY_VALUE FROM STAGING.PSTG_AFFILIATION SRC  join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME ,  (case when BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME,  BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND  EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL  ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
AFFILIATION,AFFILIATION_5,N,'PROJECT_ID IS NULL',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_ID IS NULL"
AFFILIATION,AFFILIATION_6,N,'AFFILIATION_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'AFFILIATION_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'AFFILIATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE AFFILIATION_ID IS NULL"
AFFILIATION,AFFILIATION_7,N,'RES_PROJECT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'RES_PROJECT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'RES_PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE RES_PROJECT_ID IS NULL"
AFFILIATION,AFFILIATION_8,N,'AFFILIATION_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'AFFILIATION_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'AFFILIATION_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(AFFILIATION_ID)>32"
AFFILIATION,AFFILIATION_9,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PROJECT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_ID)>32"
AFFILIATION,AFFILIATION_10,N,'RES_PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'RES_PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'RES_PROJECT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(RES_PROJECT_ID)>32"
AFFILIATION,AFFILIATION_11,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
AFFILIATION,AFFILIATION_12,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
AFFILIATION,AFFILIATION_13,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_AFFILIATION' TABLE_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
AFFILIATION,AFFILIATION_14,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_AFFILIATION' TABLE_NAME, (case when A.AFFILIATION_ID||'|'||A.PROJECT_ID||'|'||A.RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.AFFILIATION_ID||a.PROJECT_ID||A.RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
AFFILIATION,AFFILIATION_15,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_AFFILIATION' TABLE_NAME, (case when AFFILIATION_ID||'|'||PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID is null then STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
AFFILIATION,AFFILIATION_16,N,'AFFILIATION_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when A.AFFILIATION_ID||'|'||A.PROJECT_ID||'|'||A.RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.AFFILIATION_ID||A.PROJECT_ID||A.RES_PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.AFFILIATION_ID||A.PROJECT_ID||A.RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'AFFILIATION_ID IS NOT UNIQUE' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'AFFILIATION_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT AFFILIATION_ID, SOURCE_FILE FROM STAGING.PSTG_AFFILIATION GROUP BY AFFILIATION_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.AFFILIATION_ID = C.AFFILIATION_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.AFFILIATION_ID IS NOT NULL"
ASSESSMENT,ASSESSMENT_1,N,'ASSESSMENT_LOCATION IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_LOCATION IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_LOCATION IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_LOCATION is null"
ASSESSMENT,ASSESSMENT_2,N,'ASSESSMENT_TYPE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_TYPE IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_TYPE IS NULL"
ASSESSMENT,ASSESSMENT_3,N,'ASSESSMENT_LEVEL IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_LEVEL IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_LEVEL IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_LEVEL IS NULL"
ASSESSMENT,ASSESSMENT_4,N,'PRIORITIZATION_STATUS IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'PRIORITIZATION_STATUS IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'PRIORITIZATION_STATUS IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PRIORITIZATION_STATUS IS NULL"
ASSESSMENT,ASSESSMENT_5,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then SRC.STG_MD5_HASH_VALUE  else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) AS BUSINESS_KEY_VALUE, SRC.ASSESSMENT_DATE  FROM STAGING.PSTG_ASSESSMENT SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME ,  (case when BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME,  BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID  AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL,  'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL  THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL)  THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL)  OR (A.SOURCE_EXPORT_ID is null)"
ASSESSMENT,ASSESSMENT_6,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
ASSESSMENT,ASSESSMENT_7,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
ASSESSMENT,ASSESSMENT_8,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
ASSESSMENT,ASSESSMENT_9,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
ASSESSMENT,ASSESSMENT_10,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
ASSESSMENT,ASSESSMENT_11,N,'ASSESSMENT_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_DATE IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_DATE IS NULL"
ASSESSMENT,ASSESSMENT_12,N,'ASSESSMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_ID IS NULL"
ASSESSMENT,ASSESSMENT_13,N,'ASSESSMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_ID)>32"
ASSESSMENT,ASSESSMENT_14,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
ASSESSMENT,ASSESSMENT_15,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
ASSESSMENT,ASSESSMENT_16,N,'ASSESSMENT_LOCATION EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_LOCATION EXCEEDS 250 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_LOCATION EXCEEDS 250 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_LOCATION)>250"
ASSESSMENT,ASSESSMENT_17,N,'ASSESSMENT_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_TYPE IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ASSESSMENT_TYPE)=FALSE AND TO_CHAR(ASSESSMENT_TYPE) NOT LIKE '%.00'"
ASSESSMENT,ASSESSMENT_18,N,'ASSESSMENT_LEVEL IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_LEVEL IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_LEVEL MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ASSESSMENT_LEVEL)=FALSE AND TO_CHAR(ASSESSMENT_LEVEL) NOT LIKE '%.00'"
ASSESSMENT,ASSESSMENT_19,N,'PRIORITIZATION_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'PRIORITIZATION_STATUS IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'PRIORITIZATION_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PRIORITIZATION_STATUS)=FALSE AND TO_CHAR(PRIORITIZATION_STATUS) NOT LIKE '%.00'"
ASSESSMENT,ASSESSMENT_20,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
ASSESSMENT,ASSESSMENT_21,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
ASSESSMENT,ASSESSMENT_22,N,'ASSESSMENT_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ASSESSMENT_TYPE = c.VALID_VALUES and c.List_Name = '4.19.3' WHERE c.VALID_VALUES IS NULL and a.ASSESSMENT_TYPE is not null"
ASSESSMENT,ASSESSMENT_23,N,'ASSESSMENT_LEVEL NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_LEVEL NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_LEVEL CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ASSESSMENT_LEVEL = c.VALID_VALUES and c.List_Name = '4.19.4' WHERE c.VALID_VALUES IS NULL and a.ASSESSMENT_LEVEL is not null"
ASSESSMENT,ASSESSMENT_24,N,'PRIORITIZATION_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'PRIORITIZATION_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'PRIORITIZATION_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PRIORITIZATION_STATUS = c.VALID_VALUES and c.List_Name = '4.19.7' WHERE c.VALID_VALUES IS NULL and a.PRIORITIZATION_STATUS is not null"
ASSESSMENT,ASSESSMENT_25,N,'ASSESSMENT_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ASSESSMENT' TABLE_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_DATE NOT IN FORMAT YYYY-MM-DD' DESCR,	'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(ASSESSMENT_DATE,1,10) NOT LIKE '%____-__-__%'"
ASSESSMENT,ASSESSMENT_26,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ASSESSMENT' TABLE_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
ASSESSMENT,ASSESSMENT_27,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ASSESSMENT' TABLE_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
ASSESSMENT,ASSESSMENT_28,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ASSESSMENT' TABLE_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE is null then STG_MD5_HASH_VALUE else ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
ASSESSMENT,ASSESSMENT_29,N,'ASSESSMENT_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT' TABLE_NAME , (case when A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.ASSESSMENT_DATE is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.ASSESSMENT_DATE is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.ASSESSMENT_DATE end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID IS NOT UNIQUE' DESCR , 'WARNING' ERROR_LEVEL, 'ASSESSMENT_DATE' ERROR_DATE_FIELD_NAME, DATE(ASSESSMENT_DATE) ERROR_DATE_VALUE, 'ASSESSMENT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT ASSESSMENT_ID, SOURCE_FILE FROM STAGING.PSTG_ASSESSMENT GROUP BY ASSESSMENT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.ASSESSMENT_ID = C.ASSESSMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ASSESSMENT_ID IS NOT NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_1,N,ASSESSMENT_QUESTIONS_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_QUESTIONS_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_QUESTIONS_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_QUESTIONS_ID IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_2,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then SRC.STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) AS BUSINESS_KEY_VALUE  FROM STAGING.PSTG_ASSESSMENT_QUESTIONS SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME , (case when BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_3,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_4,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_5,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_6,N,'ASSESSMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_ID IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_7,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_8,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_9,N,'ASSESSMENT_QUESTIONS_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_QUESTIONS_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_QUESTIONS_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_QUESTIONS_ID)>32"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_10,N,'ASSESSMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_ID)>32"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_11,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_12,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_13,N,'ASSESSMENT_QUESTION_GROUP EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_QUESTION_GROUP EXCEEDS 250 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_QUESTION_GROUP EXCEEDS 250 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_QUESTION_GROUP)>250"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_14,N,'ASSESSMENT_QUESTION_ORDER IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_QUESTION_ORDER IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_QUESTION_ORDER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(ASSESSMENT_QUESTION_ORDER) NOT LIKE '%.00' AND IS_INTEGER(ASSESSMENT_QUESTION_ORDER)=FALSE"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_15,N,'ASSESSMENT_QUESTION EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_QUESTION EXCEEDS 250 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_QUESTION EXCEEDS 250 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_QUESTION)>250"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_16,N,'ASSESSMENT_ANSWER EXCEEDS 500 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_ANSWER EXCEEDS 500 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_ANSWER EXCEEDS 500 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_ANSWER)>500"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_17,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_18,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_19,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'ASSESSMENT_QUESTION' TABLE_NAME,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_20,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'ASSESSMENT_QUESTION' TABLE_NAME,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_21,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'ASSESSMENT_QUESTION' TABLE_NAME,(case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID is null then STG_MD5_HASH_VALUE else ASSESSMENT_QUESTIONS_ID||'|'||ASSESSMENT_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_22,N,'ASSESSMENT_QUESTIONS_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' TABLE_NAME ,(case when A.ASSESSMENT_QUESTIONS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_QUESTIONS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then STG_MD5_HASH_VALUE else A.ASSESSMENT_QUESTIONS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_QUESTIONS_ID IS NOT UNIQUE' DESCR ,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_QUESTIONS_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT ASSESSMENT_QUESTIONS_ID, SOURCE_FILE FROM STAGING.PSTG_ASSESSMENT_QUESTIONS GROUP BY ASSESSMENT_QUESTIONS_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.ASSESSMENT_QUESTIONS_ID = C.ASSESSMENT_QUESTIONS_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ASSESSMENT_QUESTIONS_ID IS NOT NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_1,N,'ASSESSMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_ID IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_2,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_3,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_4,N,'ASSESSMENT_RESULT_TYPE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_RESULT_TYPE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_RESULT_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_RESULT_TYPE IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_5,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_6,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_7,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_8,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.ASSESSMENT_RESULTS_ID||'|'||SRC.ASSESSMENT_ID||'|'||SRC.ENROLLMENT_ID||'|'||SRC.PERSONAL_ID is null then SRC.STG_MD5_HASH_VALUE else SRC.ASSESSMENT_RESULTS_ID||'|'||SRC.ASSESSMENT_ID||'|'||SRC.ENROLLMENT_ID||'|'||SRC.PERSONAL_ID end) AS BUSINESS_KEY_VALUE  FROM STAGING.PSTG_ASSESSMENT_RESULTS SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME ,  (case when a.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_9,N,'ASSESSMENT_RESULTS_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_RESULTS_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_RESULTS_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ASSESSMENT_RESULTS_ID IS NULL"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_10,N,'ASSESSMENT_RESULTS_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_RESULTS_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_RESULT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_RESULTS_ID)>32"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_11,N,'ASSESSMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_ID)>32"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_12,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_13,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_14,N,'ASSESSMENT_RESULT_TYPE EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_RESULT_TYPE EXCEEDS 250 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_RESULT_TYPE EXCEEDS 250 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_RESULT_TYPE)>250"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_15,N,'ASSESSMENT_RESULT EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_RESULT EXCEEDS 250 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_RESULT EXCEEDS 250 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ASSESSMENT_RESULT)>250"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_16,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_17,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_18,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_19,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_20,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_21,N,'ASSESSMENT_RESULTS_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' TABLE_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.ASSESSMENT_RESULTS_ID||'|'||A.ASSESSMENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASSESSMENT_RESULTS_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ASSESSMENT_RESULTS_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_ASSESSMENT_RESULTS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT ASSESSMENT_RESULTS_ID, SOURCE_FILE FROM STAGING.PSTG_ASSESSMENT_RESULTS GROUP BY ASSESSMENT_RESULTS_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.ASSESSMENT_RESULTS_ID = C.ASSESSMENT_RESULTS_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ASSESSMENT_RESULTS_ID IS NOT NULL"
CLIENT,CLIENT_1,N,'NAME_DATA_QUALITY IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NAME_DATA_QUALITY IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NAME_DATA_QUALITY IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NAME_DATA_QUALITY IS NULL"
CLIENT,CLIENT_2,N,APPROXIMATE OR PARTIAL SSN REPORTED',,WARNING,1,0,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'APPROXIMATE, PARTIAL OR INVALID SSN REPORTED' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'APPROXIMATE, PARTIAL OR INVALID SSN REPORTED' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NOT REGEXP_LIKE(SSN,'^[[:digit:]]{9}$') OR SSN_DATA_QUALITY = 2"
CLIENT,CLIENT_3,N,'SSN_DATA_QUALITY IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'SSN_DATA_QUALITY IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'SSN_DATA_QUALITY IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SSN_DATA_QUALITY IS NULL"
CLIENT,CLIENT_4,N,'DOB_DATA_QUALITY IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DOB_DATA_QUALITY IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DOB_DATA_QUALITY IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DOB_DATA_QUALITY IS NULL"
CLIENT,CLIENT_5,N,"'AM_IND_AK_NATIVE IS NULL OR  NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'AM_IND_AK_NATIVE IS NULL OR  NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'AM_IND_AK_NATIVE IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE AM_IND_AK_NATIVE IS NULL OR AM_IND_AK_NATIVE NOT IN (0,1)"
CLIENT,CLIENT_6,N,"'ASIAN IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASIAN IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'ASIAN IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE ASIAN IS NULL OR ASIAN NOT IN (0,1)"
CLIENT,CLIENT_7,N,"'BLACK_AF_AMERICAN IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'BLACK_AF_AMERICAN IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'BLACK_AF_AMERICAN IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE BLACK_AF_AMERICAN IS NULL OR BLACK_AF_AMERICAN NOT IN (0,1)"
CLIENT,CLIENT_8,N,"'NATIVE_HI_PACIFIC IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NATIVE_HI_PACIFIC IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NATIVE_HI_PACIFIC IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NATIVE_HI_PACIFIC IS NULL OR NATIVE_HI_PACIFIC NOT IN (0,1)"
CLIENT,CLIENT_9,N,"'WHITE IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WHITE IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WHITE IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE WHITE IS NULL OR WHITE NOT IN (0,1)"
CLIENT,CLIENT_10,N,RACE_NONE IS NOT NULL AND ALL OTHER RACE FIELDS = 0 OR 99',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'RACE_NONE IS NOT NULL AND ALL OTHER RACE FIELDS = 0 OR 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'RACE_NONE CAN ONLY BE NON-NULL ONLY IF ALL OTHER RACE FIELDS = 0 OR 99.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE (RACE_NONE IS NULL AND ((AM_IND_AK_NATIVE IN (0,99)) AND (ASIAN IN (0,99)) AND (BLACK_AF_AMERICAN IN (0,99)) AND (NATIVE_HI_PACIFIC IN (0,99)) AND (WHITE IN (0,99)) AND (HISPANIC_LATIN_AEO IN (0,99)) AND (MID_EAST_N_AFRICAN IN (0,99)))) OR RACE_NONE IS NOT NULL AND ((AM_IND_AK_NATIVE NOT IN (0,99)) OR (ASIAN NOT IN (0,99)) OR (BLACK_AF_AMERICAN NOT IN (0,99)) OR (NATIVE_HI_PACIFIC NOT IN (0,99)) OR (WHITE NOT IN (0,99)) OR (HISPANIC_LATIN_AEO NOT IN (0,99)) OR (MID_EAST_N_AFRICAN NOT IN (0,99)))"
CLIENT,CLIENT_11,N,"'WOMAN IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WOMAN IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WOMAN IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE WOMAN IS NULL OR WOMAN NOT IN (0,1)"
CLIENT,CLIENT_12,N,"'MAN IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'MAN IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MAN IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE MAN IS NULL OR MAN NOT IN (0,1)"
CLIENT,CLIENT_13,N,"'NON_BINARY IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NON_BINARY IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NON_BINARY IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NON_BINARY IS NULL OR NON_BINARY NOT IN (0,1)"
CLIENT,CLIENT_14,N,"'TRANSGENDER IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'TRANSGENDER IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'TRANSGENDER IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TRANSGENDER IS NULL OR TRANSGENDER NOT IN (0,1)"
CLIENT,CLIENT_15,N,"'QUESTIONING IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'QUESTIONING IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'QUESTIONING IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE QUESTIONING IS NULL OR QUESTIONING NOT IN (0,1)"
CLIENT,CLIENT_16,N,'GENDER_NONE IS NULL WHEN ALL OTHER GENDER FIELDS = 0 OR 99',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'GENDER_NONE IS NULL WHEN ALL OTHER GENDER FIELDS = 0 OR 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'GENDER_NONE IS NULL AND ALL ALL OTHER GENDER FIELDS = 0 OR 99' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE GENDER_NONE IS NULL AND (WOMAN IN (0,99)) AND (MAN IN (0,99)) AND (NON_BINARY IN (0,99)) AND (CULTURALLY_SPECIFIC IN (0,99)) AND (TRANSGENDER IN (0,99)) AND (QUESTIONING IN (0,99)) AND (DIFFERENT_IDENTITY IN (0,99))"
CLIENT,CLIENT_17,N,VETERAN_STATUS IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'VETERAN_STATUS IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'VETERAN_STATUS IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE VETERAN_STATUS IS NULL"
CLIENT,CLIENT_18,N,'YEAR_ENTERED_SERVICE NOT BETWEEN 1920 AND CURRENT YEAR',,WARNING,1,0,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (CASE WHEN A.PERSONAL_ID IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'PERSONAL_ID' END) BUSINESS_KEY_FIELD_NAME, (CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END) BUSINESS_KEY_VALUE,'YEAR_ENTERED_SERVICE NOT BETWEEN 1920 AND CURRENT YEAR' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'YEAR_ENTERED_SERVICE NOT BETWEEN 1920 AND CURRENT YEAR' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_ENROLLMENT E on A.personal_id=E.personal_id and A.source_file=E.source_file LEFT JOIN STAGING.PSTG_FUNDER F on F.project_id=E.project_id and F.source_file=E.source_file WHERE A.VETERAN_STATUS=1 and (YEAR_ENTERED_SERVICE < 1920 OR YEAR_ENTERED_SERVICE > (SELECT YEAR(CURRENT_TIMESTAMP))) And F.funder in (27,30,33,37,38,39,40,41,42,45,20)"
CLIENT,CLIENT_19,N,'YEAR_SEPARATED NOT BETWEEN 1920 AND CURRENT YEAR',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'PERSONAL_ID' END) BUSINESS_KEY_FIELD_NAME, (CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END) BUSINESS_KEY_VALUE,'YEAR_SEPARATED NOT BETWEEN 1920 AND CURRENT YEAR' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'YEAR_SEPARATED NOT BETWEEN 1920 AND CURRENT YEAR' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_ENROLLMENT E on A.personal_id=E.personal_id and A.source_file=E.source_file LEFT JOIN STAGING.PSTG_FUNDER F on F.project_id=E.project_id and F.source_file=E.source_file WHERE A.VETERAN_STATUS=1 and (YEAR_SEPARATED < 1920 OR YEAR_SEPARATED > (SELECT YEAR(CURRENT_TIMESTAMP))) and F.funder in (27,30,33,37,38,39,40,41,42,45,20)"
CLIENT,CLIENT_20,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DATE_CREATED IS NULL"
CLIENT,CLIENT_21,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DATE_UPDATED IS NULL"
CLIENT,CLIENT_22,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE USER_ID IS NULL"
CLIENT,CLIENT_23,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.PERSONAL_ID is null then SRC.STG_MD5_HASH_VALUE else SRC.PERSONAL_ID end) AS BUSINESS_KEY_VALUE,  (case when SRC.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) AS BUSINESS_KEY_FIELD_NAME, EXIT_DATE FROM STAGING.PSTG_CLIENT SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and B.RUN_IND = 1  LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C  ON SRC.PERSONAL_ID = C.PERSONAL_ID AND SRC.SOURCE_FILE = C.SOURCE_FILE LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID  AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE,  'PSTG_CLIENT' TABLE_NAME , A.BUSINESS_KEY_FIELD_NAME, A.BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL'  WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING'  ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN  (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE  (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
CLIENT,CLIENT_24,N,"'CULTURALLY_SPECIFIC IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'CULTURALLY_SPECIFIC IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'CULTURALLY_SPECIFIC IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE CULTURALLY_SPECIFIC IS NULL OR CULTURALLY_SPECIFIC NOT IN (0,1)"
CLIENT,CLIENT_25,N,"'DIFFERENT_IDENTITY IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DIFFERENT_IDENTITY IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DIFFERENT_IDENTITY IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DIFFERENT_IDENTITY IS NULL OR DIFFERENT_IDENTITY NOT IN (0,1)"
CLIENT,CLIENT_26,N,'DIFFERENT_IDENTITY_TEXT IS NULL UNLESS DIFFERENT_IDENTITY = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DIFFERENT_IDENTITY_TEXT IS NULL UNLESS DIFFERENT_IDENTITY = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DIFFERENT_IDENTITY_TEXT SHOULD BE NON-NULL IF DIFFERENT_IDENTITY = 1' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE (DIFFERENT_IDENTITY_TEXT IS NULL AND DIFFERENT_IDENTITY = 1) OR (DIFFERENT_IDENTITY_TEXT IS NOT NULL AND DIFFERENT_IDENTITY <> 1)"
CLIENT,CLIENT_27,N,'CLIENT NAME IS ENCRYPTED',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED , A.EXPORT_ID , A.SOURCE_FILE , 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE ,'CLIENT NAME IS ENCRYPTED' DESCR ,'ERROR' ERROR_LEVEL ,'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE,'CLIENT NAME MAY BE ENCRYPTED' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LENGTH(FIRST_NAME) >=30 AND NOT CONTAINS(FIRST_NAME,' ')"
CLIENT,CLIENT_28,N,"'NAME_DATA_QUALITY IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NAME_DATA_QUALITY IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE Name_Data_Quality in (8, 9, 99)"
CLIENT,CLIENT_29,N,"'SSN_DATA_QUALITY IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'SSN_DATA_QUALITY IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SSN_DATA_QUALITY in (8, 9, 99)"
CLIENT,CLIENT_30,N,"'DOB_DATA_QUALITY IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DOB_DATA_QUALITY IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DOB_DATA_QUALITY in (8, 9, 99)"
CLIENT,CLIENT_31,N,'AM_IND_AK_NATIVE = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'AM_IND_AK_NATIVE = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE AM_IND_AK_NATIVE = 99"
CLIENT,CLIENT_32,N,'ASIAN = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASIAN = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE ASIAN = 99"
CLIENT,CLIENT_33,N,'BLACK_AF_AMERICAN = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'BLACK_AF_AMERICAN = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE BLACK_AF_AMERICAN = 99"
CLIENT,CLIENT_34,N,'NATIVE_HI_PACIFIC = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NATIVE_HI_PACIFIC = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NATIVE_HI_PACIFIC = 99"
CLIENT,CLIENT_35,N,'WHITE = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WHITE = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE WHITE = 99"
CLIENT,CLIENT_36,N,"'RACE_NONE IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'RACE_NONE IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE RACE_NONE IN (8,9,99)"
CLIENT,CLIENT_37,N,'WOMAN = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WOMAN = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE WOMAN = 99"
CLIENT,CLIENT_38,N,'MAN= 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'MAN= 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE MAN = 99"
CLIENT,CLIENT_39,N,'NON_BINARY = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NON_BINARY = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NON_BINARY = 99"
CLIENT,CLIENT_40,N,'TRANSGENDER = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'TRANSGENDER = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TRANSGENDER = 99"
CLIENT,CLIENT_41,N,'QUESTIONING = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'QUESTIONING = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE QUESTIONING = 99"
CLIENT,CLIENT_42,N,'CULTURALLY_SPECIFIC = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'CULTURALLY_SPECIFIC = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE CULTURALLY_SPECIFIC = 99"
CLIENT,CLIENT_43,N,'DIFFERENT_IDENTITY = 99',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DIFFERENT_IDENTITY = 99' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DIFFERENT_IDENTITY = 99"
CLIENT,CLIENT_44,N,"'GENDER_NONE IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'GENDER_NONE IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE GENDER_NONE = 99"
CLIENT,CLIENT_45,N,VETERAN_STATUS = 1 FOR PEOPLE <= 17',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'VETERAN_STATUS = 1 FOR PEOPLE <= 17' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'Veteran status indicated for a client 17 years old or younger.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 JOIN STAGING.PSTG_ENROLLMENT c on a.personal_id = c.personal_id LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE and a.source_file = c.source_file WHERE a.VETERAN_STATUS = 1 AND DATEDIFF(day,DATE(a.DOB), (CASE WHEN month(DATE(c.ENTRY_DATE)) in (1,2,3) THEN CONCAT(YEAR(DATE(c.ENTRY_DATE)),'-01-01') WHEN month(DATE(c.ENTRY_DATE)) in (4,5,6) THEN CONCAT(YEAR(DATE(c.ENTRY_DATE)),'-04-01') WHEN month(DATE(c.ENTRY_DATE)) in (7,8,9) THEN CONCAT(YEAR(DATE(c.ENTRY_DATE)),'-07-01') WHEN month(DATE(c.ENTRY_DATE)) in (10,11,12) THEN CONCAT(YEAR(DATE(c.ENTRY_DATE)),'-10-01') END))/365 <= 17"
CLIENT,CLIENT_46,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE A.PERSONAL_ID IS NULL"
CLIENT,CLIENT_47,N,"'HISPANIC_LATIN_AEO IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'HISPANIC_LATIN_AEO IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'HISPANIC_LATIN_AEO IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE HISPANIC_LATIN_AEO IS NULL OR HISPANIC_LATIN_AEO NOT IN (0,1)"
CLIENT,CLIENT_48,N,"'MID_EAST_N_AFRICAN IS NULL OR NOT IN (0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'MID_EAST_N_AFRICAN IS NULL OR NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MID_EAST_N_AFRICAN IS NULL OR NOT IN (0,1)' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE MID_EAST_N_AFRICAN IS NULL OR MID_EAST_N_AFRICAN NOT IN (0,1)"
CLIENT,CLIENT_49,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(A.PERSONAL_ID)>32"
CLIENT,CLIENT_50,N,'FIRST_NAME EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'FIRST_NAME EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'FIRST_NAME EXCEEDS 50 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(FIRST_NAME)>50"
CLIENT,CLIENT_51,N,'LAST_NAME EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'LAST_NAME EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'LAST_NAME EXCEEDS 50 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(LAST_NAME)>50"
CLIENT,CLIENT_52,N,'NAME_SUFFIX EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NAME_SUFFIX EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NAME_SUFFIX EXCEEDS 50 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(NAME_SUFFIX)>50"
CLIENT,CLIENT_53,N,'NAME_DATA_QUALITY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NAME_DATA_QUALITY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NAME_DATA_QUALITY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(NAME_DATA_QUALITY) NOT LIKE '%.00' AND IS_INTEGER(NAME_DATA_QUALITY) = FALSE"
CLIENT,CLIENT_54,N,'SSN EXCEEDS 9 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'SSN EXCEEDS 9 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'SSN EXCEEDS 9 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(SSN)>9"
CLIENT,CLIENT_55,N,'SSN_DATA_QUALITY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'SSN_DATA_QUALITY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'SSN_DATA_QUALITY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(SSN_DATA_QUALITY) NOT LIKE '%.00' AND IS_INTEGER(SSN_DATA_QUALITY)=FALSE"
CLIENT,CLIENT_56,N,'DOB_DATA_QUALITY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DOB_DATA_QUALITY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DOB_DATA_QUALITY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(DOB_DATA_QUALITY) NOT LIKE '%.00' AND IS_INTEGER(DOB_DATA_QUALITY)=FALSE"
CLIENT,CLIENT_57,N,'AM_IND_AK_NATIVE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'AM_IND_AK_NATIVE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'AM_IND_AK_NATIVE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(AM_IND_AK_NATIVE) NOT LIKE '%.00' AND IS_INTEGER(AM_IND_AK_NATIVE)=FALSE AND AM_IND_AK_NATIVE IS NOT NULL"
CLIENT,CLIENT_58,N,'ASIAN IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ASIAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'ASIAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(ASIAN) NOT LIKE '%.00' AND IS_INTEGER(ASIAN)=FALSE AND ASIAN IS NOT NULL"
CLIENT,CLIENT_59,N,'BLACK_AF_AMERICAN IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'BLACK_AF_AMERICAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'BLACK_AF_AMERICAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(BLACK_AF_AMERICAN) NOT LIKE '%.00' AND IS_INTEGER(BLACK_AF_AMERICAN) = FALSE AND BLACK_AF_AMERICAN IS NOT NULL"
CLIENT,CLIENT_60,N,'HISPANIC_LATIN_AEO IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'HISPANIC_LATIN_AEO IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'HISPANIC_LATIN_AEO MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(HISPANIC_LATIN_AEO) NOT LIKE '%.00' AND IS_INTEGER(HISPANIC_LATIN_AEO)=FALSE AND HISPANIC_LATIN_AEO IS NOT NULL"
CLIENT,CLIENT_61,N,'MID_EAST_N_AFRICAN IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'MID_EAST_N_AFRICAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MID_EAST_N_AFRICAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(MID_EAST_N_AFRICAN) NOT LIKE '%.00' AND IS_INTEGER(MID_EAST_N_AFRICAN)=FALSE AND MID_EAST_N_AFRICAN IS NOT NULL"
CLIENT,CLIENT_62,N,'NATIVE_HI_PACIFIC IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NATIVE_HI_PACIFIC IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NATIVE_HI_PACIFIC MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(NATIVE_HI_PACIFIC) NOT LIKE '%.00' AND IS_INTEGER(NATIVE_HI_PACIFIC)=FALSE AND NATIVE_HI_PACIFIC IS NOT NULL"
CLIENT,CLIENT_63,N,'WHITE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WHITE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WHITE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(WHITE) NOT LIKE '%.00' AND IS_INTEGER(WHITE)=FALSE AND WHITE IS NOT NULL"
CLIENT,CLIENT_64,N,'RACE_NONE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'RACE_NONE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'RACE_NONE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(RACE_NONE) NOT LIKE '%.00' AND IS_INTEGER(RACE_NONE)=FALSE AND RACE_NONE IS NOT NULL"
CLIENT,CLIENT_65,N,'ADDITIONAL_RACE_ETHNICITY EXCEEDS 100 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'ADDITIONAL_RACE_ETHNICITY EXCEEDS 100 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'ADDITIONAL_RACE_ETHNICITY EXCEEDS 100 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(ADDITIONAL_RACE_ETHNICITY)>100"
CLIENT,CLIENT_66,N,'WOMAN IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WOMAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WOMAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(WOMAN) NOT LIKE '%.00' AND IS_INTEGER(WOMAN)=FALSE AND WOMAN IS NOT NULL"
CLIENT,CLIENT_67,N,'MAN IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'MAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(MAN) NOT LIKE '%.00' AND IS_INTEGER(MAN)=FALSE AND MAN IS NOT NULL"
CLIENT,CLIENT_68,N,'NON_BINARY IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'NON_BINARY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NON_BINARY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(NON_BINARY) NOT LIKE '%.00' AND IS_INTEGER(NON_BINARY)=FALSE AND NON_BINARY IS NOT NULL"
CLIENT,CLIENT_69,N,'CULTURALLY_SPECIFIC IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'CULTURALLY_SPECIFIC IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'CULTURALLY_SPECIFIC MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(CULTURALLY_SPECIFIC) NOT LIKE '%.00' AND IS_INTEGER(CULTURALLY_SPECIFIC)=FALSE AND CULTURALLY_SPECIFIC IS NOT NULL"
CLIENT,CLIENT_70,N,'TRANSGENDER IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'TRANSGENDER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'TRANSGENDER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(TRANSGENDER) NOT LIKE '%.00' AND IS_INTEGER(TRANSGENDER)=FALSE AND TRANSGENDER IS NOT NULL"
CLIENT,CLIENT_71,N,'QUESTIONING IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'QUESTIONING IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'QUESTIONING MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(QUESTIONING) NOT LIKE '%.00' AND IS_INTEGER(QUESTIONING)=FALSE AND QUESTIONING IS NOT NULL"
CLIENT,CLIENT_72,N,'DIFFERENT_IDENTITY IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DIFFERENT_IDENTITY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DIFFERENT_IDENTITY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(DIFFERENT_IDENTITY) NOT LIKE '%.00' AND IS_INTEGER(DIFFERENT_IDENTITY)=FALSE AND DIFFERENT_IDENTITY IS NOT NULL"
CLIENT,CLIENT_73,N,'GENDER_NONE IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'GENDER_NONE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'GENDER_NONE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(GENDER_NONE) NOT LIKE '%.00' AND IS_INTEGER(GENDER_NONE)=FALSE AND GENDER_NONE IS NOT NULL"
CLIENT,CLIENT_74,N,'DIFFERENT_IDENTITY_TEXT EXCEEDS 100 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DIFFERENT_IDENTITY_TEXT EXCEEDS 100 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DIFFERENT_IDENTITY_TEXT EXCEEDS 100 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(DIFFERENT_IDENTITY_TEXT)>100"
CLIENT,CLIENT_75,N,'VETERAN_STATUS IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'VETERAN_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'VETERAN_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(VETERAN_STATUS) NOT LIKE '%.00' AND IS_INTEGER(VETERAN_STATUS)=FALSE AND VETERAN_STATUS IS NOT NULL"
CLIENT,CLIENT_76,N,'YEAR_ENTERED_SERVICE IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'YEAR_ENTERED_SERVICE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'YEAR_ENTERED_SERVICE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(YEAR_ENTERED_SERVICE) NOT LIKE '%.00' AND IS_INTEGER(YEAR_ENTERED_SERVICE)=FALSE"
CLIENT,CLIENT_77,N,'YEAR_SEPARATED IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'YEAR_SEPARATED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'YEAR_SEPARATED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(YEAR_SEPARATED) NOT LIKE '%.00' AND IS_INTEGER(YEAR_SEPARATED)=FALSE"
CLIENT,CLIENT_78,N,'WORLD_WAR_II IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'WORLD_WAR_II IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WORLD_WAR_II MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(WORLD_WAR_II) NOT LIKE '%.00' AND IS_INTEGER(WORLD_WAR_II)=FALSE"
CLIENT,CLIENT_79,N,'KOREAN_WAR IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'KOREAN_WAR IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'KOREAN_WAR MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(KOREAN_WAR) NOT LIKE '%.00' AND IS_INTEGER(KOREAN_WAR)=FALSE"
CLIENT,CLIENT_80,N,'VIETNAM_WAR IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'VIETNAM_WAR IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'VIETNAM_WAR MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(VIETNAM_WAR) NOT LIKE '%.00' AND IS_INTEGER(VIETNAM_WAR)=FALSE"
CLIENT,CLIENT_81,N,'DESERT_STORM IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DESERT_STORM IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DESERT_STORM MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(DESERT_STORM) NOT LIKE '%.00' AND IS_INTEGER(DESERT_STORM)=FALSE"
CLIENT,CLIENT_82,N,'AFGHANISTAN_OEF IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'AFGHANISTAN_OEF IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'AFGHANISTAN_OEF MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(AFGHANISTAN_OEF) NOT LIKE '%.00' AND IS_INTEGER(AFGHANISTAN_OEF)=FALSE"
CLIENT,CLIENT_83,N,'IRAQ_OIF IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'IRAQ_OIF IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'IRAQ_OIF MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(IRAQ_OIF) NOT LIKE '%.00' AND IS_INTEGER(IRAQ_OIF)=FALSE"
CLIENT,CLIENT_84,N,'IRAQ_OND IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'IRAQ_OND IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'IRAQ_OND MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(IRAQ_OND) NOT LIKE '%.00' AND IS_INTEGER(IRAQ_OND)=FALSE"
CLIENT,CLIENT_85,N,'OTHER_THEATER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'OTHER_THEATER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'OTHER_THEATER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(OTHER_THEATER) NOT LIKE '%.00' AND IS_INTEGER(OTHER_THEATER)=FALSE"
CLIENT,CLIENT_86,N,'MILITARY_BRANCH IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'MILITARY_BRANCH IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MILITARY_BRANCH MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(MILITARY_BRANCH) NOT LIKE '%.00' AND IS_INTEGER(MILITARY_BRANCH)=FALSE"
CLIENT,CLIENT_87,N,'DISCHARGE_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DISCHARGE_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DISCHARGE_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE TO_CHAR(DISCHARGE_STATUS) NOT LIKE '%.00' AND IS_INTEGER(DISCHARGE_STATUS)=FALSE"
CLIENT,CLIENT_88,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(USER_ID)>32"
CLIENT,CLIENT_89,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(EXPORT_ID)>32"
CLIENT,CLIENT_90,N,'NAME_DATA_QUALITY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'NAME_DATA_QUALITY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NAME_DATA_QUALITY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.name_data_quality = to_decimal(c.VALID_VALUES) and c.List_Name = '3.01.5' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.NAME_DATA_QUALITY IS NOT NULL"
CLIENT,CLIENT_91,N,'SSN_DATA_QUALITY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'SSN_DATA_QUALITY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'SSN_DATA_QUALITY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SSN_DATA_QUALITY = c.VALID_VALUES and c.List_Name = '3.02.2' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.SSN_DATA_QUALITY IS NOT NULL"
CLIENT,CLIENT_92,N,'DOB_DATA_QUALITY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'DOB_DATA_QUALITY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DOB_DATA_QUALITY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DOB_DATA_QUALITY = c.VALID_VALUES and c.List_Name = '3.03.2'LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.DOB_DATA_QUALITY is not null"
CLIENT,CLIENT_93,N,'AM_IND_AK_NATIVE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'AM_IND_AK_NATIVE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'AM_IND_AK_NATIVE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.AM_IND_AK_NATIVE = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.AM_IND_AK_NATIVE IS NOT NULL"
CLIENT,CLIENT_94,N,'ASIAN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'ASIAN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'ASIAN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1  LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ASIAN = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.ASIAN IS NOT NULL"
CLIENT,CLIENT_95,N,'BLACK_AF_AMERICAN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'BLACK_AF_AMERICAN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'BLACK_AF_AMERICAN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1  LEFT JOIN STAGING.RT_HUD_LISTS c ON a.BLACK_AF_AMERICAN = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.BLACK_AF_AMERICAN IS NOT NULL"
CLIENT,CLIENT_96,N,'HISPANIC_LATIN_AEO NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'HISPANIC_LATIN_AEO NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'HISPANIC_LATIN_AEO CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HISPANIC_LATIN_AEO = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.HISPANIC_LATIN_AEO is not null"
CLIENT,CLIENT_97,N,'MID_EAST_N_AFRICAN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'MID_EAST_N_AFRICAN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MID_EAST_N_AFRICAN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MID_EAST_N_AFRICAN = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.MID_EAST_N_AFRICAN IS NOT NULL"
CLIENT,CLIENT_98,N,'NATIVE_HI_PACIFIC NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'NATIVE_HI_PACIFIC NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NATIVE_HI_PACIFIC CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NATIVE_HI_PACIFIC = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.NATIVE_HI_PACIFIC is not null"
CLIENT,CLIENT_99,N,'WHITE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'WHITE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WHITE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WHITE = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.WHITE is not null"
CLIENT,CLIENT_100,N,'RACE_NONE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'RACE_NONE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'RACE_NONE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RACE_NONE = c.VALID_VALUES and c.List_Name = '1.6' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.RACE_NONE is not null"
CLIENT,CLIENT_101,N,'WOMAN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'WOMAN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WOMAN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WOMAN = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.WOMAN is not null"
CLIENT,CLIENT_102,N,'MAN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'MAN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MAN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MAN = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.MAN is not null"
CLIENT,CLIENT_103,N,'NON_BINARY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'NON_BINARY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'NON_BINARY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NON_BINARY = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.NON_BINARY IS NOT NULL"
CLIENT,CLIENT_104,N,'CULTURALLY_SPECIFIC NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'CULTURALLY_SPECIFIC NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'CULTURALLY_SPECIFIC CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CULTURALLY_SPECIFIC = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL and a.CULTURALLY_SPECIFIC IS NOT NULL"
CLIENT,CLIENT_105,N,'TRANSGENDER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'TRANSGENDER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'TRANSGENDER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TRANSGENDER = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.TRANSGENDER IS NOT NULL"
CLIENT,CLIENT_106,N,'QUESTIONING NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'QUESTIONING NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'QUESTIONING CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.QUESTIONING = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.QUESTIONING IS NOT NULL"
CLIENT,CLIENT_107,N,'DIFFERENT_IDENTITY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'DIFFERENT_IDENTITY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DIFFERENT_IDENTITY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DIFFERENT_IDENTITY = c.VALID_VALUES and c.List_Name = '1.10' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.DIFFERENT_IDENTITY IS NOT NULL"
CLIENT,CLIENT_108,N,'GENDER_NONE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'GENDER_NONE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'GENDER_NONE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.GENDER_NONE = c.VALID_VALUES and c.List_Name = '1.6'  LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.GENDER_NONE IS NOT NULL"
CLIENT,CLIENT_109,N,'VETERAN_STATUS NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'VETERAN_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'VETERAN_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VETERAN_STATUS = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.VETERAN_STATUS IS NOT NULL"
CLIENT,CLIENT_110,N,'WORLD_WAR_II NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'WORLD_WAR_II NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'WORLD_WAR_II CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WORLD_WAR_II = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.WORLD_WAR_II IS NOT NULL"
CLIENT,CLIENT_111,N,'KOREAN_WAR NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'KOREAN_WAR NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'KOREAN_WAR CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.KOREAN_WAR = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.KOREAN_WAR IS NOT NULL"
CLIENT,CLIENT_112,N,'VIETNAM_WAR NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'VIETNAM_WAR NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'VIETNAM_WAR CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VIETNAM_WAR = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.VIETNAM_WAR IS NOT NULL"
CLIENT,CLIENT_113,N,'DESERT_STORM NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'DESERT_STORM NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DESERT_STORM CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DESERT_STORM = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.DESERT_STORM IS NOT NULL"
CLIENT,CLIENT_114,N,'AFGHANISTAN_OEF NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'AFGHANISTAN_OEF NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'AFGHANISTAN_OEF CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.AFGHANISTAN_OEF = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.AFGHANISTAN_OEF IS NOT NULL"
CLIENT,CLIENT_115,N,'IRAQ_OIF NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'IRAQ_OIF NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'IRAQ_OIF CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.IRAQ_OIF = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.IRAQ_OIF IS NOT NULL"
CLIENT,CLIENT_116,N,'IRAQ_OND NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'IRAQ_OND NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'IRAQ_OND CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.IRAQ_OND = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.IRAQ_OND IS NOT NULL"
CLIENT,CLIENT_117,N,'OTHER_THEATER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'OTHER_THEATER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'OTHER_THEATER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.OTHER_THEATER = c.VALID_VALUES and c.List_Name = '1.8' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.OTHER_THEATER IS NOT NULL"
CLIENT,CLIENT_118,N,'MILITARY_BRANCH NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'MILITARY_BRANCH NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'MILITARY_BRANCH CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MILITARY_BRANCH = c.VALID_VALUES and c.List_Name = 'V1.11' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.MILITARY_BRANCH IS NOT NULL"
CLIENT,CLIENT_119,N,'DISCHARGE_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME ,(case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.PERSONAL_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.PERSONAL_ID END BUSINESS_KEY_VALUE,,'DISCHARGE_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DISCHARGE_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DISCHARGE_STATUS = c.VALID_VALUES and c.List_Name = 'V1.12' LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.DISCHARGE_STATUS IS NOT NULL"
CLIENT,CLIENT_120,N,'DOB NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DOB NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DOB NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT A join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(DOB,1,10) NOT LIKE '%____-__-__%'"
CLIENT,CLIENT_121,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT A join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
CLIENT,CLIENT_122,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT A join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
CLIENT,CLIENT_123,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT A join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
CLIENT,CLIENT_124,N,'PERSONAL_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'PERSONAL_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_CLIENT GROUP BY PERSONAL_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE C.PERSONAL_ID IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_1,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_2,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_3,N,'INFORMATION_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'INFORMATION_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INFORMATION_DATE IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_4,N,'CURRENT_LIVING_SITUATION IS NULL',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CURRENT_LIVING_SITUATION IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_LIVING_SITUATION IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CURRENT_LIVING_SITUATION IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_5,N,'VERIFIED_BY IS NULL UNLESS PROJECT_TYPE = 14',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'VERIFIED_BY IS NULL UNLESS PROJECT_TYPE = 14' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VerifiedBy cannot be null when ProjectType is 14.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_PROJECT D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE (A.VERIFIED_BY IS NULL AND D.PROJECT_TYPE = 14) OR (A.VERIFIED_BY IS NOT NULL AND D.PROJECT_TYPE <> 14)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_6,N,"'LEAVE_SITUATION_14_DAYS IS NULL UNLESS CURRENT_LIVING_SITUATION IN (215,206,207,225,204,205,302,329,314,332,336,335,410,435,421,411)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LEAVE_SITUATION_14_DAYS IS NULL UNLESS CURRENT_LIVING_SITUATION IN (215,206,207,225,204,205,302,329,314,332,336,335,410,435,421,411)' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LeaveSituation14Days cannot be null when CurrentLivingSituation = 215, 206, 207, 225, 204, 205, 302, 329, 314, 332, 336, 335, 410, 435, 421 or 411.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (LEAVE_SITUATION_14_DAYS IS NULL AND CURRENT_LIVING_SITUATION IN (215,206,207,225,204,205,302,329,314,332,336,335,410,435,421,411)) OR (LEAVE_SITUATION_14_DAYS IS NOT NULL AND CURRENT_LIVING_SITUATION NOT IN (215,206,207,225,204,205,302,329,314,332,336,335,410,435,421,411))"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_7,N,'SUBSEQUENT_RESIDENCE NULL UNLESS LEAVE_SITUATION_14_DAYS = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'SUBSEQUENT_RESIDENCE NULL UNLESS LEAVE_SITUATION_14_DAYS = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SubsequentResidence cannot be null when LeaveSituation14Days = 1.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (SUBSEQUENT_RESIDENCE IS NULL AND LEAVE_SITUATION_14_DAYS = 1) OR (SUBSEQUENT_RESIDENCE IS NOT NULL AND LEAVE_SITUATION_14_DAYS <> 1)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_8,N,'RESOURCES_TO_OBTAIN NULL UNLESS LEAVE_SITUATION_14_DAYS = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE ,'RESOURCES_TO_OBTAIN NULL UNLESS LEAVE_SITUATION_14_DAYS = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ResourcesToObtain cannot be null when LeaveSituation14Days = 1.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (RESOURCES_TO_OBTAIN IS NULL AND LEAVE_SITUATION_14_DAYS = 1) OR (RESOURCES_TO_OBTAIN IS NOT NULL AND LEAVE_SITUATION_14_DAYS <> 1)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_9,N,'LEASE_OWN_60_DAYS NULL UNLESS LEAVE_SITUATION_14_DAYS = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LEASE_OWN_60_DAYS NULL UNLESS LEAVE_SITUATION_14_DAYS = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LeaseOwn60Days cannot be null when LeaveSituation14Days = 1.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (LEASE_OWN_60_DAYS IS NULL AND LEAVE_SITUATION_14_DAYS = 1) OR (LEASE_OWN_60_DAYS IS NOT NULL AND LEAVE_SITUATION_14_DAYS <> 1)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_10,N,'MOVED_TWO_OR_MORE NULL UNLESS LEAVE_SITUATION_14_DAYS = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'MOVED_TWO_OR_MORE NULL UNLESS LEAVE_SITUATION_14_DAYS = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MovedTwoOrMore cannot be null when LeaveSituation14Days = 1.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (MOVED_TWO_OR_MORE IS NULL AND LEAVE_SITUATION_14_DAYS = 1) OR (MOVED_TWO_OR_MORE IS NOT NULL AND LEAVE_SITUATION_14_DAYS <> 1)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_11,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_12,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_13,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_14,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then SRC.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) AS BUSINESS_KEY_VALUE, SRC.INFORMATION_DATE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION SRC  join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE,  'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, INFORMATION_DATE ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_15,N,'CLS_SUBSIDY_TYPE IS NULL UNLESS CURRENT_LIVING_SITUATION = 435',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CLS_SUBSIDY_TYPE IS NULL UNLESS CURRENT_LIVING_SITUATION = 435' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CLSSubsidyType cannot be null when CurrentLivingSituation = 435.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (CLS_SUBSIDY_TYPE IS NULL AND CURRENT_LIVING_SITUATION = 435) OR (CLS_SUBSIDY_TYPE IS NOT NULL AND CURRENT_LIVING_SITUATION <> 435)"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_16,N,'NO CLS RECORDS ASSOCIATED WITH ENROLLMENT',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'NO CLS RECORDS ASSOCIATED WITH ENROLLMENT' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'No CLS Records associated with the enrollment.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ENROLLMENT_ID IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_17,N,'CURRENT_LIVING_SIT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CURRENT_LIVING_SIT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_LIVING_SIT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CURRENT_LIVING_SIT_ID IS NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_18,N,'CURRENT_LIVING_SIT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CURRENT_LIVING_SIT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_LIVING_SIT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(CURRENT_LIVING_SIT_ID)>32"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_19,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_20,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_21,N,'CURRENT_LIVING_SITUATION IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CURRENT_LIVING_SITUATION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_LIVING_SITUATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(CURRENT_LIVING_SITUATION) NOT LIKE '%.00' AND IS_INTEGER(CURRENT_LIVING_SITUATION)=FALSE AND CURRENT_LIVING_SITUATION IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_22,N,'CLS_SUBSIDY_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CLS_SUBSIDY_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CLS_SUBSIDY_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(CLS_SUBSIDY_TYPE) NOT LIKE '%.00' AND IS_INTEGER(CLS_SUBSIDY_TYPE)=FALSE"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_23,N,'VERIFIED_BY EXCEEDS 100 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'VERIFIED_BY EXCEEDS 100 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VERIFIED_BY EXCEEDS 100 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(VERIFIED_BY)>100"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_24,N,'LEAVE_SITUATION_14_DAYS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LEAVE_SITUATION_14_DAYS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LEAVE_SITUATION_14_DAYS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(LEAVE_SITUATION_14_DAYS) NOT LIKE '%.00' AND IS_INTEGER(LEAVE_SITUATION_14_DAYS)=FALSE"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_25,N,'SUBSEQUENT_RESIDENCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'SUBSEQUENT_RESIDENCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SUBSEQUENT_RESIDENCE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(SUBSEQUENT_RESIDENCE) NOT LIKE '%.00' AND IS_INTEGER(SUBSEQUENT_RESIDENCE)=FALSE"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_26,N,'RESOURCES_TO_OBTAIN IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'RESOURCES_TO_OBTAIN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'RESOURCES_TO_OBTAIN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(RESOURCES_TO_OBTAIN) NOT LIKE '%.00' AND IS_INTEGER(RESOURCES_TO_OBTAIN)=FALSE"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_27,N,'LEASE_OWN_60_DAYS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LEASE_OWN_60_DAYS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LEASE_OWN_60_DAYS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(LEASE_OWN_60_DAYS) NOT LIKE '%.00' AND IS_INTEGER(LEASE_OWN_60_DAYS)=FALSE"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_28,N,'MOVED_TWO_OR_MORE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'MOVED_TWO_OR_MORE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MOVED_TWO_OR_MORE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(MOVED_TWO_OR_MORE) NOT LIKE '%.00' AND IS_INTEGER(MOVED_TWO_OR_MORE)=FALSE"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_29,N,'LOCATION_DETAILS EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LOCATION_DETAILS EXCEEDS 250 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LOCATION_DETAILS EXCEEDS 250 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(LOCATION_DETAILS)>250"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_30,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_31,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_32,N,'CURRENT_LIVING_SITUATION NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CURRENT_LIVING_SITUATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, TRY_TO_DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_LIVING_SITUATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CURRENT_LIVING_SITUATION = c.VALID_VALUES and c.List_Name = '3.12.1' WHERE c.VALID_VALUES IS NULL AND CURRENT_LIVING_SITUATION IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_33,N,'CLS_SUBSIDY_TYPE NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CLS_SUBSIDY_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CLS_SUBSIDY_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CLS_SUBSIDY_TYPE = c.VALID_VALUES and c.List_Name = '3.12.A' WHERE c.VALID_VALUES IS NULL AND a.CLS_SUBSIDY_TYPE IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_34,N,'LEAVE_SITUATION_14_DAYS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LEAVE_SITUATION_14_DAYS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LEAVE_SITUATION_14_DAYS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LEAVE_SITUATION_14_DAYS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.LEAVE_SITUATION_14_DAYS IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_35,N,'SUBSEQUENT_RESIDENCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'SUBSEQUENT_RESIDENCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SUBSEQUENT_RESIDENCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SUBSEQUENT_RESIDENCE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.SUBSEQUENT_RESIDENCE IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_36,N,'RESOURCES_TO_OBTAIN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'RESOURCES_TO_OBTAIN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'RESOURCES_TO_OBTAIN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RESOURCES_TO_OBTAIN = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.RESOURCES_TO_OBTAIN IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_37,N,'LEASE_OWN_60_DAYS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'LEASE_OWN_60_DAYS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LEASE_OWN_60_DAYS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LEASE_OWN_60_DAYS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.LEASE_OWN_60_DAYS IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_38,N,'MOVED_TWO_OR_MORE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'MOVED_TWO_OR_MORE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MOVED_TWO_OR_MORE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MOVED_TWO_OR_MORE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.MOVED_TWO_OR_MORE IS NOT NULL"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_39,N,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INFORMATION_DATE,1,10) NOT LIKE '%____-__-__%'"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_40,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_41,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_42,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_43,N,'CURRENT_LIVING_SIT_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then 'STG_MD5_HASH_VALUE' else 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' end) BUSINESS_KEY_FIELD_NAME, (case when A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION is null then A.STG_MD5_HASH_VALUE else A.CURRENT_LIVING_SIT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.CURRENT_LIVING_SITUATION end) BUSINESS_KEY_VALUE,'CURRENT_LIVING_SIT_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_LIVING_SIT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT CURRENT_LIVING_SIT_ID, SOURCE_FILE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION GROUP BY CURRENT_LIVING_SIT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.CURRENT_LIVING_SIT_ID = C.CURRENT_LIVING_SIT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.CURRENT_LIVING_SIT_ID IS NOT NULL"
DISABILITIES ,DISABILITIES_1,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
DISABILITIES ,DISABILITIES_2,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
DISABILITIES ,DISABILITIES_3,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when DISABILITIES_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE is null then SRC.STG_MD5_HASH_VALUE else DISABILITIES_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE end) AS BUSINESS_KEY_VALUE, SRC.INFORMATION_DATE FROM STAGING.PSTG_DISABILITIES SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,  (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
DISABILITIES,DISABILITIES_4,N,"'INDEFINITE_AND_IMPAIRS IN (8,9,99) AND DISABILITY_RESPONSE IN (1,2,3)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'INDEFINITE_AND_IMPAIRS IN (8,9,99) AND DISABILITY_RESPONSE IN (1,2,3)' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INDEFINITE_AND_IMPAIRS IN (8,9,99) AND DISABILITY_RESPONSE IN (1,2,3)"
DISABILITIES,DISABILITIES_5,N,'DISABILITIES_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITIES_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITIES_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DISABILITIES_ID IS NULL"
DISABILITIES,DISABILITIES_6,N,'DISABILITIES_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITIES_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITIES_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(DISABILITIES_ID)>32"
DISABILITIES,DISABILITIES_7,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
DISABILITIES,DISABILITIES_8,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
DISABILITIES,DISABILITIES_9,N,'DISABILITY_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_TYPE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(DISABILITY_TYPE) NOT LIKE '%.00' AND IS_INTEGER(DISABILITY_TYPE)=FALSE"
DISABILITIES,DISABILITIES_10,N,'DISABILITY_RESPONSE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_RESPONSE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_RESPONSE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(DISABILITY_RESPONSE) NOT LIKE '%.00' AND IS_INTEGER(DISABILITY_RESPONSE)=FALSE"
DISABILITIES,DISABILITIES_11,N,'INDEFINITE_AND_IMPAIRS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'INDEFINITE_AND_IMPAIRS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INDEFINITE_AND_IMPAIRS MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(INDEFINITE_AND_IMPAIRS) NOT LIKE '%.00' AND IS_INTEGER(INDEFINITE_AND_IMPAIRS)=FALSE"
DISABILITIES,DISABILITIES_12,N,'TCELL_COUNT_AVAILABLE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_COUNT_AVAILABLE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCELL_COUNT_AVAILABLE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(TCELL_COUNT_AVAILABLE) NOT LIKE '%.00' AND IS_INTEGER(TCELL_COUNT_AVAILABLE)=FALSE"
DISABILITIES,DISABILITIES_13,N,'TCELL_COUNT IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_COUNT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCELL_COUNT MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(TCELL_COUNT) NOT LIKE '%.00' AND IS_INTEGER(TCELL_COUNT)=FALSE"
DISABILITIES,DISABILITIES_14,N,'TCELL_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCELL_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TO_CHAR(TCELL_SOURCE) NOT LIKE '%.00' AND IS_INTEGER(TCELL_SOURCE)=FALSE"
DISABILITIES,DISABILITIES_15,N,'VIRAL_LOAD_AVAILABLE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD_AVAILABLE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VIRAL_LOAD_AVAILABLE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(VIRAL_LOAD_AVAILABLE)=FALSE AND TO_CHAR(VIRAL_LOAD_AVAILABLE) NOT LIKE '%.00'"
DISABILITIES,DISABILITIES_16,N,'VIRAL_LOAD IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VIRAL_LOAD MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(VIRAL_LOAD)=FALSE AND TO_CHAR(VIRAL_LOAD) NOT LIKE '%.00'"
DISABILITIES,DISABILITIES_17,N,'VIRAL_LOAD_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VIRAL_LOAD_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(VIRAL_LOAD_SOURCE)=FALSE AND TO_CHAR(VIRAL_LOAD_SOURCE) NOT LIKE '%.00'"
DISABILITIES,DISABILITIES_18,N,'ANTI_RETROVIRAL IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'ANTI_RETROVIRAL IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ANTI_RETROVIRAL MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ANTI_RETROVIRAL)=FALSE AND TO_CHAR(ANTI_RETROVIRAL) NOT LIKE '%.00'"
DISABILITIES,DISABILITIES_19,N,'DATA_COLLECTION_STAGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DATA_COLLECTION_STAGE)=FALSE AND TO_CHAR(DATA_COLLECTION_STAGE) NOT LIKE '%.00'"
DISABILITIES,DISABILITIES_20,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
DISABILITIES,DISABILITIES_21,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
DISABILITIES,DISABILITIES_22,N,'DISABILITY_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DISABILITY_TYPE = c.VALID_VALUES and c.List_Name = '1.3' WHERE c.VALID_VALUES IS NULL AND a.DISABILITY_TYPE IS NOT NULL"
DISABILITIES,DISABILITIES_23,N,'DISABILITY_RESPONSE NOT IN LIST 4.10.2 WHEN DISABILITY_TYPE = 10',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_RESPONSE NOT IN LIST 4.10.2 WHEN DISABILITY_TYPE = 10' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_RESPONSE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DISABILITY_RESPONSE = c.VALID_VALUES and c.List_Name = '4.10.2' WHERE c.VALID_VALUES IS NULL and a.DISABILITY_TYPE = 10 AND a.DISABILITY_RESPONSE IS NOT NULL"
DISABILITIES,DISABILITIES_24,N,'DISABILITY_RESPONSE NOT IN LIST 1.8 WHEN DISABILITY_TYPE <> 10',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_RESPONSE NOT IN LIST 1.8 WHEN DISABILITY_TYPE <> 10' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_RESPONSE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DISABILITY_RESPONSE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL and a.DISABILITY_TYPE <> 10 AND a.DISABILITY_RESPONSE IS NOT NULL"
DISABILITIES,DISABILITIES_25,N,'TCELL_COUNT_AVAILABLE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_COUNT_AVAILABLE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCELL_COUNT_AVAILABLE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TCELL_COUNT_AVAILABLE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.TCELL_COUNT_AVAILABLE IS NOT NULL"
DISABILITIES,DISABILITIES_26,N,'INDEFINITE_AND_IMPAIRS NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'INDEFINITE_AND_IMPAIRS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INDEFINITE_AND_IMPAIRS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INDEFINITE_AND_IMPAIRS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.INDEFINITE_AND_IMPAIRS IS NOT NULL"
DISABILITIES,DISABILITIES_27,N,'TCELL_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_SOURCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCELL_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TCELL_SOURCE = c.VALID_VALUES and c.List_Name = 'W4.B' WHERE c.VALID_VALUES IS NULL AND a.TCELL_SOURCE IS NOT NULL"
DISABILITIES,DISABILITIES_28,N,'VIRAL_LOAD_AVAILABLE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD_AVAILABLE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VIRAL_LOAD_AVAILABLE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VIRAL_LOAD_AVAILABLE = c.VALID_VALUES and c.List_Name = 'W4.3' WHERE c.VALID_VALUES IS NULL AND a.VIRAL_LOAD_AVAILABLE IS NOT NULL"
DISABILITIES,DISABILITIES_29,N,'VIRAL_LOAD_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD_SOURCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VIRAL_LOAD_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VIRAL_LOAD_SOURCE = c.VALID_VALUES and c.List_Name = 'W4.B' WHERE c.VALID_VALUES IS NULL AND a.VIRAL_LOAD_SOURCE IS NOT NULL"
DISABILITIES,DISABILITIES_30,N,'ANTI_RETROVIRAL NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'ANTI_RETROVIRAL NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ANTI_RETROVIRAL CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ANTI_RETROVIRAL = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.ANTI_RETROVIRAL IS NOT NULL"
DISABILITIES,DISABILITIES_31,N,'DATA_COLLECTION_STAGE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME ,(case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DATA_COLLECTION_STAGE = c.VALID_VALUES and c.List_Name = '5.03.1' WHERE c.VALID_VALUES IS NULL AND a.DATA_COLLECTION_STAGE IS NOT NULL"
DISABILITIES,DISABILITIES_32,N,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INFORMATION_DATE,1,10) NOT LIKE '%____-__-__%'"
DISABILITIES,DISABILITIES_33,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
DISABILITIES,DISABILITIES_34,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
DISABILITIES,DISABILITIES_35,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
DISABILITIES,DISABILITIES_36,N,'DISABILITIES_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITIES_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITIES_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT DISABILITIES_ID, SOURCE_FILE FROM STAGING.PSTG_DISABILITIES GROUP BY DISABILITIES_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.DISABILITIES_ID = C.DISABILITIES_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE c.DISABILITIES_ID IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_1,N,'EMPLOYMENT_EDUCATION_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYMENT_EDUCATION_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYMENT_EDUCATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EMPLOYMENT_EDUCATION_ID IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_2,N,'EMPLOYMENT_EDUCATION_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYMENT_EDUCATION_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYMENT_EDUCATION_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EMPLOYMENT_EDUCATION_ID)>32"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_3,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_4,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_5,N,'LAST_GRADE_COMPLETED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'LAST_GRADE_COMPLETED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LAST_GRADE_COMPLETED MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(LAST_GRADE_COMPLETED)=FALSE AND TO_CHAR(LAST_GRADE_COMPLETED) NOT LIKE '%.00'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_6,N,'SCHOOL_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SCHOOL_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SCHOOL_STATUS MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SCHOOL_STATUS)=FALSE AND TO_CHAR(SCHOOL_STATUS) NOT LIKE '%.00'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_7,N,'EMPLOYED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYED MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EMPLOYED)=FALSE AND TO_CHAR(EMPLOYED) NOT LIKE '%.00'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_8,N,'EMPLOYMENT_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYMENT_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYMENT_TYPE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EMPLOYMENT_TYPE)=FALSE AND TO_CHAR(EMPLOYMENT_TYPE) NOT LIKE '%.00'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_9,N,'NOT_EMPLOYED_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NOT_EMPLOYED_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NOT_EMPLOYED_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(NOT_EMPLOYED_REASON)=FALSE AND TO_CHAR(NOT_EMPLOYED_REASON) NOT LIKE '%.00'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_10,N,'DATA_COLLECTION_STAGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DATA_COLLECTION_STAGE)=FALSE AND TO_CHAR(DATA_COLLECTION_STAGE) NOT LIKE '%.00'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_11,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_12,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_13,N,'LAST_GRADE_COMPLETED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'LAST_GRADE_COMPLETED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'LAST_GRADE_COMPLETED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LAST_GRADE_COMPLETED = c.VALID_VALUES and c.List_Name = 'R4.1' WHERE c.VALID_VALUES IS NULL AND a.LAST_GRADE_COMPLETED IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_14,N,'SCHOOL_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'SCHOOL_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SCHOOL_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SCHOOL_STATUS = c.VALID_VALUES and c.List_Name = 'R5.1' WHERE c.VALID_VALUES IS NULL AND a.SCHOOL_STATUS IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_15,N,'EMPLOYED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'EMPLOYED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EMPLOYED = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.EMPLOYED IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_16,N,'EMPLOYMENT_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'EMPLOYMENT_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYMENT_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EMPLOYMENT_TYPE = c.VALID_VALUES and c.List_Name = 'R6.A' WHERE c.VALID_VALUES IS NULL AND a.EMPLOYMENT_TYPE IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_17,N,'NOT_EMPLOYED_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'NOT_EMPLOYED_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NOT_EMPLOYED_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NOT_EMPLOYED_REASON = c.VALID_VALUES and c.List_Name = 'R6.B' WHERE c.VALID_VALUES IS NULL AND a.NOT_EMPLOYED_REASON IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_18,N,'DATA_COLLECTION_STAGE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DATA_COLLECTION_STAGE = c.VALID_VALUES and c.List_Name = '5.03.1' WHERE c.VALID_VALUES IS NULL AND a.DATA_COLLECTION_STAGE IS NOT NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_19,N,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INFORMATION_DATE,1,10) NOT LIKE '%____-__-__%'"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_20,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_21,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_22,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_23,N,'EMPLOYMENT_EDUCATION_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYMENT_EDUCATION_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYMENT_EDUCATION_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT EMPLOYMENT_EDUCATION_ID, SOURCE_FILE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION GROUP BY EMPLOYMENT_EDUCATION_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.EMPLOYMENT_EDUCATION_ID = C.EMPLOYMENT_EDUCATION_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.EMPLOYMENT_EDUCATION_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_1,N,'PERSONAL_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_2,N,'PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PROJECT_ID DOES NOT MATCH PROJECT_ID IN PROJECT.CSV' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_3,N,'ENTRY_DATE IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENTRY_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENTRY_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENTRY_DATE IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_4,N,'HOUSEHOLD_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HOUSEHOLD_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HOUSEHOLD_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HOUSEHOLD_ID IS NULL"
ENROLLMENT,ENROLLMENT_5,N,'RELATIONSHIP_TO_HOH IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'RELATIONSHIP_TO_HOH IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RELATIONSHIP_TO_HOH IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE RELATIONSHIP_TO_HOH IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_6,N,'DISABLING_CONDITION IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DISABLING_CONDITION IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DISABLING_CONDITION IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DISABLING_CONDITION IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_7,N,'REASON_NOT_ENROLLED IS NULL UNLESS CLIENT_ENROLLED_IN_PATH = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'REASON_NOT_ENROLLED IS NULL UNLESS CLIENT_ENROLLED_IN_PATH = 0' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REASON_NOT_ENROLLED NULL UNLESS CLIENT_ENROLLED_IN_PATH = 0' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (REASON_NOT_ENROLLED IS NULL AND CLIENT_ENROLLED_IN_PATH = 0) OR (REASON_NOT_ENROLLED IS NOT NULL AND CLIENT_ENROLLED_IN_PATH <> 0)"
ENROLLMENT,ENROLLMENT_8,N,'REASON_NO_SERVICES IS NULL UNLESS ELIGIBLE_FOR_RHY = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'REASON_NO_SERVICES IS NULL UNLESS ELIGIBLE_FOR_RHY = 0' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REASON_NO_SERVICES CANNOT BE NULL WHEN ELIGIBLE_FOR_RHY = 0' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (REASON_NO_SERVICES IS NULL AND ELIGIBLE_FOR_RHY = 0) or (REASON_NO_SERVICES IS NOT NULL AND ELIGIBLE_FOR_RHY <> 0)"
ENROLLMENT,ENROLLMENT_9,N,'RUNAWAY_YOUTH IS NULL UNLESS ELIGIBLE_FOR_RHY = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'RUNAWAY_YOUTH IS NULL UNLESS ELIGIBLE_FOR_RHY = 1' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RUNAWAY_YOUTH NULL UNLESS ELIGIBLE_FOR_RHY = 1' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (RUNAWAY_YOUTH IS NULL AND ELIGIBLE_FOR_RHY = 1) OR (RUNAWAY_YOUTH IS NOT NULL AND ELIGIBLE_FOR_RHY <> 1)"
ENROLLMENT,ENROLLMENT_10,N,'SEXUAL_ORIENTATION_OTHER IS NULL UNLESS SEXUAL_ORIENTATION = 6',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SEXUAL_ORIENTATION_OTHER IS NULL UNLESS SEXUAL_ORIENTATION = 6' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SEXUAL_ORIENTATION_OTHER CANNOT BE NULL WHEN SEXUAL_ORIENTATION = 6' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SEXUAL_ORIENTATION_OTHER IS NULL AND SEXUAL_ORIENTATION = 6"
ENROLLMENT,ENROLLMENT_11,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
ENROLLMENT,ENROLLMENT_12,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
ENROLLMENT,ENROLLMENT_13,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_14,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.ENROLLMENT_ID is null then SRC.STG_MD5_HASH_VALUE else SRC.ENROLLMENT_ID end) AS BUSINESS_KEY_VALUE,  (case when SRC.ENROLLMENT_ID IS NULL THEN 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) AS BUSINESS_KEY_FIELD_NAME, SRC.ENTRY_DATE, SRC.ENROLLMENT_ID FROM STAGING.PSTG_ENROLLMENT SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,  A.BUSINESS_KEY_FIELD_NAME, A.BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL'  WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR ,  'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL  THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end  ERROR_MESSAGE FROM A WHERE ((A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null))  AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_15,N,"'LIVING_SITUATION IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LIVING_SITUATION IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LIVING_SITUATION in (8,9,99)"
ENROLLMENT,ENROLLMENT_16,N,"'LENGTH_OF_STAY IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LENGTH_OF_STAY IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LENGTH_OF_STAY in (8,9,99)"
ENROLLMENT,ENROLLMENT_17,N,"'TIMES_HOMELESS_PAST_THREE_YEARS IN (8,9,99) WHEN PROJECT_TYPE IN (1,8,4) OR IN (8,9,99) WHEN PROJECT_TYPE <> (1,8,4) AND PREVIOUS_STREET_ESSH = 1'",,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TIMES_HOMELESS_PAST_THREE_YEARS IN (8,9,99) WHEN PROJECT_TYPE IN (1,8,4) OR IN (8,9,99) WHEN PROJECT_TYPE <> (1,8,4) AND PREVIOUS_STREET_ESSH = 1' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'Required response value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE (a.TIMES_HOMELESS_PAST_THREE_YEARS IN (8,9,99) AND c.PROJECT_TYPE in (1,8,4)) OR (a.TIMES_HOMELESS_PAST_THREE_YEARS in (8,9,99) AND c.PROJECT_TYPE NOT IN (1,8,4) AND a.PREVIOUS_STREET_ESSH = 1)"
ENROLLMENT,ENROLLMENT_18,N,"'MONTHS_HOMELESS_PAST_THREE_YEARS IN (8,9,99) WHEN PROJECT_TYPE IN (1,8,4) OR IN (8,9,99) WHEN PROJECT_TYPE <> (1,8,4) AND PREVIOUS_STREET_ESSH = 1'",,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MONTHS_HOMELESS_PAST_THREE_YEARS IN (8,9,99) WHEN PROJECT_TYPE IN (1,8,4) OR IN (8,9,99) WHEN PROJECT_TYPE <> (1,8,4) AND PREVIOUS_STREET_ESSH = 1' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'Required response value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE (a.MONTHS_HOMELESS_PAST_THREE_YEARS IN (8,9,99) AND c.PROJECT_TYPE in (1,8,4)) OR (a.MONTHS_HOMELESS_PAST_THREE_YEARS in (8,9,99) AND c.PROJECT_TYPE NOT IN (1,8,4) AND a.PREVIOUS_STREET_ESSH = 1)"
ENROLLMENT,ENROLLMENT_19,N,ENTRY_DATE > 1 YEAR PRIOR TO EXPORT_END_DATE AND MOVE_IN_DATE IS NULL FOR PH PROJECTS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENTRY_DATE > 1 YEAR PRIOR TO EXPORT_END_DATE AND MOVE_IN_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'This household has been enrolled in a PH projecttype for more than a year with no Move-in Date. Confirm the household is still active.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 join STAGING.PSTG_EXPORT c on a.EXPORT_ID = c.EXPORT_ID AND a.SOURCE_FILE = c.SOURCE_FILE join STAGING.PSTG_PROJECT d on a.project_id = d.project_id and a.source_file = d.source_fileWHERE DATEDIFF(YEAR,DATE(A.ENTRY_DATE),DATE(C.EXPORT_END_DATE)) >1 AND A.MOVE_IN_DATE IS NULL AND D.PROJECT_TYPE IN (3,9,10,13)"
ENROLLMENT,ENROLLMENT_20,N,'MOVE_IN_DATE < ENTRY_DATE OR MOVE_IN_DATE > EXIT_DATE',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MOVE_IN_DATE < ENTRY_DATE OR MOVE_IN_DATE > EXIT_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'The Move-In Date does not fall between the Enrollments start and end dates.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 join STAGING.PSTG_EXIT c on a.ENROLLMENT_ID = c.ENROLLMENT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE DATE(A.MOVE_IN_DATE) < DATE(A.ENTRY_DATE) OR DATE(A.MOVE_IN_DATE) > DATE(c.EXIT_DATE)"
ENROLLMENT,ENROLLMENT_21,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
ENROLLMENT,ENROLLMENT_22,N,'PROJECT_ID IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_ID IS NULL AND ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_23,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
ENROLLMENT,ENROLLMENT_24,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
ENROLLMENT,ENROLLMENT_25,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PROJECT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_ID)>32"
ENROLLMENT,ENROLLMENT_26,N,'HOUSEHOLD_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HOUSEHOLD_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HOUSEHOLD_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(HOUSEHOLD_ID)>32"
ENROLLMENT,ENROLLMENT_27,N,'RELATIONSHIP_TO_HOH IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'RELATIONSHIP_TO_HOH IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RELATIONSHIP_TO_HOH MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(RELATIONSHIP_TO_HOH)=FALSE AND TO_CHAR(RELATIONSHIP_TO_HOH) NOT LIKE '%.00' AND RELATIONSHIP_TO_HOH IS NOT NULL"
ENROLLMENT,ENROLLMENT_28,N,'LIVING_SITUATION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LIVING_SITUATION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LIVING_SITUATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(LIVING_SITUATION)=FALSE AND TO_CHAR(LIVING_SITUATION) NOT LIKE '%.00' AND LIVING_SITUATION IS NOT NULL"
ENROLLMENT,ENROLLMENT_29,N,'LENGTH_OF_STAY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LENGTH_OF_STAY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LENGTH_OF_STAY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(LENGTH_OF_STAY)=FALSE AND TO_CHAR(LENGTH_OF_STAY) NOT LIKE '%.00' AND LENGTH_OF_STAY IS NOT NULL"
ENROLLMENT,ENROLLMENT_30,N,'LOS_UNDER_THRESHOLD IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LOS_UNDER_THRESHOLD IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LOS_UNDER_THRESHOLD MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(LOS_UNDER_THRESHOLD)=FALSE AND TO_CHAR(LOS_UNDER_THRESHOLD) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_31,N,'PREVIOUS_STREET_ESSH IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PREVIOUS_STREET_ESSH IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PREVIOUS_STREET_ESSH MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PREVIOUS_STREET_ESSH)=FALSE AND TO_CHAR(PREVIOUS_STREET_ESSH) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_32,N,'TIMES_HOMELESS_PAST_THREE_YEARS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TIMES_HOMELESS_PAST_THREE_YEARS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TIMES_HOMELESS_PAST_THREE_YEARS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(TIMES_HOMELESS_PAST_THREE_YEARS)=FALSE AND TO_CHAR(TIMES_HOMELESS_PAST_THREE_YEARS) NOT LIKE '%.00' AND TIMES_HOMELESS_PAST_THREE_YEARS IS NOT NULL"
ENROLLMENT,ENROLLMENT_33,N,'MONTHS_HOMELESS_PAST_THREE_YEARS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MONTHS_HOMELESS_PAST_THREE_YEARS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MONTHS_HOMELESS_PAST_THREE_YEARS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(MONTHS_HOMELESS_PAST_THREE_YEARS)=FALSE AND TO_CHAR(MONTHS_HOMELESS_PAST_THREE_YEARS) NOT LIKE '%.00' AND MONTHS_HOMELESS_PAST_THREE_YEARS IS NOT NULL"
ENROLLMENT,ENROLLMENT_34,N,'DISABLING_CONDITION IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DISABLING_CONDITION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DISABLING_CONDITION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DISABLING_CONDITION)=FALSE AND TO_CHAR(DISABLING_CONDITION) NOT LIKE '%.00' AND DISABLING_CONDITION IS NOT NULL"
ENROLLMENT,ENROLLMENT_35,N,'CLIENT_ENROLLED_IN_PATH IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CLIENT_ENROLLED_IN_PATH IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CLIENT_ENROLLED_IN_PATH MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CLIENT_ENROLLED_IN_PATH)=FALSE AND TO_CHAR(CLIENT_ENROLLED_IN_PATH) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_36,N,'REASON_NOT_ENROLLED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'REASON_NOT_ENROLLED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REASON_NOT_ENROLLED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(REASON_NOT_ENROLLED)=FALSE AND TO_CHAR(REASON_NOT_ENROLLED) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_37,N,'PERCENT_AMI IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PERCENT_AMI IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PERCENT_AMI MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PERCENT_AMI)=FALSE AND TO_CHAR(PERCENT_AMI) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_38,N,'REFERRAL_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'REFERRAL_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REFERRAL_SOURCE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(REFERRAL_SOURCE)=FALSE AND TO_CHAR(REFERRAL_SOURCE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_39,N,'COUNT_OUTREACH_REFERRAL_APPROACHES IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COUNT_OUTREACH_REFERRAL_APPROACHES IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'COUNT_OUTREACH_REFERRAL_APPROACHES MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(COUNT_OUTREACH_REFERRAL_APPROACHES)=FALSE AND TO_CHAR(COUNT_OUTREACH_REFERRAL_APPROACHES) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_40,N,'ELIGIBLE_FOR_RHY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ELIGIBLE_FOR_RHY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ELIGIBLE_FOR_RHY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ELIGIBLE_FOR_RHY)=FALSE AND TO_CHAR(ELIGIBLE_FOR_RHY) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_41,N,'REASON_NO_SERVICES IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'REASON_NO_SERVICES IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REASON_NO_SERVICES MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(REASON_NO_SERVICES)=FALSE AND TO_CHAR(REASON_NO_SERVICES) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_42,N,'RUNAWAY_YOUTH IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'RUNAWAY_YOUTH IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RUNAWAY_YOUTH MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(RUNAWAY_YOUTH)=FALSE AND TO_CHAR(RUNAWAY_YOUTH) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_43,N,'SEXUAL_ORIENTATION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SEXUAL_ORIENTATION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SEXUAL_ORIENTATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SEXUAL_ORIENTATION)=FALSE AND TO_CHAR(SEXUAL_ORIENTATION) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_44,N,'SEXUAL_ORIENTATION_OTHER EXCEEDS 100 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SEXUAL_ORIENTATION_OTHER EXCEEDS 100 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SEXUAL_ORIENTATION_OTHER EXCEEDS 100 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SEXUAL_ORIENTATION_OTHER)>100"
ENROLLMENT,ENROLLMENT_45,N,'FORMER_WARD_CHILD_WELFARE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'FORMER_WARD_CHILD_WELFARE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'FORMER_WARD_CHILD_WELFARE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(FORMER_WARD_CHILD_WELFARE)=FALSE AND TO_CHAR(FORMER_WARD_CHILD_WELFARE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_46,N,'CHILD_WELFARE YEARS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CHILD_WELFARE YEARS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CHILD_WELFARE_YEARS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CHILD_WELFARE_YEARS)=FALSE AND TO_CHAR(CHILD_WELFARE_YEARS) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_47,N,'CHILD_WELFARE_MONTHS IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CHILD_WELFARE_MONTHS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CHILD_WELFARE_MONTHS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CHILD_WELFARE_MONTHS)=FALSE AND TO_CHAR(CHILD_WELFARE_MONTHS) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_48,N,'FORMER_WARD_JUVENILE_JUSTICE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'FORMER_WARD_JUVENILE_JUSTICE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'FORMER_WARD_JUVENILE_JUSTICE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(FORMER_WARD_JUVENILE_JUSTICE)=FALSE AND TO_CHAR(FORMER_WARD_JUVENILE_JUSTICE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_49,N,'JUVENILE_JUSTICE_YEARS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'JUVENILE_JUSTICE_YEARS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'JUVENILE_JUSTICE_YEARS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(JUVENILE_JUSTICE_YEARS)=FALSE AND TO_CHAR(JUVENILE_JUSTICE_YEARS) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_50,N,'JUVENILE_JUSTICE_MONTHS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'JUVENILE_JUSTICE_MONTHS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'JUVENILE_JUSTICE_MONTHS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(JUVENILE_JUSTICE_MONTHS)=FALSE AND TO_CHAR(JUVENILE_JUSTICE_MONTHS) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_51,N,'UNEMPLOYMENT_FAM IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'UNEMPLOYMENT_FAM IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'UNEMPLOYMENT_FAM MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(UNEMPLOYMENT_FAM)=FALSE AND TO_CHAR(UNEMPLOYMENT_FAM) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_52,N,'MENTAL_HEALTH_DISORDER_FAM IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MENTAL_HEALTH_DISORDER_FAM IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MENTAL_HEALTH_DISORDER_FAM MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(MENTAL_HEALTH_DISORDER_FAM)=FALSE AND TO_CHAR(MENTAL_HEALTH_DISORDER_FAM) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_53,N,'ALCOHOL_DRUG_USE_DISORDER_FAM IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ALCOHOL_DRUG_USE_DISORDER_FAM IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ALCOHOL_DRUG_USE_DISORDER_FAM MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ALCOHOL_DRUG_USE_DISORDER_FAM)=FALSE AND TO_CHAR(ALCOHOL_DRUG_USE_DISORDER_FAM) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_54,N,'INSUFFICIENT_INCOME IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'INSUFFICIENT_INCOME IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'INSUFFICIENT_INCOME MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(INSUFFICIENT_INCOME)=FALSE AND TO_CHAR(INSUFFICIENT_INCOME) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_55,N,'INCARCERATED_PARENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'INCARCERATED_PARENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'INCARCERATED_PARENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(INCARCERATED_PARENT)=FALSE AND TO_CHAR(INCARCERATED_PARENT) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_56,N,'VAMC_STATION EXCEEDS 5 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'VAMC_STATION EXCEEDS 5 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'VAMC_STATION EXCEEDS 5 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(VAMC_STATION)>5"
ENROLLMENT,ENROLLMENT_57,N,'TARGET_SCREEN_REQD IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TARGET_SCREEN_REQD IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TARGET_SCREEN_REQD MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(TARGET_SCREEN_REQD)=FALSE AND TO_CHAR(TARGET_SCREEN_REQD) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_58,N,'TIME_TO_HOUSING_LOSS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TIME_TO_HOUSING_LOSS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TIME_TO_HOUSING_LOSS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(TIME_TO_HOUSING_LOSS)=FALSE AND TO_CHAR(TIME_TO_HOUSING_LOSS) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_59,N,'ANNUAL_PERCENT_AMI IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ANNUAL_PERCENT_AMI IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ANNUAL_PERCENT_AMI MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ANNUAL_PERCENT_AMI)=FALSE AND TO_CHAR(ANNUAL_PERCENT_AMI) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_60,N,'LITERAL_HOMELESS_HISTORY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LITERAL_HOMELESS_HISTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LITERAL_HOMELESS_HISTORY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(LITERAL_HOMELESS_HISTORY)=FALSE AND TO_CHAR(LITERAL_HOMELESS_HISTORY) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_61,N,'CLIENT_LEASEHOLDER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CLIENT_LEASEHOLDER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CLIENT_LEASEHOLDER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CLIENT_LEASEHOLDER)=FALSE AND TO_CHAR(CLIENT_LEASEHOLDER) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_62,N,'HOH_LEASEHOLDER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HOH_LEASEHOLDER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HOH_LEASEHOLDER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(HOH_LEASEHOLDER)=FALSE AND TO_CHAR(HOH_LEASEHOLDER) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_63,N,'SUBSIDY_AT_RISK IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SUBSIDY_AT_RISK IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SUBSIDY_AT_RISK MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SUBSIDY_AT_RISK)=FALSE AND TO_CHAR(SUBSIDY_AT_RISK) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_64,N,'EVICTION_HISTORY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EVICTION_HISTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'EVICTION_HISTORY MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EVICTION_HISTORY)=FALSE AND TO_CHAR(EVICTION_HISTORY) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_65,N,'CRIMINAL_RECORD IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CRIMINAL_RECORD IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CRIMINAL_RECORD MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CRIMINAL_RECORD)=FALSE AND TO_CHAR(CRIMINAL_RECORD) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_66,N,'INCARCERATED_ADULT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'INCARCERATED_ADULT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'INCARCERATED_ADULT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(INCARCERATED_ADULT)=FALSE AND TO_CHAR(INCARCERATED_ADULT) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_67,N,'PRISON_DISCHARGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PRISON_DISCHARGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PRISON_DISCHARGE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PRISON_DISCHARGE)=FALSE AND TO_CHAR(PRISON_DISCHARGE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_68,N,'SEX_OFFENDER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SEX_OFFENDER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SEX_OFFENDER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SEX_OFFENDER)=FALSE AND TO_CHAR(SEX_OFFENDER) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_69,N,'DISABLED_HOH IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DISABLED_HOH IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DISABLED_HOH MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DISABLED_HOH)=FALSE AND TO_CHAR(DISABLED_HOH) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_70,N,'CURRENT_PREGNANT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CURRENT_PREGNANT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CURRENT_PREGNANT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CURRENT_PREGNANT)=FALSE AND TO_CHAR(CURRENT_PREGNANT) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_71,N,'SINGLE_PARENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SINGLE_PARENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SINGLE_PARENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SINGLE_PARENT)=FALSE AND TO_CHAR(SINGLE_PARENT) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_72,N,'DEPENDENT_UNDER6 IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DEPENDENT_UNDER6 IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DEPENDENT_UNDER6 MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DEPENDENT_UNDER6)=FALSE AND TO_CHAR(DEPENDENT_UNDER6) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_73,N,'HH5_PLUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HH5_PLUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HH5_PLUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(HH5_PLUS)=FALSE AND TO_CHAR(HH5_PLUS) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_74,N,'COC_PRIORITIZED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COC_PRIORITIZED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'COC_PRIORITIZED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(COC_PRIORITIZED)=FALSE AND TO_CHAR(COC_PRIORITIZED) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_75,N,'HP_SCREENING_SCORE IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HP_SCREENING_SCORE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HP_SCREENING_SCORE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(HP_SCREENING_SCORE)=FALSE AND TO_CHAR(HP_SCREENING_SCORE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_76,N,'THRESHOLD_SCORE IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'THRESHOLD_SCORE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'THRESHOLD_SCORE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(THRESHOLD_SCORE)=FALSE AND TO_CHAR(THRESHOLD_SCORE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_77,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
ENROLLMENT,ENROLLMENT_78,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
ENROLLMENT,ENROLLMENT_79,N,'RELATIONSHIP_TO_HOH NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'RELATIONSHIP_TO_HOH NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RELATIONSHIP_TO_HOH CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RELATIONSHIP_TO_HOH = c.VALID_VALUES and c.List_Name = '3.15.1' WHERE c.VALID_VALUES IS NULL AND a.RELATIONSHIP_TO_HOH IS NOT NULL"
ENROLLMENT,ENROLLMENT_80,N,'LIVING_SITUATION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'LIVING_SITUATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LIVING_SITUATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LIVING_SITUATION = c.VALID_VALUES and c.List_Name = '3.12.1' WHERE c.VALID_VALUES IS NULL AND a.LIVING_SITUATION IS NOT NULL"
ENROLLMENT,ENROLLMENT_81,N,'LENGTH_OF_STAY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'LENGTH_OF_STAY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LENGTH_OF_STAY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LENGTH_OF_STAY = c.VALID_VALUES and c.List_Name = '3.917.2' WHERE c.VALID_VALUES IS NULL AND a.LENGTH_OF_STAY IS NOT NULL"
ENROLLMENT,ENROLLMENT_82,N,'LOS_UNDER_THRESHOLD NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'LOS_UNDER_THRESHOLD NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LOS_UNDER_THRESHOLD CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LOS_UNDER_THRESHOLD = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.LOS_UNDER_THRESHOLD IS NOT NULL"
ENROLLMENT,ENROLLMENT_83,N,'PREVIOUS_STREET_ESSH NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'PREVIOUS_STREET_ESSH NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PREVIOUS_STREET_ESSH CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PREVIOUS_STREET_ESSH = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.PREVIOUS_STREET_ESSH IS NOT NULL"
ENROLLMENT,ENROLLMENT_84,N,'TIMES_HOMELESS_PAST_THREE_YEARS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'TIMES_HOMELESS_PAST_THREE_YEARS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TIMES_HOMELESS_PAST_THREE_YEARS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TIMES_HOMELESS_PAST_THREE_YEARS = c.VALID_VALUES and c.List_Name = '3.917.4' WHERE c.VALID_VALUES IS NULL AND a.TIMES_HOMELESS_PAST_THREE_YEARS IS NOT NULL"
ENROLLMENT,ENROLLMENT_85,N,'MONTHS_HOMELESS_PAST_THREE_YEARS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'MONTHS_HOMELESS_PAST_THREE_YEARS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MONTHS_HOMELESS_PAST_THREE_YEARS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MONTHS_HOMELESS_PAST_THREE_YEARS = c.VALID_VALUES and c.List_Name = '3.917.5' WHERE c.VALID_VALUES IS NULL AND a.MONTHS_HOMELESS_PAST_THREE_YEARS IS NOT NULL"
ENROLLMENT,ENROLLMENT_86,N,'DISABLING_CONDITION NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'DISABLING_CONDITION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DISABLING_CONDITION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DISABLING_CONDITION = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.DISABLING_CONDITION IS NOT NULL"
ENROLLMENT,ENROLLMENT_87,N,'CLIENT_ENROLLED_IN_PATH NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'CLIENT_ENROLLED_IN_PATH NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CLIENT_ENROLLED_IN_PATH CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.CLIENT_ENROLLED_IN_PATH AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.CLIENT_ENROLLED_IN_PATH IS NOT NULL"
ENROLLMENT,ENROLLMENT_88,N,'REASON_NOT_ENROLLED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'REASON_NOT_ENROLLED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REASON_NOT_ENROLLED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.REASON_NOT_ENROLLED = c.VALID_VALUES and c.List_Name = 'P3.A' WHERE c.VALID_VALUES IS NULL AND a.REASON_NOT_ENROLLED IS NOT NULL"
ENROLLMENT,ENROLLMENT_89,N,'PERCENT_AMI NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'PERCENT_AMI NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PERCENT_AMI CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PERCENT_AMI = c.VALID_VALUES and c.List_Name = 'V4.1' WHERE c.VALID_VALUES IS NULL AND a.PERCENT_AMI IS NOT NULL"
ENROLLMENT,ENROLLMENT_90,N,'REFERRAL_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'REFERRAL_SOURCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REFERRAL_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.REFERRAL_SOURCE = c.VALID_VALUES and c.List_Name = 'R1.1' WHERE c.VALID_VALUES IS NULL AND a.REFERRAL_SOURCE IS NOT NULL"
ENROLLMENT,ENROLLMENT_91,N,'ELIGIBLE_FOR_RHY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'ELIGIBLE_FOR_RHY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ELIGIBLE_FOR_RHY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ELIGIBLE_FOR_RHY = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.ELIGIBLE_FOR_RHY IS NOT NULL"
ENROLLMENT,ENROLLMENT_92,N,'REASON_NO_SERVICES NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'REASON_NO_SERVICES NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'REASON_NO_SERVICES CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.REASON_NO_SERVICES = c.VALID_VALUES and c.List_Name = 'R2.A' WHERE c.VALID_VALUES IS NULL AND a.REASON_NO_SERVICES IS NOT NULL"
ENROLLMENT,ENROLLMENT_93,N,'RUNAWAY_YOUTH NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'RUNAWAY_YOUTH NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RUNAWAY_YOUTH CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RUNAWAY_YOUTH = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.RUNAWAY_YOUTH IS NOT NULL"
ENROLLMENT,ENROLLMENT_94,N,'SEXUAL_ORIENTATION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'SEXUAL_ORIENTATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SEXUAL_ORIENTATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SEXUAL_ORIENTATION = c.VALID_VALUES and c.List_Name = 'R3.1' WHERE c.VALID_VALUES IS NULL AND a.SEXUAL_ORIENTATION IS NOT NULL"
ENROLLMENT,ENROLLMENT_95,N,'FORMER_WARD_CHILD_WELFARE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'FORMER_WARD_CHILD_WELFARE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'FORMER_WARD_CHILD_WELFARE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.FORMER_WARD_CHILD_WELFARE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.FORMER_WARD_CHILD_WELFARE IS NOT NULL"
ENROLLMENT,ENROLLMENT_96,N,'CHILD_WELFARE_YEARS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'CHILD_WELFARE_YEARS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CHILD_WELFARE_YEARS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CHILD_WELFARE_YEARS = c.VALID_VALUES and c.List_Name = 'R11.A' WHERE c.VALID_VALUES IS NULL AND a.CHILD_WELFARE_YEARS IS NOT NULL"
ENROLLMENT,ENROLLMENT_97,N,'FORMER_WARD_JUVENILE_JUSTICE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'FORMER_WARD_JUVENILE_JUSTICE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'FORMER_WARD_JUVENILE_JUSTICE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.FORMER_WARD_JUVENILE_JUSTICE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.FORMER_WARD_JUVENILE_JUSTICE IS NOT NULL"
ENROLLMENT,ENROLLMENT_98,N,'JUVENILE_JUSTICE_YEARS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'JUVENILE_JUSTICE_YEARS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'JUVENILE_JUSTICE_YEARS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.JUVENILE_JUSTICE_YEARS = c.VALID_VALUES and c.List_Name = 'R11.A' WHERE c.VALID_VALUES IS NULL AND a.JUVENILE_JUSTICE_YEARS IS NOT NULL"
ENROLLMENT,ENROLLMENT_99,N,'UNEMPLOYMENT_FAM NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'UNEMPLOYMENT_FAM NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'UNEMPLOYMENT_FAM CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.UNEMPLOYMENT_FAM = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.UNEMPLOYMENT_FAM IS NOT NULL"
ENROLLMENT,ENROLLMENT_100,N,'MENTAL_HEALTH_DISORDER_FAM IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'MENTAL_HEALTH_DISORDER_FAM IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MENTAL_HEALTH_DISORDER_FAM CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MENTAL_HEALTH_DISORDER_FAM = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.MENTAL_HEALTH_DISORDER_FAM IS NOT NULL"
ENROLLMENT,ENROLLMENT_101,N,'PHYSICAL_DISABILITY_FAM IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'PHYSICAL_DISABILITY_FAM IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PHYSICAL_DISABILITY_FAM CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PHYSICAL_DISABILITY_FAM = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.PHYSICAL_DISABILITY_FAM IS NOT NULL"
ENROLLMENT,ENROLLMENT_102,N,'ALCOHOL_DRUG_USE_DISORDER_FAM IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'ALCOHOL_DRUG_USE_DISORDER_FAM IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ALCOHOL_DRUG_USE_DISORDER_FAM CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ALCOHOL_DRUG_USE_DISORDER_FAM = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.ALCOHOL_DRUG_USE_DISORDER_FAM IS NOT NULL"
ENROLLMENT,ENROLLMENT_103,N,'INSUFFICIENT_INCOME NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'INSUFFICIENT_INCOME NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'INSUFFICIENT_INCOME CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INSUFFICIENT_INCOME = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.INSUFFICIENT_INCOME IS NOT NULL"
ENROLLMENT,ENROLLMENT_104,N,'INCARCERATED_PARENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'INCARCERATED_PARENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'INCARCERATED_PARENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INCARCERATED_PARENT = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.INCARCERATED_PARENT IS NOT NULL"
ENROLLMENT,ENROLLMENT_105,N,'VAMC_STATION NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'VAMC_STATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'VAMC_STATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VAMC_STATION = c.VALID_VALUES and c.List_Name = 'V6.1' WHERE c.VALID_VALUES IS NULL AND Coalesce(VAMC_STATION, '') <> ''"
ENROLLMENT,ENROLLMENT_106,N,'TARGET_SCREEN_REQD NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'TARGET_SCREEN_REQD NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TARGET_SCREEN_REQD CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TARGET_SCREEN_REQD = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.TARGET_SCREEN_REQD IS NOT NULL"
ENROLLMENT,ENROLLMENT_107,N,'TIME_TO_HOUSING_LOSS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'TIME_TO_HOUSING_LOSS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TIME_TO_HOUSING_LOSS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.TIME_TO_HOUSING_LOSS AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = 'V7.A' WHERE c.VALID_VALUES IS NULL AND a.TIME_TO_HOUSING_LOSS IS NOT NULL"
ENROLLMENT,ENROLLMENT_108,N,'ANNUAL_PERCENT_AMI NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'ANNUAL_PERCENT_AMI NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ANNUAL_PERCENT_AMI CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.ANNUAL_PERCENT_AMI AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = 'V7.B' WHERE c.VALID_VALUES IS NULL AND a.ANNUAL_PERCENT_AMI IS NOT NULL"
ENROLLMENT,ENROLLMENT_109,N,'LITERAL_HOMELESS_HISTORY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'LITERAL_HOMELESS_HISTORY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'LITERAL_HOMELESS_HISTORY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LITERAL_HOMELESS_HISTORY = c.VALID_VALUES and c.List_Name = 'V7.C' WHERE c.VALID_VALUES IS NULL AND a.LITERAL_HOMELESS_HISTORY IS NOT NULL"
ENROLLMENT,ENROLLMENT_110,N,'CLIENT_LEASEHOLDER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'CLIENT_LEASEHOLDER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CLIENT_LEASEHOLDER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CLIENT_LEASEHOLDER = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.CLIENT_LEASEHOLDER IS NOT NULL"
ENROLLMENT,ENROLLMENT_111,N,'HOH_LEASEHOLDER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'HOH_LEASEHOLDER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HOH_LEASEHOLDER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HOH_LEASEHOLDER = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.HOH_LEASEHOLDER IS NOT NULL"
ENROLLMENT,ENROLLMENT_112,N,'SUBSIDY_AT_RISK NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'SUBSIDY_AT_RISK NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SUBSIDY_AT_RISK CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.SUBSIDY_AT_RISK AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SUBSIDY_AT_RISK IS NOT NULL"
ENROLLMENT,ENROLLMENT_113,N,'EVICTION_HISTORY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'EVICTION_HISTORY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'EVICTION_HISTORY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.EVICTION_HISTORY AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = 'V7.G' WHERE c.VALID_VALUES IS NULL AND a.EVICTION_HISTORY IS NOT NULL"
ENROLLMENT,ENROLLMENT_114,N,'CRIMINAL_RECORD NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'CRIMINAL_RECORD NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CRIMINAL_RECORD CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.CRIMINAL_RECORD AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.CRIMINAL_RECORD IS NOT NULL"
ENROLLMENT,ENROLLMENT_115,N,'INCARCERATED_ADULT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'INCARCERATED_ADULT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'INCARCERATED_ADULT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INCARCERATED_ADULT = c.VALID_VALUES and c.List_Name = 'V7.I' WHERE c.VALID_VALUES IS NULL AND a.INCARCERATED_ADULT IS NOT NULL"
ENROLLMENT,ENROLLMENT_116,N,'PRISON_DISCHARGE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'PRISON_DISCHARGE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PRISON_DISCHARGE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PRISON_DISCHARGE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.PRISON_DISCHARGE IS NOT NULL"
ENROLLMENT,ENROLLMENT_117,N,'SEX_OFFENDER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'SEX_OFFENDER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SEX_OFFENDER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SEX_OFFENDER = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SEX_OFFENDER IS NOT NULL"
ENROLLMENT,ENROLLMENT_118,N,'DISABLED_HOH NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'DISABLED_HOH NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DISABLED_HOH CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.DISABLED_HOH AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.DISABLED_HOH IS NOT NULL"
ENROLLMENT,ENROLLMENT_119,N,'CURRENT_PREGNANT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'CURRENT_PREGNANT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CURRENT_PREGNANT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CURRENT_PREGNANT = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.CURRENT_PREGNANT IS NOT NULL"
ENROLLMENT,ENROLLMENT_120,N,'SINGLE_PARENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'SINGLE_PARENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'SINGLE_PARENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.SINGLE_PARENT AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SINGLE_PARENT IS NOT NULL"
ENROLLMENT,ENROLLMENT_121,N,'DEPENDENT_UNDER6 NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'DEPENDENT_UNDER6 NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DEPENDENT_UNDER6 CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.DEPENDENT_UNDER6 AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = 'V7.O' WHERE c.VALID_VALUES IS NULL AND a.DEPENDENT_UNDER6 IS NOT NULL"
ENROLLMENT,ENROLLMENT_122,N,'HH5_PLUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'HH5_PLUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HH5_PLUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.HH5_PLUS AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.HH5_PLUS IS NOT NULL"
ENROLLMENT,ENROLLMENT_123,N,'COC_PRIORITIZED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'COC_PRIORITIZED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'COC_PRIORITIZED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.COC_PRIORITIZED = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.COC_PRIORITIZED IS NOT NULL"
ENROLLMENT,ENROLLMENT_124,N,'ENTRY_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENTRY_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENTRY_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(ENTRY_DATE,1,10) NOT LIKE '%____-__-__%' AND ENTRY_DATE IS NOT NULL"
ENROLLMENT,ENROLLMENT_125,N,'DATE_TO_STREET_ESSH NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_TO_STREET_ESSH NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_TO_STREET_ESSH NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_TO_STREET_ESSH,1,10) NOT LIKE '%____-__-__%'"
ENROLLMENT,ENROLLMENT_126,N,'DATE_OF_ENGAGEMENT NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_OF_ENGAGEMENT NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_OF_ENGAGEMENT NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_OF_ENGAGEMENT,1,10) NOT LIKE '%____-__-__%' AND DATE_OF_ENGAGEMENT IS NOT NULL"
ENROLLMENT,ENROLLMENT_127,N,'MOVE_IN_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MOVE_IN_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MOVE_IN_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(MOVE_IN_DATE,1,10) NOT LIKE '%____-__-__%' AND MOVE_IN_DATE IS NOT NULL"
ENROLLMENT,ENROLLMENT_128,N,'DATE_OF_PATH_STATUS NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_OF_PATH_STATUS NOT IN FORMAT YYYY-MM-DD ' DESCR,'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_OF_PATH_STATUS NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_OF_PATH_STATUS,1,10) NOT LIKE '%____-__-__%'"
ENROLLMENT,ENROLLMENT_129,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
ENROLLMENT,ENROLLMENT_130,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
ENROLLMENT,ENROLLMENT_131,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
ENROLLMENT,ENROLLMENT_132,Y,ENROLLMENT SECONDARY VALIDATION - CLIENT RECORD EXCLUDED',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT SECONDARY VALIDTION - CLIENT RECORD EXCLUDED' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CORRESPONDING CLIENT RECORD EXCLUDED' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 INNER JOIN STAGING.PSTG_CLIENT C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PSTG_PROCESS_FLAG = 0"
ENROLLMENT,ENROLLMENT_133,Y,'ENROLLMENT SECONDARY VALIDATION - PROJECT RECORD EXCLUDED',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT SECONDARY VALIDATION - PROJECT RECORD EXCLUDED' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'CORRESPONDING PROJECT RECORD EXCLUDED' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 INNER JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PSTG_PROCESS_FLAG = 0"
ENROLLMENT,ENROLLMENT_134,N,'ENROLLMENT_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1LEFT JOIN (SELECT ENROLLMENT_ID, SOURCE_FILE FROM STAGING.PSTG_ENROLLMENT GROUP BY ENROLLMENT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ENROLLMENT_ID IS NOT NULL"
ENROLLMENT,ENROLLMENT_135,N,'RENTAL_SUBSIDY_TYPE NULL UNLESS LIVING_SITUATION = 435',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'RENTAL_SUBSIDY_TYPE NULL UNLESS LIVING_SITUATION = 435' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RENTAL_SUBSIDY_TYPE IS NULL UNLESS LIVING_SITUATION = 435' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (RENTAL_SUBSIDY_TYPE IS NULL AND LIVING_SITUATION = 435) OR (RENTAL_SUBSIDY_TYPE IS NOT NULL AND LIVING_SITUATION <> 435)"
ENROLLMENT,ENROLLMENT_136,N,'RENTAL_SUBSIDY_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'RENTAL_SUBSIDY_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RENTAL_SUBSIDY_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(RENTAL_SUBSIDY_TYPE)=FALSE AND TO_CHAR(RENTAL_SUBSIDY_TYPE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_137,N,RENTAL_SUBSIDY_TYPE NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.STG_MD5_HASH_VALUE else a.ENROLLMENT_ID end BUSINESS_KEY_VALUE,'RENTAL_SUBSIDY_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'RENTAL_SUBSIDY_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RENTAL_SUBSIDY_TYPE = c.VALID_VALUES and c.List_Name = '3.12.A' WHERE c.VALID_VALUES IS NULL AND LIVING_SITUATION = 435"
ENROLLMENT,ENROLLMENT_138,N,'TRANSLATION_NEEDED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TRANSLATION_NEEDED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TRANSLATION_NEEDED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(TRANSLATION_NEEDED)=FALSE AND TO_CHAR(TRANSLATION_NEEDED) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_139,N,'TRANSLATION_NEEDED NOT IN HUD LIST ',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, case when a.ENROLLMENT_ID is null then a.stg_md5_hash_value else a.enrollment_id end BUSINESS_KEY_VALUE,'TRANSLATION_NEEDED NOT IN HUD LIST ' DESCR , 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'TRANSLATION_NEEDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TRANSLATION_NEEDED = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL"
ENROLLMENT,ENROLLMENT_140,N,'PREFERRED_LANGUAGE_DIFFERENT NULL UNLESS PREFERRED_LANGUAGE = 21',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PREFERRED_LANGUAGE_DIFFERENT NULL UNLESS PREFERRED_LANGUAGE = 21' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PREFERRED_LANGUAGE_DIFFERENT IS NULL UNLESS PREFERRED_LANGUAGE = 21' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (PREFERRED_LANGUAGE_DIFFERENT IS NULL AND PREFERRED_LANGUAGE = 21) OR (PREFERRED_LANGUAGE_DIFFERENT IS NOT NULL AND PREFERRED_LANGUAGE <> 21)"
ENROLLMENT,ENROLLMENT_141,N,'PREFERRED_LANGUAGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PREFERRED_LANGUAGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PREFERRED_LANGUAGE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PREFERRED_LANGUAGE)=FALSE AND TO_CHAR(PREFERRED_LANGUAGE) NOT LIKE '%.00'"
ENROLLMENT,ENROLLMENT_142,N,'ENTRY_DATE IS BEFORE 1995',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED , A.EXPORT_ID , A.SOURCE_FILE , 'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'ENTRY_DATE IS BEFORE 1995' DESCR ,'ERROR' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENTRY DATE IS BEFORE 1995' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE YEAR(DATE(ENTRY_DATE)) < 1995"
ENROLLMENT,ENROLLMENT_143,N,ENTRY_DATE < OPERATING_START_DATE AND ENTRY_DATE > EXPORT_DATE,HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENTRY_DATE >OPERATING_START_DATE FOR PROJECT_ID AND < EXPORT_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME,DATE(A.ENTRY_DATE) ERROR_DATE_VALUE, 'ENTRY_DATE MUST BE GREATER THAN THE OPERATING_START_DATE FOR PROJECT_ID AND LESS THAN EXPORT_DATE' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_EXPORT D ON A.EXPORT_ID = D.EXPORT_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE DATE(A.ENTRY_DATE) < DATE(C.OPERATING_START_DATE) AND DATE(A.ENTRY_DATE) > DATE(D.EXPORT_DATE)"
ENROLLMENT,ENROLLMENT_144,N,'COUNT OF RELATION_TO_HOH = 1 MUST = 1 FOR EACH HOUSEHOLD_ID',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COUNT OF RELATION_TO_HOH = 1 MUST = 1 FOR EACH HOUSEHOLD_ID' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(A.ENTRY_DATE) ERROR_DATE_VALUE, 'There must be one and only one head of household per HouseholdID.' ERROR_MESSAGE FROM(SELECT count(RELATIONSHIP_TO_HOH) AS CNT_RELATIONSHIP_TO_HOH, ENTRY_DATE, ENROLLMENT_ID, EXPORT_ID, SOURCE_FILE, STG_MD5_HASH_VALUE FROM STAGING.PSTG_ENROLLMENT  GROUP BY ENTRY_DATE, ENROLLMENT_ID, EXPORT_ID, SOURCE_FILE, STG_MD5_HASH_VALUE) A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE A.CNT_RELATIONSHIP_TO_HOH > 1"
EVENT,EVENT_1,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
EVENT,EVENT_2,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
EVENT,EVENT_3,N,'EVENT_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EVENT_DATE IS NULL"
EVENT,EVENT_4,N,'EVENT IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EVENT IS NULL"
EVENT,EVENT_5,N,'RESULT_DATE IS NULL UNLESS REFERRAL_RESULT NOT NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'RESULT_DATE IS NULL UNLESS REFERRAL_RESULT NOT NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'ResultDate cannot be null when ReferralResult is populated.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (RESULT_DATE IS NULL AND REFERRAL_RESULT IS NOT NULL) OR (RESULT_DATE IS NOT NULL AND REFERRAL_RESULT IS NULL)"
EVENT,EVENT_6,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
EVENT,EVENT_7,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
EVENT,EVENT_8,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
EVENT,EVENT_9,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.EVENT_ID||'|'||SRC.ENROLLMENT_ID||'|'||SRC.PERSONAL_ID||'|'||SRC.EVENT_DATE||'|'||SRC.EVENT is null then SRC.STG_MD5_HASH_VALUE else  SRC.EVENT_ID||'|'||SRC.ENROLLMENT_ID||'|'||SRC.PERSONAL_ID||'|'||SRC.EVENT_DATE||'|'||SRC.EVENT end) AS BUSINESS_KEY_VALUE, SRC.EVENT_DATE  FROM STAGING.PSTG_EVENT SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME ,  (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
EVENT,EVENT_10,N,'EVENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EVENT_ID IS NULL"
EVENT,EVENT_11,N,'EVENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EVENT_ID)>32"
EVENT,EVENT_12,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
EVENT,EVENT_13,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
EVENT,EVENT_14,N,EVENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EVENT)=FALSE AND TO_CHAR(EVENT) NOT LIKE '%.00'"
EVENT,EVENT_15,N,'PROB_SOL_DIV_RR_RESULT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'PROB_SOL_DIV_RR_RESULT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'PROB_SOL_DIV_RR_RESULT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PROB_SOL_DIV_RR_RESULT)=FALSE AND TO_CHAR(PROB_SOL_DIV_RR_RESULT) NOT LIKE '%.00'"
EVENT,EVENT_16,N,'REFERRAL_CASE_MANAGE_AFTER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'REFERRAL_CASE_MANAGE_AFTER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'REFERRAL_CASE_MANAGE_AFTER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(REFERRAL_CASE_MANAGE_AFTER)=FALSE AND TO_CHAR(REFERRAL_CASE_MANAGE_AFTER) NOT LIKE '%.00'"
EVENT,EVENT_17,N,'LOCATION_CRISISOR_PH_HOUSING EXCEEDS 250 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'LOCATION_CRISISOR_PH_HOUSING EXCEEDS 250 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'LOCATION_CRISISOR_PH_HOUSING EXCEEDS 250 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(LOCATION_CRISISOR_PH_HOUSING)>250"
EVENT,EVENT_18,N,'REFERRAL_RESULT IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'REFERRAL_RESULT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'REFERRAL_RESULT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(REFERRAL_RESULT)=FALSE AND TO_CHAR(REFERRAL_RESULT) NOT LIKE '%.00'"
EVENT,EVENT_19,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
EVENT,EVENT_20,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
EVENT,EVENT_21,N,'EVENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EVENT = c.VALID_VALUES and c.List_Name = '4.20.2' WHERE c.VALID_VALUES IS NULL AND a.EVENT IS NOT NULL"
EVENT,EVENT_22,N,'PROB_SOL_DIV_RR_RESULT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'PROB_SOL_DIV_RR_RESULT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'PROB_SOL_DIV_RR_RESULT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PROB_SOL_DIV_RR_RESULT = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.PROB_SOL_DIV_RR_RESULT IS NOT NULL"
EVENT,EVENT_23,N,'REFERRAL_CASE_MANAGE_AFTER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'REFERRAL_CASE_MANAGE_AFTER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'REFERRAL_CASE_MANAGE_AFTER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.REFERRAL_CASE_MANAGE_AFTER = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.REFERRAL_CASE_MANAGE_AFTER IS NOT NULL"
EVENT,EVENT_24,N,'REFERRAL_RESULT NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'REFERRAL_RESULT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'REFERRAL_RESULT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EVENT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.REFERRAL_RESULT = c.VALID_VALUES and c.List_Name = '4.20.D' WHERE c.VALID_VALUES IS NULL AND a.REFERRAL_RESULT IS NOT NULL"
EVENT,EVENT_25,N,'EVENT_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(EVENT_DATE,1,10) NOT LIKE '%____-__-__%'"
EVENT,EVENT_26,N,'RESULT_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'RESULT_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'RESULT_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(RESULT_DATE,1,10) NOT LIKE '%____-__-__%'"
EVENT,EVENT_27,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
EVENT,EVENT_28,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
EVENT,EVENT_29,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
EVENT,EVENT_30,N,'EVENT_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EVENT' TABLE_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then 'STG_MD5_HASH_VALUE'else 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' end) BUSINESS_KEY_FIELD_NAME, (case when A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT is null then A.STG_MD5_HASH_VALUE else A.EVENT_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.EVENT_DATE||'|'||A.EVENT end) BUSINESS_KEY_VALUE,'EVENT_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'EVENT_DATE' ERROR_DATE_FIELD_NAME, DATE(EVENT_DATE) ERROR_DATE_VALUE, 'EVENT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_EVENT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT EVENT_ID, SOURCE_FILE FROM STAGING.PSTG_EVENT GROUP BY EVENT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.EVENT_ID = C.EVENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.EVENT_ID IS NOT NULL"
EXIT,EXIT_1,N,'ENROLLMENT_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
EXIT,EXIT_2,N,'PERSONAL_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
EXIT,EXIT_4,N,'DESTINATION IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DESTINATION IS NULL"
EXIT,EXIT_5,N,'OTHER_DESTINATION IS NULL UNLESS DESTINATION = 17',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'OTHER_DESTINATION IS NULL UNLESS DESTINATION = 17' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'OTHER_DESTINATION NULL UNLESS DESTINATION = 17' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (OTHER_DESTINATION IS NULL AND DESTINATION = 17) OR (OTHER_DESTINATION IS NOT NULL AND DESTINATION <> 17)"
EXIT,EXIT_6,N,'COUNT_OF_EXCHANGE_FOR_SEX IS NULL UNLESS EXCHANGE_FOR_SEX = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COUNT_OF_EXCHANGE_FOR_SEX IS NULL UNLESS EXCHANGE_FOR_SEX = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COUNT_OF_EXCHANGE_FOR_SEX NULL UNLESS EXCHANGE_FOR_SEX =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (COUNT_OF_EXCHANGE_FOR_SEX IS NULL AND EXCHANGE_FOR_SEX = 1) OR (COUNT_OF_EXCHANGE_FOR_SEX IS NOT NULL AND EXCHANGE_FOR_SEX <> 1)"
EXIT,EXIT_7,N,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NULL UNLESS EXCHANGE_FOR_SEX = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NULL UNLESS EXCHANGE_FOR_SEX = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX NULL UNLESS EXCHANGE_FOR_SEX =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NULL AND EXCHANGE_FOR_SEX = 1) OR (ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NOT NULL AND EXCHANGE_FOR_SEX <> 1)"
EXIT,EXIT_8,N,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NULL UNLESS ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NULL UNLESS ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS NULL UNLESS EXCHANGE_FOR_SEX =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NULL AND EXCHANGE_FOR_SEX = 1) OR (ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT NULL AND EXCHANGE_FOR_SEX <> 1)"
EXIT,EXIT_9,N,'COERCED_TO_CONTINUE_WORK IS NULL UNLESS WORKPLACE_VIOLENCE_THREATS =1 OR WORKPLACE_PROMISE_DIFFERENCE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COERCED_TO_CONTINUE_WORK IS NULL UNLESS WORKPLACE_VIOLENCE_THREATS =1 OR WORKPLACE_PROMISE_DIFFERENCE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COERCED_TO_CONTINUE_WORK NULL UNLESS WORKPLACE_VIOLENCE_THREATS = 1 OR WORKPLACE_PROMISE_DIFFERENCE = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (COERCED_TO_CONTINUE_WORK IS NULL AND (WORKPLACE_VIOLENCE_THREATS =1 OR WORKPLACE_PROMISE_DIFFERENCE = 1)) OR (COERCED_TO_CONTINUE_WORK IS NOT NULL AND (WORKPLACE_VIOLENCE_THREATS <> 1 OR WORKPLACE_PROMISE_DIFFERENCE <> 1))"
EXIT,EXIT_10,N,'LABOR_EXPLOIT_PAST_THREE_MONTHS IS NULL UNLESS WORKPLACE_VIOLENCE_THREATS = 1 OR WORKPLACE_PROMISE_DIFFERENCE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LABOR_EXPLOIT_PAST_THREE_MONTHS IS NULL UNLESS WORKPLACE_VIOLENCE_THREATS = 1 OR WORKPLACE_PROMISE_DIFFERENCE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'LABOR_EXPLOIT_PAST_THREE_MONTHS NULL UNLESS WORKPLACE_VIOLENCE_THREATS = 1 OR WORKPLACE_PROMISE_DIFFERENCE = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (LABOR_EXPLOIT_PAST_THREE_MONTHS IS NULL AND (WORKPLACE_VIOLENCE_THREATS =1 OR WORKPLACE_PROMISE_DIFFERENCE = 1)) OR (LABOR_EXPLOIT_PAST_THREE_MONTHS IS NOT NULL AND (WORKPLACE_VIOLENCE_THREATS <> 1 OR WORKPLACE_PROMISE_DIFFERENCE <> 1))"
EXIT,EXIT_11,N,'INDIVIDUAL_COUNSELING IS NULL UNLESS COUNSELING_RECEIVED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'INDIVIDUAL_COUNSELING IS NULL UNLESS COUNSELING_RECEIVED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'INDIVIDUAL_COUNSELING NULL UNLESS COUNSELING_RECEIVED =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (INDIVIDUAL_COUNSELING IS NULL AND COUNSELING_RECEIVED = 1) OR (INDIVIDUAL_COUNSELING IS NOT NULL AND COUNSELING_RECEIVED <> 1)"
EXIT,EXIT_12,N,'FAMILY_COUSELING IS NULL UNLESS COUNSELING_RECEIVED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'FAMILY_COUSELING IS NULL UNLESS COUNSELING_RECEIVED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'FAMILY_COUNSELING NULL UNLESS COUNSELING_RECEIVED =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (FAMILY_COUNSELING IS NULL AND COUNSELING_RECEIVED = 1) OR (FAMILY_COUNSELING IS NOT NULL AND COUNSELING_RECEIVED <> 1)"
EXIT,EXIT_13,N,'GROUP_COUNSELING IS NULL UNLESS COUNSELING_RECEIVED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'GROUP_COUNSELING IS NULL UNLESS COUNSELING_RECEIVED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'GROUP_COUNSELING NULL UNLESS COUNSELING_RECEIVED =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (GROUP_COUNSELING IS NULL AND COUNSELING_RECEIVED = 1) OR (GROUP_COUNSELING IS NOT NULL AND COUNSELING_RECEIVED <> 1)"
EXIT,EXIT_14,N,'SESSION_COUNT_AT_EXIT IS NULL UNLESS COUSELING_RECEIVED = 1 OR SESSION_COUNT_AT_EXIT < 0 NON-INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SESSION_COUNT_AT_EXIT IS NULL UNLESS COUSELING_RECEIVED = 1 OR SESSION_COUNT_AT_EXIT < 0 NON-INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'GROUP_COUNSELING NULL UNLESS COUNSELING_RECEIVED =1 OR SESSION_COUNT_AT_EXIT AN INTEGER < 0' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (SESSION_COUNT_AT_EXIT IS NULL AND COUNSELING_RECEIVED = 1) OR (SESSION_COUNT_AT_EXIT IS NOT NULL AND COUNSELING_RECEIVED <>1) OR SESSION_COUNT_AT_EXIT < 0 OR (IS_INTEGER(SESSION_COUNT_AT_EXIT)=FALSE AND TO_CHAR(SESSION_COUNT_AT_EXIT) NOT LIKE '%.00')"
EXIT,EXIT_15,N,'SESSIONS_IN_PLAN IS NOT AN INTEGER > 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SESSIONS_IN_PLAN IS NOT AN INTEGER > 0' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'SESSIONS_IN_PLAN MUST BE AN INTEGER GREATER THAN 0' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (IS_INTEGER(SESSIONS_IN_PLAN) = FALSE AND TO_CHAR(SESSIONS_IN_PLAN) NOT LIKE '%.00') OR SESSIONS_IN_PLAN < 0"
EXIT,EXIT_16,N,'AFTERCARE_DATE IS NULL UNLESS BETWEEN EXIT_DATE AND EXIT_DATE + 180 AND AFTERCARE_PROVIDED IS NOT NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'AFTERCARE_DATE IS NULL UNLESS BETWEEN EXIT_DATE AND EXIT_DATE + 180 AND AFTERCARE_PROVIDED IS NOT NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'AFTERCARE_DATE NULL UNLESS BETWEEN EXIT_DATE AND EXIT_DATE + 180 DAYS AND AFTERCARE_PROVIDED IS NOT NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE AFTERCARE_PROVIDED IS NOT NULL AND (DATE(AFTERCARE_DATE) IS NULL AND DATE(AFTERCARE_DATE) BETWEEN DATE(EXIT_DATE) AND DATEADD(DAY,180,DATE(EXIT_DATE)))"
EXIT,EXIT_17,N,'AFTERCARE_PROVIDED IS NULL UNLESS AFTERCARE_DATE IS BETWEEN EXIT_DATE AND EXIT_DATE + 180',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'AFTERCARE_PROVIDED IS NULL UNLESS AFTERCARE_DATE IS BETWEEN EXIT_DATE AND EXIT_DATE + 180' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'AFTERCARE_PROVIDED NULL UNLESS AFTERCARE_DATE IS BETWEEN EXIT_DATE AND EXIT_DATE + 180 DAYS' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (AFTERCARE_PROVIDED IS NULL AND DATE(AFTERCARE_DATE) BETWEEN DATE(EXIT_DATE) AND DATEADD(DAY,180,DATE(EXIT_DATE))) "
EXIT,EXIT_18,N,'EMAIL_SOCIAL_MEDIA IS NULL UNLESS AFTERCARE_PROVIDED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EMAIL_SOCIAL_MEDIA IS NULL UNLESS AFTERCARE_PROVIDED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EMAIL_SOCIAL_MEDIA NULL UNLESS AFTERCARE_PROVIDED = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (EMAIL_SOCIAL_MEDIA IS NULL AND AFTERCARE_PROVIDED = 1) OR (EMAIL_SOCIAL_MEDIA IS NOT NULL AND AFTERCARE_PROVIDED <> 1)"
EXIT,EXIT_19,N,'TELEPHONE IS NULL UNLESS AFTERCARE_PROVIDED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TELEPHONE IS NULL UNLESS AFTERCARE_PROVIDED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'TELEPHONE NULL UNLESS AFTERCARE_PROVIDED = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (TELEPHONE IS NULL AND AFTERCARE_PROVIDED = 1) OR (TELEPHONE IS NOT NULL AND AFTERCARE_PROVIDED <> 1)"
EXIT,EXIT_20,N,'IN_PERSON_INDIVIDUAL IS NULL UNLESS AFTERCARE_PROVIDED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'IN_PERSON_INDIVIDUAL IS NULL UNLESS AFTERCARE_PROVIDED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'IN_PERSON_INDIVIDUAL NULL UNLESS AFTERCARE_PROVIDED = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (IN_PERSON_INDIVIDUAL IS NULL AND AFTERCARE_PROVIDED = 1) OR (IN_PERSON_INDIVIDUAL IS NOT NULL AND AFTERCARE_PROVIDED <> 1)"
EXIT,EXIT_21,N,'IN_PERSON_GROUP IS NULL UNLESS AFTERCARE_PROVIDED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'IN_PERSON_GROUP IS NULL UNLESS AFTERCARE_PROVIDED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'IN_PERSON_GROUP NULL UNLESS AFTERCARE_PROVIDED = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (IN_PERSON_GROUP IS NULL AND AFTERCARE_PROVIDED = 1) OR (IN_PERSON_GROUP IS NOT NULL AND AFTERCARE_PROVIDED <> 1)"
EXIT,EXIT_22,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
EXIT,EXIT_23,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
EXIT,EXIT_24,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
EXIT,EXIT_25,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,0,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.EXIT_ID||'|'||SRC.ENROLLMENT_ID is null then SRC.STG_MD5_HASH_VALUE else SRC.EXIT_ID||'|'||SRC.ENROLLMENT_ID end) AS BUSINESS_KEY_VALUE, SRC.EXIT_DATE FROM STAGING.PSTG_EXIT SRC join staging.rt_coc_control b on  SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND  SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE,  'PSTG_EXIT' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end)  BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL'  WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end  DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN  'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end  ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
EXIT,EXIT_26,N,'EARLY_EXIT_REASON IS NULL UNLESS PROJECT_COMPLETION_STATUS = 3',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EARLY_EXIT_REASON IS NULL UNLESS PROJECT_COMPLETION_STATUS = 3' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EARLY_EXIT_REASON CANNOT BE NULL UNLESS PROJECT_COMPLETION_STATUS = 3' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (EARLY_EXIT_REASON IS NULL AND PROJECT_COMPLETION_STATUS = 3) OR (EARLY_EXIT_REASON IS NOT NULL AND PROJECT_COMPLETION_STATUS <> 3)"
EXIT,EXIT_27,N,'DESTINATION_SUBSIDY_TYPE IS NULL UNLESS DESTINATION = 435',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION_SUBSIDY_TYPE IS NULL UNLESS DESTINATION = 435' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SUBSIDY_TYPE IS NULL UNLESS DESTINATION = 435' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (DESTINATION_SUBSIDY_TYPE IS NULL AND DESTINATION = 435) OR (DESTINATION_SUBSIDY_TYPE IS NOT NULL AND DESTINATION <> 435)"
EXIT,EXIT_28,N,'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NULL UNLESS EXCHANGE_FOR_SEX = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NULL UNLESS EXCHANGE_FOR_SEX = 1' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS NULL UNLESS EXCHANGE_FOR_SEX =1' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NULL AND EXCHANGE_FOR_SEX = 1) OR (EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT NULL AND EXCHANGE_FOR_SEX <> 1)"
EXIT,EXIT_29,N,"'IF EXIT_DATE IS NOT NULL, IT MUST BE >= ENTRY_DATE'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||A.ENROLLMENT_ID BUSINESS_KEY_VALUE,'IF EXIT_DATE IS NOT NULL, IT MUST BE >= ENTRY_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'The enrollment Exit Date is before the Entry Date.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT c ON a.ENROLLMENT_ID = c.ENROLLMENT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE DATE(a.EXIT_DATE) is not null AND DATE(a.EXIT_DATE) < DATE(c.ENTRY_DATE)"
EXIT,EXIT_30,N,"DESTINATION IN (17,30,37)",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION IN (17,30,37)' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'Unknown Destination.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DESTINATION IN (17,30,37)"
EXIT,EXIT_31,N,'EXIT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXIT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXIT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXIT_ID IS NULL"
EXIT,EXIT_32,N,'EXIT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXIT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXIT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXIT_ID)>32"
EXIT,EXIT_33,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
EXIT,EXIT_34,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
EXIT,EXIT_35,N,'DESTINATION IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DESTINATION)=FALSE AND TO_CHAR(DESTINATION) NOT LIKE '%.00' AND DESTINATION IS NOT NULL"
EXIT,EXIT_36,N,'DESTINATION_SUBSIDY_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION_SUBSIDY_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SUBSIDY_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DESTINATION_SUBSIDY_TYPE)=FALSE AND TO_CHAR(DESTINATION_SUBSIDY_TYPE) NOT LIKE '%.00'"
EXIT,EXIT_37,N,'OTHER_DESTINATION EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'OTHER_DESTINATION EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'OTHER_DESTINATION EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(OTHER_DESTINATION)>50"
EXIT,EXIT_38,N,'HOUSING_ASSESSMENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HOUSING_ASSESSMENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'HOUSING_ASSESSMENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(HOUSING_ASSESSMENT)=FALSE AND TO_CHAR(HOUSING_ASSESSMENT) NOT LIKE '%.00'"
EXIT,EXIT_39,N,'SUBSIDY_INFORMATION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SUBSIDY_INFORMATION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'SUBSIDY_INFORMATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SUBSIDY_INFORMATION)=FALSE AND TO_CHAR(SUBSIDY_INFORMATION) NOT LIKE '%.00'"
EXIT,EXIT_40,N,'PROJECT_COMPLETION_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'PROJECT_COMPLETION_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'PROJECT_COMPLETION_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PROJECT_COMPLETION_STATUS)=FALSE AND TO_CHAR(PROJECT_COMPLETION_STATUS) NOT LIKE '%.00'"
EXIT,EXIT_41,N,'EARLY_EXIT_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EARLY_EXIT_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EARLY_EXIT_REASON MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EARLY_EXIT_REASON)=FALSE AND TO_CHAR(EARLY_EXIT_REASON) NOT LIKE '%.00'"
EXIT,EXIT_42,N,'EXCHANGE_FOR_SEX IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXCHANGE_FOR_SEX IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXCHANGE_FOR_SEX MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EXCHANGE_FOR_SEX)=FALSE AND TO_CHAR(EXCHANGE_FOR_SEX) NOT LIKE '%.00'"
EXIT,EXIT_43,N,'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EXCHANGE_FOR_SEX_PAST_THREE_MONTHS)=FALSE AND TO_CHAR(EXCHANGE_FOR_SEX_PAST_THREE_MONTHS) NOT LIKE '%.00'"
EXIT,EXIT_44,N,'COUNT_OF_EXCHANGE_FOR_SEX IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COUNT_OF_EXCHANGE_FOR_SEX IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COUNT_OF_EXCHANGE_FOR_SEX MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(COUNT_OF_EXCHANGE_FOR_SEX)=FALSE AND TO_CHAR(COUNT_OF_EXCHANGE_FOR_SEX) NOT LIKE '%.00'"
EXIT,EXIT_45,N,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX)=FALSE AND TO_CHAR(ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX) NOT LIKE '%.00'"
EXIT,EXIT_46,N,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS)=FALSE AND TO_CHAR(ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS) NOT LIKE '%.00'"
EXIT,EXIT_47,N,'WORKPLACE_VIOLENCE_THREATS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'WORKPLACE_VIOLENCE_THREATS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'WORKPLACE_VIOLENCE_THREATS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(WORKPLACE_VIOLENCE_THREATS)=FALSE AND TO_CHAR(WORKPLACE_VIOLENCE_THREATS) NOT LIKE '%.00'"
EXIT,EXIT_48,N,'WORKPLACE_PROMISE_DIFFERENCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'WORKPLACE_PROMISE_DIFFERENCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'WORKPLACE_PROMISE_DIFFERENCE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(WORKPLACE_PROMISE_DIFFERENCE)=FALSE AND TO_CHAR(WORKPLACE_PROMISE_DIFFERENCE) NOT LIKE '%.00'"
EXIT,EXIT_49,N,'COERCED_TO_CONTINUE_WORK IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COERCED_TO_CONTINUE_WORK IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COERCED_TO_CONTINUE_WORK MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(COERCED_TO_CONTINUE_WORK)=FALSE AND TO_CHAR(COERCED_TO_CONTINUE_WORK) NOT LIKE '%.00'"
EXIT,EXIT_50,N,'LABOR_EXPLOIT_PAST_THREE_MONTHS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'LABOR_EXPLOIT_PAST_THREE_MONTHS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'LABOR_EXPLOIT_PAST_THREE_MONTHS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(LABOR_EXPLOIT_PAST_THREE_MONTHS)=FALSE AND TO_CHAR(LABOR_EXPLOIT_PAST_THREE_MONTHS) NOT LIKE '%.00'"
EXIT,EXIT_51,N,'COUNSELING_RECEIVED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'COUNSELING_RECEIVED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COUNSELING_RECEIVED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(COUNSELING_RECEIVED)=FALSE AND TO_CHAR(COUNSELING_RECEIVED) NOT LIKE '%.00'"
EXIT,EXIT_52,N,'INDIVIDUAL_COUNSELING IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'INDIVIDUAL_COUNSELING IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'INDIVIDUAL_COUNSELING MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(INDIVIDUAL_COUNSELING)=FALSE AND TO_CHAR(INDIVIDUAL_COUNSELING) NOT LIKE '%.00'"
EXIT,EXIT_53,N,'FAMILY_COUNSELING IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'FAMILY_COUNSELING IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'FAMILY_COUNSELING MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(FAMILY_COUNSELING)=FALSE AND TO_CHAR(FAMILY_COUNSELING) NOT LIKE '%.00'"
EXIT,EXIT_54,N,'GROUP_COUNSELING IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'GROUP_COUNSELING IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'GROUP_COUNSELING MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(GROUP_COUNSELING)=FALSE AND TO_CHAR(GROUP_COUNSELING) NOT LIKE '%.00'"
EXIT,EXIT_55,N,'SESSION_COUNT_AT_EXIT IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SESSION_COUNT_AT_EXIT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'SESSION_COUNT_AT_EXIT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SESSION_COUNT_AT_EXIT)=FALSE AND TO_CHAR(SESSION_COUNT_AT_EXIT) NOT LIKE '%.00'"
EXIT,EXIT_56,N,'POST_EXIT_COUNSELING_PLAN IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'POST_EXIT_COUNSELING_PLAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POST_EXIT_COUNSELING_PLAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(POST_EXIT_COUNSELING_PLAN)=FALSE AND TO_CHAR(POST_EXIT_COUNSELING_PLAN) NOT LIKE '%.00'"
EXIT,EXIT_57,N,'SESSIONS_IN_PLAN IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'SESSIONS_IN_PLAN IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'SESSIONS_IN_PLAN MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SESSIONS_IN_PLAN)=FALSE AND TO_CHAR(SESSIONS_IN_PLAN) NOT LIKE '%.00'"
EXIT,EXIT_58,N,'DESTINATION_SAFE_CLIENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION_SAFE_CLIENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SAFE_CLIENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DESTINATION_SAFE_CLIENT)=FALSE AND TO_CHAR(DESTINATION_SAFE_CLIENT) NOT LIKE '%.00'"
EXIT,EXIT_59,N,'DESTINATION_SAFE_WORKER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DESTINATION_SAFE_WORKER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SAFE_WORKER MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DESTINATION_SAFE_WORKER)=FALSE AND TO_CHAR(DESTINATION_SAFE_WORKER) NOT LIKE '%.00'"
EXIT,EXIT_60,N,'POS_ADULT_CONNECTIONS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'POS_ADULT_CONNECTIONS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POS_ADULT_CONNECTIONS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(POS_ADULT_CONNECTIONS)=FALSE AND TO_CHAR(POS_ADULT_CONNECTIONS) NOT LIKE '%.00'"
EXIT,EXIT_61,N,'POS_PEER_CONNECTION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'POS_PEER_CONNECTION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POS_PEER_CONNECTION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(POS_PEER_CONNECTION)=FALSE AND TO_CHAR(POS_PEER_CONNECTION) NOT LIKE '%.00'"
EXIT,EXIT_62,N,'POS_COMMUNITY_CONNECTIONS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'POS_COMMUNITY_CONNECTIONS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POS_COMMUNITY_CONNECTIONS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(POS_COMMUNITY_CONNECTIONS)=FALSE AND TO_CHAR(POS_COMMUNITY_CONNECTIONS) NOT LIKE '%.00'"
EXIT,EXIT_63,N,'AFTERCARE_PROVIDED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'AFTERCARE_PROVIDED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'AFTERCARE_PROVIDED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(AFTERCARE_PROVIDED)=FALSE AND TO_CHAR(AFTERCARE_PROVIDED) NOT LIKE '%.00'"
EXIT,EXIT_64,N,'EMAIL_SOCIAL_MEDIA IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EMAIL_SOCIAL_MEDIA IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EMAIL_SOCIAL_MEDIA MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EMAIL_SOCIAL_MEDIA)=FALSE AND TO_CHAR(EMAIL_SOCIAL_MEDIA) NOT LIKE '%.00'"
EXIT,EXIT_65,N,'TELEPHONE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'TELEPHONE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'TELEPHONE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(TELEPHONE)=FALSE AND TO_CHAR(TELEPHONE) NOT LIKE '%.00'"
EXIT,EXIT_66,N,'IN_PERSON_INDIVIDUAL IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'IN_PERSON_INDIVIDUAL IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'IN_PERSON_INDIVIDUAL MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(IN_PERSON_INDIVIDUAL)=FALSE AND TO_CHAR(IN_PERSON_INDIVIDUAL) NOT LIKE '%.00'"
EXIT,EXIT_67,N,'IN_PERSON_GROUP IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'IN_PERSON_GROUP IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'IN_PERSON_GROUP MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(IN_PERSON_GROUP)=FALSE AND TO_CHAR(IN_PERSON_GROUP) NOT LIKE '%.00'"
EXIT,EXIT_68,N,'CM_EXIT_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'CM_EXIT_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'CM_EXIT_REASON MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CM_EXIT_REASON)=FALSE AND TO_CHAR(CM_EXIT_REASON) NOT LIKE '%.00'"
EXIT,EXIT_69,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
EXIT,EXIT_70,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
EXIT,EXIT_71,N,'DESTINATION NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'DESTINATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DESTINATION = c.VALID_VALUES and c.List_Name = '3.12.1' WHERE c.VALID_VALUES IS NULL AND DESTINATION IS NOT NULL"
EXIT,EXIT_72,N,'DESTINATION_SUBSIDY_TYPE NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'DESTINATION_SUBSIDY_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SUBSIDY_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON CAST(CAST(a.DESTINATION_SUBSIDY_TYPE AS INTEGER) AS VARCHAR) = c.VALID_VALUES and c.List_Name = '3.12.A' WHERE c.VALID_VALUES IS NULL AND a.DESTINATION_SUBSIDY_TYPE IS NOT NULL"
EXIT,EXIT_73,N,'HOUSING_ASSESSMENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'HOUSING_ASSESSMENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'HOUSING_ASSESSMENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HOUSING_ASSESSMENT = c.VALID_VALUES and c.List_Name = 'W5.1' WHERE c.VALID_VALUES IS NULL AND a.HOUSING_ASSESSMENT IS NOT NULL"
EXIT,EXIT_74,N,'SUBSIDY_INFORMATION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'SUBSIDY_INFORMATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'SUBSIDY_INFORMATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SUBSIDY_INFORMATION = c.VALID_VALUES and c.List_Name = 'W5.A-B' WHERE c.VALID_VALUES IS NULL AND a.SUBSIDY_INFORMATION IS NOT NULL"
EXIT,EXIT_75,N,'PROJECT_COMPLETION_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'PROJECT_COMPLETION_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'PROJECT_COMPLETION_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PROJECT_COMPLETION_STATUS = c.VALID_VALUES and c.List_Name = 'R17.1' WHERE c.VALID_VALUES IS NULL AND a.PROJECT_COMPLETION_STATUS IS NOT NULL"
EXIT,EXIT_76,N,'EARLY_EXIT_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'EARLY_EXIT_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EARLY_EXIT_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EARLY_EXIT_REASON = c.VALID_VALUES and c.List_Name = 'R17.A' WHERE c.VALID_VALUES IS NULL AND a.EARLY_EXIT_REASON IS NOT NULL"
EXIT,EXIT_77,N,'EXCHANGE_FOR_SEX NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'EXCHANGE_FOR_SEX NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXCHANGE_FOR_SEX CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EXCHANGE_FOR_SEX = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.EXCHANGE_FOR_SEX IS NOT NULL"
EXIT,EXIT_78,N,'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXCHANGE_FOR_SEX_PAST_THREE_MONTHS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EXCHANGE_FOR_SEX_PAST_THREE_MONTHS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT NULL"
EXIT,EXIT_79,N,'COUNT_OF_EXCHANGE_FOR_SEX NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'COUNT_OF_EXCHANGE_FOR_SEX NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COUNT_OF_EXCHANGE_FOR_SEX CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.COUNT_OF_EXCHANGE_FOR_SEX = c.VALID_VALUES and c.List_Name = 'R15.B' WHERE c.VALID_VALUES IS NULL AND a.COUNT_OF_EXCHANGE_FOR_SEX IS NOT NULL"
EXIT,EXIT_80,N,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX IS NOT NULL"
EXIT,EXIT_81,N,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.ASKED_OR_FORCED_TO_EXCHANGE_FOR_SEX_PAST_THREE_MONTHS IS NOT NULL"
EXIT,EXIT_82,N,'WORKPLACE_VIOLENCE_THREATS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'WORKPLACE_VIOLENCE_THREATS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'WORKPLACE_VIOLENCE_THREATS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WORKPLACE_VIOLENCE_THREATS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.WORKPLACE_VIOLENCE_THREATS IS NOT NULL"
EXIT,EXIT_83,N,'WORKPLACE_PROMISE_DIFFERENCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'WORKPLACE_PROMISE_DIFFERENCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'WORKPLACE_PROMISE_DIFFERENCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WORKPLACE_PROMISE_DIFFERENCE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.WORKPLACE_PROMISE_DIFFERENCE IS NOT NULL"
EXIT,EXIT_84,N,'COERCED_TO_CONTINUE_WORK NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'COERCED_TO_CONTINUE_WORK NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COERCED_TO_CONTINUE_WORK CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.COERCED_TO_CONTINUE_WORK = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.COERCED_TO_CONTINUE_WORK IS NOT NULL"
EXIT,EXIT_85,N,'LABOR_EXPLOIT_PAST_THREE_MONTHS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'LABOR_EXPLOIT_PAST_THREE_MONTHS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'LABOR_EXPLOIT_PAST_THREE_MONTHS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.LABOR_EXPLOIT_PAST_THREE_MONTHS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.LABOR_EXPLOIT_PAST_THREE_MONTHS IS NOT NULL"
EXIT,EXIT_86,N,'COUNSELING_RECEIVED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'COUNSELING_RECEIVED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'COUNSELING_RECEIVED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.COUNSELING_RECEIVED = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.COUNSELING_RECEIVED IS NOT NULL"
EXIT,EXIT_87,N,'INDIVIDUAL_COUNSELING NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'INDIVIDUAL_COUNSELING NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'INDIVIDUAL_COUNSELING CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INDIVIDUAL_COUNSELING = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.INDIVIDUAL_COUNSELING IS NOT NULL"
EXIT,EXIT_88,N,'FAMILY_COUNSELING NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'FAMILY_COUNSELING NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'FAMILY_COUNSELING CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.FAMILY_COUNSELING = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.FAMILY_COUNSELING IS NOT NULL"
EXIT,EXIT_89,N,'GROUP_COUNSELING NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'GROUP_COUNSELING NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'GROUP_COUNSELING CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.GROUP_COUNSELING = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.GROUP_COUNSELING IS NOT NULL"
EXIT,EXIT_90,N,'POST_EXIT_COUNSELING_PLAN NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'POST_EXIT_COUNSELING_PLAN NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POST_EXIT_COUNSELING_PLAN CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.POST_EXIT_COUNSELING_PLAN = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.POST_EXIT_COUNSELING_PLAN IS NOT NULL"
EXIT,EXIT_91,N,'DESTINATION_SAFE_CLIENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'DESTINATION_SAFE_CLIENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SAFE_CLIENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DESTINATION_SAFE_CLIENT = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.DESTINATION_SAFE_CLIENT IS NOT NULL"
EXIT,EXIT_92,N,'DESTINATION_SAFE_WORKER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'DESTINATION_SAFE_WORKER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DESTINATION_SAFE_WORKER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DESTINATION_SAFE_WORKER = c.VALID_VALUES and c.List_Name = 'R19.A' WHERE c.VALID_VALUES IS NULL AND a.DESTINATION_SAFE_WORKER IS NOT NULL"
EXIT,EXIT_93,N,'POS_ADULT_CONNECTIONS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'POS_ADULT_CONNECTIONS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POS_ADULT_CONNECTIONS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.POS_ADULT_CONNECTIONS = c.VALID_VALUES and c.List_Name = 'R19.A' WHERE c.VALID_VALUES IS NULL AND a.POS_ADULT_CONNECTIONS IS NOT NULL"
EXIT,EXIT_94,N,'POS_PEER_CONNECTION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'POS_PEER_CONNECTION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POS_PEER_CONNECTION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.POS_PEER_CONNECTION = c.VALID_VALUES and c.List_Name = 'R19.A' WHERE c.VALID_VALUES IS NULL AND a.POS_PEER_CONNECTION IS NOT NULL"
EXIT,EXIT_95,N,'POS_COMMUNITY_CONNECTIONS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'POS_COMMUNITY_CONNECTIONS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'POS_COMMUNITY_CONNECTIONS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.POS_COMMUNITY_CONNECTIONS = c.VALID_VALUES and c.List_Name = 'R19.A' WHERE c.VALID_VALUES IS NULL AND A.POS_COMMUNITY_CONNECTIONS IS NOT NULL"
EXIT,EXIT_96,N,'AFTERCARE_PROVIDED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'AFTERCARE_PROVIDED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'AFTERCARE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.AFTERCARE_PROVIDED = c.VALID_VALUES and c.List_Name = 'R20.2' WHERE c.VALID_VALUES IS NULL AND a.AFTERCARE_PROVIDED IS NOT NULL"
EXIT,EXIT_97,N,'EMAIL_SOCIAL_MEDIA NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'EMAIL_SOCIAL_MEDIA NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EMAIL_SOCIAL_MEDIA CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EMAIL_SOCIAL_MEDIA = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.EMAIL_SOCIAL_MEDIA IS NOT NULL"
EXIT,EXIT_98,N,'TELEPHONE NOT IN HUD LIST ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'TELEPHONE NOT IN HUD LIST ' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'TELEPHONE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TELEPHONE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.TELEPHONE IS NOT NULL"
EXIT,EXIT_99,N,'IN_PERSON_INDIVIDUAL NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'IN_PERSON_INDIVIDUAL NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'IN_PERSON_INDIVIDUAL CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.IN_PERSON_INDIVIDUAL = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.IN_PERSON_INDIVIDUAL IS NOT NULL"
EXIT,EXIT_100,N,'IN_PERSON_GROUP NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'IN_PERSON_GROUP NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'IN_PERSON_GROUP CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.IN_PERSON_GROUP = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.IN_PERSON_GROUP IS NOT NULL"
EXIT,EXIT_101,N,'CM_EXIT_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, EXIT_ID||'|'||ENROLLMENT_ID BUSINESS_KEY_VALUE,'CM_EXIT_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'CM_EXIT_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXIT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CM_EXIT_REASON = c.VALID_VALUES and c.List_Name = 'V9.1' WHERE c.VALID_VALUES IS NULL AND a.CM_EXIT_REASON IS NOT NULL"
EXIT,EXIT_102,N,'EXIT_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXIT_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXIT_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(EXIT_DATE,1,10) NOT LIKE '%____-__-__%' AND EXIT_DATE IS NOT NULL"
EXIT,EXIT_103,N,'AFTERCARE_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'AFTERCARE_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_OF_PATH_STATUS NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(AFTERCARE_DATE,1,10) NOT LIKE '%____-__-__%'"
EXIT,EXIT_104,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
EXIT,EXIT_105,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
EXIT,EXIT_106,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
EXIT,EXIT_107,N,'AFTERCARE_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'AFTERCARE_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'AFTER_CARE_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE AFTERCARE_DATE NOT LIKE '%____-__-__%'"
EXIT,EXIT_108,N,'EXIT_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'EXIT_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'EXIT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT EXIT_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY EXIT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.EXIT_ID = C.EXIT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.EXIT_ID IS NOT NULL"
EXPORT,EXPORT_1,N,'SOURCE_TYPE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_TYPE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOURCE_TYPE IS NULL"
EXPORT,EXPORT_2,N,'SOURCE_ID IS NULL UNLESS SOURCE_TYPE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_ID IS NULL UNLESS SOURCE_TYPE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_ID IS NULL UNLESS SOURCE_TYPE = 1' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOURCE_ID IS NULL AND SOURCE_TYPE = 1"
EXPORT,EXPORT_3,N,'SOURCE_NAME IS NULL UNLESS SOURCE_TYPE <> 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_NAME IS NULL UNLESS SOURCE_TYPE <> 1' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_NAME IS NULL UNLESS SOURCE_TYPE <> 1' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOURCE_NAME IS NULL AND SOURCE_TYPE <> 1"
EXPORT,EXPORT_4,N,'SOURCE_CONTACT_PHONE IS INVALID',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_PHONE IS INVALID' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_PHONE MUST CONTAIN 10 DIGITS WITH NO PUNCTUATION' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE NOT regexp_like(SOURCE_CONTACT_PHONE,'^[[:digit:]]{10}$')"
EXPORT,EXPORT_5,N,'SOURCE_CONTACT_EMAIL IS INVALID',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_EMAIL IS INVALID' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_EMAIL IS INVALID' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOURCE_CONTACT_EMAIL NOT LIKE '%_@__%.__%'"
EXPORT,EXPORT_6,N,'EXPORT_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_DATE IS NULL"
EXPORT,EXPORT_7,N,'EXPORT_START_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_START_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_START_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_START_DATE IS NULL"
EXPORT,EXPORT_8,N,'EXPORT_END_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_END_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_END_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_END_DATE IS NULL"
EXPORT,EXPORT_9,N,'SOFTWARE_NAME IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOFTWARE_NAME IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOFTWARE_NAME IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOFTWARE_NAME IS NULL"
EXPORT,EXPORT_10,N,'CSV_VERSION INCORRECTLY FORMATTED ',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'CSV_VERSION INCORRECTLY FORMATTED ' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'CSV_VERSION IS INCORRECTLY FORMATTED' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CSV_VERSION NOT LIKE 'FY20%%_v%._%'"
EXPORT,EXPORT_11,N,'EXPORT_PERIOD_TYPE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_PERIOD_TYPE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_PERIOD_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_PERIOD_TYPE IS NULL"
EXPORT,EXPORT_12,N,'EXPORT_DIRECTIVE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_DIRECTIVE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_DIRECTIVE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_DIRECTIVE IS NULL"
EXPORT,EXPORT_13,N,'HASH_STATUS IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'HASH_STATUS IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HASH_STATUS IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HASH_STATUS IS NULL"
EXPORT,EXPORT_14,N,'IMPLEMENTATION_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'IMPLEMENTATION_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'IMPLEMENTATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IMPLEMENTATION_ID IS NULL"
EXPORT,EXPORT_15,N,'SOURCE_CONTACT_EXTENSION CONTAINS NON-NUMERIC VALUES',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_EXTENSION CONTAINS NON-NUMERIC VALUES' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,  'SOURCE_CONTACT_EXTENSION SHOULD NOT CONTAIN PUNCTUATION OR LETTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TRY_TO_NUMBER(SOURCE_CONTACT_EXTENSION) IS NULL AND SOURCE_CONTACT_EXTENSION IS NOT NULL"
EXPORT,EXPORT_16,N,'EXPORT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_ID IS NULL"
EXPORT,EXPORT_17,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID) > 32"
EXPORT,EXPORT_18,N,'SOURCE_TYPE IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(SOURCE_TYPE) not like '%.00' and is_integer(SOURCE_TYPE) = false"
EXPORT,EXPORT_19,N,'SOURCE_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_ID) > 32"
EXPORT,EXPORT_20,N,'SOURCE_NAME EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_NAME EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_NAME EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_NAME) > 50"
EXPORT,EXPORT_21,N,'SOURCE_CONTACT_FIRST EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_FIRST EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_FIRST EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_CONTACT_FIRST) > 50"
EXPORT,EXPORT_22,N,'SOURCE_CONTACT_LAST EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_LAST EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_LAST EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_CONTACT_LAST) > 50"
EXPORT,EXPORT_23,N,'SOURCE_CONTACT_PHONE EXCEEDS 10 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_PHONE EXCEEDS 10 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_PHONE EXCEEDS 10 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_CONTACT_PHONE) > 50"
EXPORT,EXPORT_24,N,'SOURCE_CONTACT_EXTENSION EXCEEDS 5 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_EXTENSION EXCEEDS 5 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_EXTENSION EXCEEDS 5 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_CONTACT_EXTENSION)>5"
EXPORT,EXPORT_25,N,'SOURCE_CONTACT_EMAIL EXCEEDS 320 CHARACTERS ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_CONTACT_EMAIL EXCEEDS 320 CHARACTERS ' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_CONTACT_EMAIL EXCEEDS 320 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOURCE_CONTACT_EMAIL)>320"
EXPORT,EXPORT_26,N,'SOFTWARE_NAME EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOFTWARE_NAME EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOFTWARE_NAME EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOFTWARE_NAME)>50"
EXPORT,EXPORT_27,N,'SOFTWARE_VERSION EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOFTWARE_VERSION EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOFTWARE_VERSION EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SOFTWARE_VERSION)>50"
EXPORT,EXPORT_28,N,'CSV_VERSION EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'CSV_VERSION EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'CSV_VERSION EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(CSV_VERSION)>50"
EXPORT,EXPORT_29,N,'EXPORT_PERIOD_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_PERIOD_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_PERIOD_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(EXPORT_PERIOD_TYPE) not like '%.00' and IS_INTEGER(EXPORT_PERIOD_TYPE) = FALSE"
EXPORT,EXPORT_30,N,'EXPORT_DIRECTIVE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_DIRECTIVE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_DIRECTIVE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(EXPORT_DIRECTIVE) = FALSE and to_char(EXPORT_DIRECTIVE) not like '%.00'"
EXPORT,EXPORT_31,N,'HASH_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'HASH_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HASH_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(HASH_STATUS) not like '%.00' and IS_INTEGER(HASH_STATUS) = FALSE"
EXPORT,EXPORT_32,N,'IMPLEMENTATION_ID EXCEEDS 200 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'IMPLEMENTATION_ID EXCEEDS 200 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'IMPLEMENTATION_ID EXCEEDS 200 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(IMPLEMENTATION_ID)>200"
EXPORT,EXPORT_33,N,'EXPORT_PERIOD_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME ,(case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_PERIOD_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_PERIOD_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EXPORT_PERIOD_TYPE = c.VALID_VALUES and c.List_Name = '1.1' WHERE c.VALID_VALUES IS NULL AND a.EXPORT_PERIOD_TYPE IS NOT NULL"
EXPORT,EXPORT_34,N,'EXPORT_DIRECTIVE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME ,(case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_DIRECTIVE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_DIRECTIVE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EXPORT_DIRECTIVE = c.VALID_VALUES and c.List_Name = '1.2' WHERE c.VALID_VALUES IS NULL AND a.EXPORT_DIRECTIVE IS NOT NULL"
EXPORT,EXPORT_35,N,'HASH_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME ,(case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'HASH_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HASH_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HASH_STATUS = c.VALID_VALUES and c.List_Name = '1.5' WHERE c.VALID_VALUES IS NULL AND a.HASH_STATUS IS NOT NULL"
EXPORT,EXPORT_36,N,'SOURCE_ID INCORRECTLY FORMATTED',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'SOURCE_ID INCORRECTLY FORMATTED' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE_ID MUST BE IN THE FORMAT OF TWO LETTERS, A DASH, AND THREE NUMBERS' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE NOT REGEXP_LIKE(SOURCE_ID,'^[A-Za-z]{2}-[[:digit:]]{3}$')"
EXPORT,EXPORT_37,N,'EXPORT_START_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_START_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_START_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_START_DATE NOT LIKE '%____-__-__%'"
EXPORT,EXPORT_38,N,'EXPORT_DATE NOT IN FORMAT YYYY-MM-DD HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_DATE NOT IN FORMAT YYYY-MM-DD HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_START_DATE NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(EXPORT_DATE,1,10) NOT LIKE '%____-__-__%' AND LEN(EXPORT_DATE)<>19"
EXPORT,EXPORT_39,N,'EXPORT_END_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_END_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_END_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EXPORT_END_DATE NOT LIKE '%____-__-__%'"
EXPORT,EXPORT_40,N,'EXPORT_DATE BEFORE EXPORT_END_DATE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_DATE BEFORE EXPORT_END_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_DATE MUST BE AFTER THE EXPORT_END_DATE' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE(EXPORT_DATE) < DATE(EXPORT_END_DATE)"
EXPORT,EXPORT_41,N,'EXPORT_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXPORT' TABLE_NAME, (case when A.EXPORT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXPORT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXPORT_ID is null then A.STG_MD5_HASH_VALUE else A.EXPORT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_EXPORT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT EXPORT_ID, SOURCE_FILE FROM STAGING.PSTG_EXPORT GROUP BY EXPORT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.EXPORT_ID = C.EXPORT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.EXPORT_ID IS NOT NULL"
FUNDER,FUNDER_1,N,'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECT.CSV',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECT.CSV' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'PROJECT_ID NOT IN PROJECT.CSV' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NULL"
FUNDER,FUNDER_2,N,'FUNDER IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER IS NULL' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'FUNDER IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE FUNDER IS NULL"
FUNDER,FUNDER_3,N,'OTHER_FUNDER IS NULL WHEN FUNDER = 46',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'OTHER_FUNDER IS NULL WHEN FUNDER = 46' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'OTHER_FUNDER IS A REQUIRED FIELD WHEN FUNDER = 46' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE OTHER_FUNDER IS NULL AND FUNDER = 46"
FUNDER,FUNDER_4,N,'GRANT_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'GRANT_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'GRANT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE GRANT_ID IS NULL"
FUNDER,FUNDER_5,N,'START_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'START_DATE IS NULL' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'START_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE START_DATE IS NULL"
FUNDER,FUNDER_6,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
FUNDER,FUNDER_7,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
FUNDER,FUNDER_8,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
FUNDER,FUNDER_9,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when FUNDER_ID||'|'||PROJECT_ID is null then SRC.STG_MD5_HASH_VALUE else FUNDER_ID||'|'||PROJECT_ID end) AS BUSINESS_KEY_VALUE, SRC.END_DATE, SRC.DATE_UPDATED, SRC.START_DATE FROM STAGING.PSTG_FUNDER SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME ,  (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
FUNDER,FUNDER_10,N,"'PROJECT_NAME LIKE ""%CWT%''",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME LIKE ""%CWT%' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'CWT/TR Projects should no longer be classified as homeless projects.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_NAME like '%CWT%'"
FUNDER,FUNDER_11,N,"'PROJECT_NAME LIKE ""%VADOM%''",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME LIKE ""%VADOM%' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE,'VADOM Projects should no longer be classified as homeless projects.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_NAME like '%VADOM%'"
FUNDER,FUNDER_12,N,"'PROJECT_NAME LIKE ""%HCHV%"" BUT FUNDER NOT IN (27,30)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME LIKE ""%HCHV%"" BUT FUNDER NOT IN (27,30)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'This appears to be a possible HCHV project, but no HCHV funding was reported.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_NAME like '%HCHV%' AND a.FUNDER not in (27,30)"
FUNDER,FUNDER_13,N,"'PROJECT_NAME LIKE ""%GPD"" BUT FUNDER NOT IN (37,38,39,40,41,42,45)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME LIKE ""%GPD"" BUT FUNDER NOT IN (37,38,39,40,41,42,45)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'This appears to be a possible GPD project, but no GPD funding was reported.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_NAME like '%GPD' AND a.FUNDER not in (37,38,39,40,41,42,45)"
FUNDER,FUNDER_14,N,"'PROJECT_NAME LIKE ""%VASH"" BUT FUNDER <> 20'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME LIKE ""%VASH"" BUT FUNDER <> 20' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'This appears to be a possible VASH project, but no VASH funding was reported.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_NAME like '%VASH' AND a.FUNDER <> 20"
FUNDER,FUNDER_15,N,"'PROJECT_NAME LIKE ""%SSVF"" BUT FUNDER <> 33'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME,(case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME LIKE ""%SSVF"" BUT FUNDER <> 33' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'This appears to be a possible SSVF project, but no SSVF funding was reported.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_NAME like '%SSVF' AND a.FUNDER <> 30"
FUNDER,FUNDER_16,N,"'FUNDER = 47 AND PROJECT_TYPE NOT IN (0,1,13)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 47 AND PROJECT_TYPE NOT IN (0,1,13)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received ESG-CV funding. If so, the project should be classified as ES or RRH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0,1,13) AND a.FUNDER = 47"
FUNDER,FUNDER_17,N,'PROJECT RECEIVES FUNDING FROM VA SOURCES BUT NO DEDICATED BEDS IN PROJECT ACTIVE INVENTORY',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT RECEIVES FUNDING FROM VA SOURCES BUT NO DEDICATED BEDS IN PROJECT ACTIVE INVENTORY' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project receives funding from VA sources, yet you did not report any dedicated veteran beds among the active inventory.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_INVENTORY c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE (c.CH_VET_BED_INVENTORY + c.YOUTH_VET_BED_INVENTORY + c.VET_BED_INVENTORY) <= 0 AND a.FUNDER in (27,30,33,37,38,39,40,41,42,45)"
FUNDER,FUNDER_18,N,"'FUNDER = 8 AND PROJECT_TYPE NOT IN (0,1)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 8 AND PROJECT_TYPE NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received ESG-CV funding. If so, the project should be classified as ES.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0,1) AND a.FUNDER = 8"
FUNDER,FUNDER_19,N,'FUNDER = 10 AND PROJECT_TYPE <> 13',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 10 AND PROJECT_TYPE <> 13' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received ESG-RRH funding. If so, the project should be classified as RRH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 13 AND a.FUNDER = 10"
FUNDER,FUNDER_20,N,'FUNDER = 6 AND PROJECT_TYPE <> 8',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 6 AND PROJECT_TYPE <> 8' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received CoC-SH funding. If so, the project should be classified as SH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 8 AND a.FUNDER = 6"
FUNDER,FUNDER_21,N,'FUNDER = 5 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 5 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received CoC-TH funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 5"
FUNDER,FUNDER_22,N,'FUNDER = 2 AND PROJECT_TYPE <> 3',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 2 AND PROJECT_TYPE <> 3' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received CoC-PSH funding. If so, the project should be classified as PSH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 3 AND a.FUNDER = 2"
FUNDER,FUNDER_23,N,'FUNDER = 3 AND PROJECT_TYPE <> 13',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 3 AND PROJECT_TYPE <> 13' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received CoC-RRH funding. If so, the project should be classified as RRH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 13 AND a.FUNDER = 3"
FUNDER,FUNDER_24,N,"'FUNDER = 44 AND PROJECT_TYPE NOT IN (2,13)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 44 AND PROJECT_TYPE NOT IN (2,13)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received CoC Joint TH-RRH funding. If so, the project should be classified as either TH or RRH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (2,13) AND a.FUNDER = 44"
FUNDER,FUNDER_25,N,'FUNDER = 20 AND PROJECT_TYPE <> 3',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 20 AND PROJECT_TYPE <> 3' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received VASH funding. If so, the project should be classified as PSH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 3 AND a.FUNDER = 20"
FUNDER,FUNDER_26,N,"FUNDER = 33 AND PROJECT_TYPE NOT IN (0, 1, 12, 13)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 33 AND PROJECT_TYPE NOT IN (0, 1,12,13)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received SSVF funding. If so, the project should be classified as ES, Prevention, or RRH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0,1,12,13) AND a.FUNDER = 33"
FUNDER,FUNDER_27,N,'FUNDER = 37 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 37 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received GPD-Bridge Housing funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 37"
FUNDER,FUNDER_28,N,'FUNDER = 38 AND PROJECT_TYPE <> 8',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 38 AND PROJECT_TYPE <> 8' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received GPD-Low Demand funding. If so, the project should be classified as SH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 8 AND a.FUNDER = 38"
FUNDER,FUNDER_29,N,'FUNDER = 39 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 39 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received GPD-Hospital to Housing funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 39"
FUNDER,FUNDER_30,N,'FUNDER = 40 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 40 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received GPD-Clinical Treatment funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 40"
FUNDER,FUNDER_31,N,'FUNDER = 41 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 41 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received GPD-Service Intensive Transitional Housing funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 41"
FUNDER,FUNDER_32,N,FUNDER = 42 AND PROJECT_TYPE NOT IN (9)',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 42 AND PROJECT_TYPE NOT IN (9)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received GPD-Transition in Place funding. If so, the project should be classified as OPH (PH, no services).' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (9) AND a.FUNDER = 42"
FUNDER,FUNDER_33,N,FUNDER = 27 AND PROJECT_TYPE NOT IN (0)',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 27 AND PROJECT_TYPE NOT IN (0)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received HCHV-CRS funding. If so, the project should be classified as ES-EE.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0) AND a.FUNDER = 27"
FUNDER,FUNDER_34,N,'FUNDER = 30 AND PROJECT_TYPE <> 8',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 30 AND PROJECT_TYPE <> 8' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received HCHV-SH funding. If so, the project should be classified as SH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 8 AND a.FUNDER = 30"
FUNDER,FUNDER_35,N,"FUNDER = 22 AND PROJECT_TYPE NOT IN (0,1,12)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 22 AND PROJECT_TYPE NOT IN (0,1,12)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received RHY-Basic Center Program funding. If so, the project should be classified as ES or Prevention.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0,1,12) AND a.FUNDER = 22"
FUNDER,FUNDER_36,N,'FUNDER = 24 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 24 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received RHY-Transitional Living Program funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 24"
FUNDER,FUNDER_37,N,'FUNDER = 23 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 23 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received RHY-Maternity Group Home funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 23"
FUNDER,FUNDER_38,N,"'FUNDER = 13 AND PROJECT_TYPE NOT IN (0,1)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 13 AND PROJECT_TYPE NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received HOPWA-Hotel/Motel Vouchers funding. If so, the project should be classified as ES.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0,1) AND a.FUNDER = 13"
FUNDER,FUNDER_39,N,'FUNDER = 15 AND PROJECT_TYPE <> 3',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 15 AND PROJECT_TYPE <> 3' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received HOPWA-Permanent Housing (facility-based or TBRA) funding. If so, the project should be classified as PSH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 3 AND a.FUNDER = 15"
FUNDER,FUNDER_40,N,"'FUNDER = 18 AND PROJECT_TYPE NOT IN (0,1)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 18 AND PROJECT_TYPE NOT IN (0,1)' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received HOPWA-Short-Term Supportive Facility funding. If so, the project should be classified as ES.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE not in (0,1) AND a.FUNDER = 18"
FUNDER,FUNDER_41,N,'FUNDER = 19 AND PROJECT_TYPE <> 2',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER = 19 AND PROJECT_TYPE <> 2' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'The upload shows that this project received HOPWA-Transitional Housing (facility-based or TBRA) funding. If so, the project should be classified as TH.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE c.PROJECT_TYPE <> 2 AND a.FUNDER = 19"
FUNDER,FUNDER_42,N,'FUNDER_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'FUNDER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE FUNDER_ID IS NULL"
FUNDER,FUNDER_43,N,'PROJECT_ID IS NULL',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME , (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_ID IS NULL"
FUNDER,FUNDER_44,N,'FUNDER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'FUNDER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(FUNDER_ID)>32"
FUNDER,FUNDER_45,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'PROJECT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_ID)>32"
FUNDER,FUNDER_46,N,'FUNDER IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'FUNDER MUST BE AN INTEGER.' ERROR_MESSAGE, FUNDER FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(FUNDER) not like '%.00' and IS_INTEGER(FUNDER)=FALSE"
FUNDER,FUNDER_47,N,'OTHER_FUNDER EXCEEDS 100 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'OTHER_FUNDER EXCEEDS 100 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'OTHER_FUNDER EXCEEDS 100 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(OTHER_FUNDER)>100"
FUNDER,FUNDER_48,N,'GRANT_ID EXCEEDS 100 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'GRANT_ID EXCEEDS 100 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'GRANT_ID EXCEEDS 100 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(GRANT_ID)>100"
FUNDER,FUNDER_49,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
FUNDER,FUNDER_50,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
FUNDER,FUNDER_51,N,'FUNDER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'FUNDER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.FUNDER = c.VALID_VALUES and c.List_Name = '2.06.1' WHERE c.VALID_VALUES IS NULL AND a.FUNDER IS NOT NULL"
FUNDER,FUNDER_52,N,'START_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'START_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'START_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(START_DATE,1,10) NOT LIKE '%____-__-__%'"
FUNDER,FUNDER_53,N,'END_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'END_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR,	'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'END_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(END_DATE,1,10) NOT LIKE '%____-__-__%'"
FUNDER,FUNDER_54,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
FUNDER,FUNDER_55,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
FUNDER,FUNDER_56,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
FUNDER,FUNDER_57,N,'FUNDER_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_FUNDER' TABLE_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'FUNDER_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, (case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE'  end) ERROR_DATE_FIELD_NAME, (case when end_date is null and start_date is null then DATE(DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE)   end) ERROR_DATE_VALUE, 'FUNDER_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT FUNDER_ID, SOURCE_FILE FROM STAGING.PSTG_FUNDER GROUP BY FUNDER_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.FUNDER_ID = C.FUNDER_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.FUNDER_ID IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_1,N,'HEALTH_AND_DV_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'HEALTH_AND_DV_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'HEALTH_AND_DV_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HEALTH_AND_DV_ID IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_2,N,'HEALTH_AND_DV_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'HEALTH_AND_DV_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'HEALTH_AND_DV_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(HEALTH_AND_DV_ID)>32"
HEALTH_AND_DV,HEALTH_AND_DV_3,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
HEALTH_AND_DV,HEALTH_AND_DV_4,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
HEALTH_AND_DV,HEALTH_AND_DV_5,N,'DOMESTIC_VIOLENCE_SURVIVOR IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DOMESTIC_VIOLENCE_SURVIVOR IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DOMESTIC_VIOLENCE_SURVIVOR MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(DOMESTIC_VIOLENCE_SURVIVOR) not like '%.00' and IS_INTEGER(DOMESTIC_VIOLENCE_SURVIVOR)=FALSE AND DOMESTIC_VIOLENCE_SURVIVOR IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_6,N,'WHEN_OCCURRED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WHEN_OCCURRED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WHEN_OCCURRED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(WHEN_OCCURRED) not like '%.00' and IS_INTEGER(WHEN_OCCURRED)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_7,N,'CURRENTLY_FLEEING IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENTLY_FLEEING IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENTLY_FLEEING MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CURRENTLY_FLEEING) not like '%.00' and IS_INTEGER(CURRENTLY_FLEEING)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_8,N,'GENERAL_HEALTH_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'GENERAL_HEALTH_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'GENERAL_HEALTH_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(GENERAL_HEALTH_STATUS) not like '%.00' and IS_INTEGER(GENERAL_HEALTH_STATUS)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_9,N,'DENTAL_HEALTH_STATUS IS NOT AN INTEGER ',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DENTAL_HEALTH_STATUS IS NOT AN INTEGER ' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DENTAL_HEALTH_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(DENTAL_HEALTH_STATUS) not like '%.00' and IS_INTEGER(DENTAL_HEALTH_STATUS)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_10,N,'MENTAL_HEALTH_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DENTAL_HEALTH_STATUS IS NOT AN INTEGER ' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DENTAL_HEALTH_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(DENTAL_HEALTH_STATUS) not like '%.00' and IS_INTEGER(DENTAL_HEALTH_STATUS)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_11,N,'PREGNANCY_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PREGNANCY_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PREGNANCY_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(PREGNANCY_STATUS) not like '%.00' and IS_INTEGER(PREGNANCY_STATUS)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_12,N,'DATA_COLLECTION_STAGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(DATA_COLLECTION_STAGE) not like '%.00' and IS_INTEGER(DATA_COLLECTION_STAGE)=FALSE"
HEALTH_AND_DV,HEALTH_AND_DV_13,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
HEALTH_AND_DV,HEALTH_AND_DV_14,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
HEALTH_AND_DV,HEALTH_AND_DV_15,N,'DOMESTIC_VIOLENCE_SURVIVOR NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'DOMESTIC_VIOLENCE_SURVIVOR NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DOMESTIC_VIOLENCE_SURVIVOR CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DOMESTIC_VIOLENCE_SURVIVOR = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.DOMESTIC_VIOLENCE_SURVIVOR IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_16,N,'WHEN_OCCURRED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'WHEN_OCCURRED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WHEN_OCCURRED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WHEN_OCCURRED = c.VALID_VALUES and c.List_Name = '4.11.A' WHERE c.VALID_VALUES IS NULL AND a.WHEN_OCCURRED IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_17,N,'CURRENTLY_FLEEING NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'CURRENTLY_FLEEING NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENTLY_FLEEING CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CURRENTLY_FLEEING = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.CURRENTLY_FLEEING IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_18,N,'GENERAL_HEALTH_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'GENERAL_HEALTH_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'GENERAL_HEALTH_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.GENERAL_HEALTH_STATUS = c.VALID_VALUES and c.List_Name = 'R7.1' WHERE c.VALID_VALUES IS NULL AND a.GENERAL_HEALTH_STATUS IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_19,N,'DENTAL_HEALTH_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'DENTAL_HEALTH_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DENTAL_HEALTH_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DENTAL_HEALTH_STATUS = c.VALID_VALUES and c.List_Name = 'R7.1' WHERE c.VALID_VALUES IS NULL AND a.DENTAL_HEALTH_STATUS IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_20,N,'MENTAL_HEALTH_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'MENTAL_HEALTH_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MENTAL_HEALTH_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MENTAL_HEALTH_STATUS = c.VALID_VALUES and c.List_Name = 'R7.1' WHERE c.VALID_VALUES IS NULL AND a.MENTAL_HEALTH_STATUS IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_21,N,'PREGNANCY_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'PREGNANCY_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PREGNANCY_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PREGNANCY_STATUS = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.PREGNANCY_STATUS IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_22,N,'DATA_COLLECTION_STAGE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DATA_COLLECTION_STAGE = c.VALID_VALUES and c.List_Name = '5.03.1' WHERE c.VALID_VALUES IS NULL AND a.DATA_COLLECTION_STAGE IS NOT NULL"
HEALTH_AND_DV,HEALTH_AND_DV_23,N,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INFORMATION_DATE,1,10) NOT LIKE '%____-__-__%'"
HEALTH_AND_DV,HEALTH_AND_DV_24,N,'DUE_DATE NOT IN FORMAT YYYY-MM-DD  ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DUE_DATE NOT IN FORMAT YYYY-MM-DD  ' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DUE_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DUE_DATE,1,10) NOT LIKE '%____-__-__%'"
HEALTH_AND_DV,HEALTH_AND_DV_25,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
HEALTH_AND_DV,HEALTH_AND_DV_26,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
HEALTH_AND_DV,HEALTH_AND_DV_27,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
HEALTH_AND_DV,HEALTH_AND_DV_28,N,'HEALTH_AND_DV_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'HEALTH_AND_DV_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'HEALTH_AND_DV_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT HEALTH_AND_DV_ID, SOURCE_FILE FROM STAGING.PSTG_HEALTH_AND_DV GROUP BY HEALTH_AND_DV_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.HEALTH_AND_DV_ID = C.HEALTH_AND_DV_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.HEALTH_AND_DV_ID IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_1,N,'INCOME_BENEFITS_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INCOME_BENEFITS_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INCOME_BENEFITS_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INCOME_BENEFITS_ID IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_2,N,'INCOME_BENEFITS_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INCOME_BENEFITS_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INCOME_BENEFITS_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(INCOME_BENEFITS_ID)>32"
INCOME_BENEFITS,INCOME_BENEFITS_3,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
INCOME_BENEFITS,INCOME_BENEFITS_4,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
INCOME_BENEFITS,INCOME_BENEFITS_5,N,'INCOME_FROM_ANY_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INCOME_FROM_ANY_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INCOME_FROM_ANY_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(INCOME_FROM_ANY_SOURCE) not like '%.00' and IS_INTEGER(INCOME_FROM_ANY_SOURCE)=FALSE AND INCOME_FROM_ANY_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_6,N,'EARNED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EARNED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EARNED MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(EARNED) not like '%.00' and IS_INTEGER(EARNED)=FALSE AND EARNED IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_7,N,'UNEMPLOYMENT IS NOT AN INTEGER ',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'UNEMPLOYMENT IS NOT AN INTEGER ' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'UNEMPLOYMENT MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(UNEMPLOYMENT) not like '%.00' and IS_INTEGER(UNEMPLOYMENT)=FALSE AND UNEMPLOYMENT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_8,N,'SSI IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SSI IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SSI MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(SSI) not like '%.00' and IS_INTEGER(SSI)=FALSE AND SSI IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_9,N,'SSDI IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SSDI IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SSDI MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(SSDI) not like '%.00' and IS_INTEGER(SSDI)=FALSE AND SSDI IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_10,N,'VA_DISABILITY_SERVICE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VA_DISABILITY_SERVICE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VA_DISABILITY_SERVICE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(VA_DISABILITY_SERVICE) not like '%.00' and IS_INTEGER(VA_DISABILITY_SERVICE)=FALSE AND VA_DISABILITY_SERVICE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_11,N,'VA_DISABILITY_NON_SERVICE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VA_DISABILITY_NON_SERVICE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VA_DISABILITY_NON_SERVICE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(VA_DISABILITY_NON_SERVICE) not like '%.00' and IS_INTEGER(VA_DISABILITY_NON_SERVICE)=FALSE AND VA_DISABILITY_NON_SERVICE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_12,N,'PRIVATE_DISABILITY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PRIVATE_DISABILITY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PRIVATE_DISABILITY MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(PRIVATE_DISABILITY) not like '%.00' and IS_INTEGER(PRIVATE_DISABILITY)=FALSE AND PRIVATE_DISABILITY IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_13,N,'WORKERS_COMP IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WORKERS_COMP IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WORKERS_COMP MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(WORKERS_COMP) not like '%.00' and IS_INTEGER(WORKERS_COMP)=FALSE AND WORKERS_COMP IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_14,N,'TANF IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'TANF IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(TANF) not like '%.00' and IS_INTEGER(TANF)=FALSE AND TANF IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_15,N,'GA IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'GA IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'GA MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(GA) not like '%.00' and IS_INTEGER(GA)=FALSE AND GA IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_16,N,'SOC_SEC_RETIREMENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SOC_SEC_RETIREMENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SOC_SEC_RETIREMENT MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(SOC_SEC_RETIREMENT) not like '%.00' and IS_INTEGER(SOC_SEC_RETIREMENT)=FALSE AND SOC_SEC_RETIREMENT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_17,N,'PENSION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PENSION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PENSION MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(PENSION) not like '%.00' and IS_INTEGER(PENSION)=FALSE AND PENSION IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_18,N,'CHILD_SUPPORT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CHILD_SUPPORT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CHILD_SUPPORT MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CHILD_SUPPORT) not like '%.00' and IS_INTEGER(CHILD_SUPPORT)=FALSE AND CHILD_SUPPORT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_19,N,'ALIMONY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ALIMONY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ALIMONY MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(ALIMONY) not like '%.00' and IS_INTEGER(ALIMONY)=FALSE AND ALIMONY IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_20,N,'OTHER_INCOME_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INCOME_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INCOME_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(OTHER_INCOME_SOURCE) not like '%.00' and IS_INTEGER(OTHER_INCOME_SOURCE)=FALSE AND OTHER_INCOME_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_21,N,'OTHER_INCOME_SOURCE_IDENTIFY EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INCOME_SOURCE_IDENTIFY EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INCOME_SOURCE_IDENTIFY EXCEEDS 50 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(OTHER_INCOME_SOURCE_IDENTIFY)>50"
INCOME_BENEFITS,INCOME_BENEFITS_22,N,'BENEFITS_FROM_ANY_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'BENEFITS_FROM_ANY_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'BENEFITS_FROM_ANY_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(BENEFITS_FROM_ANY_SOURCE) not like '%.00' and IS_INTEGER(BENEFITS_FROM_ANY_SOURCE)=FALSE AND BENEFITS_FROM_ANY_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_23,N,'SNAP IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SNAP IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SNAP MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(SNAP) not like '%.00' and IS_INTEGER(SNAP)=FALSE AND SNAP IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_24,N,'WIC IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WIC IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WIC MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(WIC) not like '%.00' and IS_INTEGER(WIC)=FALSE AND WIC IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_25,N,'TANF_CHILD_CARE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'TANF_CHILD_CARE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF_CHILD_CARE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(TANF_CHILD_CARE) not like '%.00' and IS_INTEGER(TANF_CHILD_CARE)=FALSE AND TANF_CHILD_CARE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_26,N,'TANF_TRANSPORTATION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'TANF_TRANSPORTATION IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF_TRANSPORTATION MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(TANF_TRANSPORTATION) not like '%.00' and IS_INTEGER(TANF_TRANSPORTATION)=FALSE AND TANF_TRANSPORTATION IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_27,N,'OTHER_TANF IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_TANF IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_TANF MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(OTHER_TANF) not like '%.00' and IS_INTEGER(OTHER_TANF)=FALSE AND OTHER_TANF IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_28,N,'OTHER_BENEFITS_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_BENEFITS_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_BENEFITS_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(OTHER_BENEFITS_SOURCE) not like '%.00' and IS_INTEGER(OTHER_BENEFITS_SOURCE)=FALSE AND OTHER_BENEFITS_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_29,N,'OTHER_BENEFITS_SOURCE_IDENTIFY EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_BENEFITS_SOURCE_IDENTIFY EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_BENEFITS_SOURCE_IDENTIFY EXCEEDS 50 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(OTHER_BENEFITS_SOURCE_IDENTIFY)>50"
INCOME_BENEFITS,INCOME_BENEFITS_30,N,'INSURANCE_FROM_ANY_SOURCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INSURANCE_FROM_ANY_SOURCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INSURANCE_FROM_ANY_SOURCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(INSURANCE_FROM_ANY_SOURCE) not like '%.00' and IS_INTEGER(INSURANCE_FROM_ANY_SOURCE)=FALSE AND INSURANCE_FROM_ANY_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_31,N,'MEDICAID IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'MEDICAID IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MEDICAID MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(MEDICAID) not like '%.00' and IS_INTEGER(MEDICAID)=FALSE AND MEDICAID IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_32,N,'NO_MEDICAID_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_MEDICAID_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_MEDICAID_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_MEDICAID_REASON) not like '%.00' and IS_INTEGER(NO_MEDICAID_REASON)=FALSE AND NO_MEDICAID_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_33,N,'SCHIP IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SCHIP IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SCHIP MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(SCHIP) not like '%.00' and IS_INTEGER(SCHIP)=FALSE AND SCHIP IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_34,N,'NO_SCHIP_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_SCHIP_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_SCHIP_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_SCHIP_REASON) not like '%.00' and IS_INTEGER(NO_SCHIP_REASON)=FALSE AND NO_SCHIP_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_35,N,'VHA_SERVICES IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VHA_SERVICES IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VHA_SERVICES MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(VHA_SERVICES) not like '%.00' and IS_INTEGER(VHA_SERVICES)=FALSE AND VHA_SERVICES IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_36,N,'NO_VHA_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_VHA_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_VHA_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_VHA_REASON) not like '%.00' and IS_INTEGER(NO_VHA_REASON)=FALSE AND NO_VHA_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_37,N,'EMPLOYER_PROVIDED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYER_PROVIDED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYER_PROVIDED MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(EMPLOYER_PROVIDED) not like '%.00' and IS_INTEGER(EMPLOYER_PROVIDED)=FALSE AND EMPLOYER_PROVIDED IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_38,N,'NO_EMPLOYER_PROVIDED_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_EMPLOYER_PROVIDED_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_EMPLOYER_PROVIDED_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_EMPLOYER_PROVIDED_REASON) not like '%.00' and IS_INTEGER(NO_EMPLOYER_PROVIDED_REASON)=FALSE AND NO_EMPLOYER_PROVIDED_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_39,N,'COBRA IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'COBRA IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'COBRA MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(COBRA) not like '%.00' and IS_INTEGER(COBRA)=FALSE AND COBRA IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_40,N,'NO_COBRA_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_COBRA_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_COBRA_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_COBRA_REASON) not like '%.00' and IS_INTEGER(NO_COBRA_REASON)=FALSE AND NO_COBRA_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_41,N,'PRIVATE_PAY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PRIVATE_PAY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PRIVATE_PAY MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(PRIVATE_PAY) not like '%.00' and IS_INTEGER(PRIVATE_PAY)=FALSE AND PRIVATE_PAY IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_42,N,'NO_PRIVATE_PAY_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_PRIVATE_PAY_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_PRIVATE_PAY_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_PRIVATE_PAY_REASON) not like '%.00' and IS_INTEGER(NO_PRIVATE_PAY_REASON)=FALSE AND NO_PRIVATE_PAY_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_43,N,'STATE_HEALTH_INS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'STATE_HEALTH_INS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'STATE_HEALTH_INS MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(STATE_HEALTH_INS) not like '%.00' and IS_INTEGER(STATE_HEALTH_INS)=FALSE AND STATE_HEALTH_INS IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_44,N,'NO_STATE_HEALTH_INS_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_STATE_HEALTH_INS_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_STATE_HEALTH_INS_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_STATE_HEALTH_INS_REASON) not like '%.00' and IS_INTEGER(NO_STATE_HEALTH_INS_REASON)=FALSE AND NO_STATE_HEALTH_INS_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_45,N,'INDIAN_HEALTH_SERVICES IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INDIAN_HEALTH_SERVICES IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INDIAN_HEALTH_SERVICES MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(INDIAN_HEALTH_SERVICES) not like '%.00' and IS_INTEGER(INDIAN_HEALTH_SERVICES)=FALSE AND INDIAN_HEALTH_SERVICES IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_46,N,'NO_INDIAN_HEALTH_SERVICES_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_INDIAN_HEALTH_SERVICES_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_INDIAN_HEALTH_SERVICES_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_INDIAN_HEALTH_SERVICES_REASON) not like '%.00' and IS_INTEGER(NO_INDIAN_HEALTH_SERVICES_REASON)=FALSE AND NO_INDIAN_HEALTH_SERVICES_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_47,N,'OTHER_INSURANCE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INSURANCE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INSURANCE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(OTHER_INSURANCE) not like '%.00' and IS_INTEGER(OTHER_INSURANCE)=FALSE AND OTHER_INSURANCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_48,N,'OTHER_INSURANCE_IDENTIFY EXCEEDS 50 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INSURANCE_IDENTIFY EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INSURANCE_IDENTIFY EXCEEDS 50 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(OTHER_INSURANCE_IDENTIFY)>50"
INCOME_BENEFITS,INCOME_BENEFITS_49,N,'ADAP IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ADAP IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ADAP MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(ADAP) not like '%.00' and IS_INTEGER(ADAP)=FALSE AND ADAP IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_50,N,'NO_ADAP_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_ADAP_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_ADAP_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_ADAP_REASON) not like '%.00' and IS_INTEGER(NO_ADAP_REASON)=FALSE AND NO_ADAP_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_51,N,'RYAN_WHITE_MED_DONT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'RYAN_WHITE_MED_DONT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'RYAN_WHITE_MED_DENT MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(RYAN_WHITE_MED_DENT) not like '%.00' and IS_INTEGER(RYAN_WHITE_MED_DENT)=FALSE AND RYAN_WHITE_MED_DENT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_52,N,'NO_RYAN_WHITE_REASON IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_RYAN_WHITE_REASON IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_RYAN_WHITE_REASON MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(NO_RYAN_WHITE_REASON) not like '%.00' and IS_INTEGER(NO_RYAN_WHITE_REASON)=FALSE AND NO_RYAN_WHITE_REASON IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_53,N,'CONNECTION_WITH_SOAR IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CONNECTION_WITH_SOAR IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CONNECTION_WITH_SOAR MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CONNECTION_WITH_SOAR) not like '%.00' and IS_INTEGER(CONNECTION_WITH_SOAR)=FALSE AND CONNECTION_WITH_SOAR IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_54,N,'DATA_COLLECTION_STAGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(DATA_COLLECTION_STAGE) not like '%.00' and IS_INTEGER(DATA_COLLECTION_STAGE)=FALSE AND DATA_COLLECTION_STAGE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_55,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
INCOME_BENEFITS,INCOME_BENEFITS_56,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
INCOME_BENEFITS,INCOME_BENEFITS_57,N,'INCOME_FROM_ANY_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'INCOME_FROM_ANY_SOURCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INCOME_FROM_ANY_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INCOME_FROM_ANY_SOURCE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.INCOME_FROM_ANY_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_58,N,'EARNED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'EARNED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EARNED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EARNED = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.EARNED IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_59,N,'UNEMPLOYMENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'UNEMPLOYMENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'UNEMPLOYMENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.UNEMPLOYMENT = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.UNEMPLOYMENT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_60,N,'SSI NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'SSI NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SSI CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SSI = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SSI IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_61,N,'SSDI NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'SSDI NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SSDI CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SSDI = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SSDI IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_62,N,'VA_DISABILITY_SERVICE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'VA_DISABILITY_SERVICE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VA_DISABILITY_SERVICE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VA_DISABILITY_SERVICE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.VA_DISABILITY_SERVICE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_63,N,'VA_DISABILITY_NON_SERVICE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'VA_DISABILITY_NON_SERVICE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VA_DISABILITY_NON_SERVICE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VA_DISABILITY_NON_SERVICE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.VA_DISABILITY_NON_SERVICE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_64,N,'PRIVATE_DISABILITY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'PRIVATE_DISABILITY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PRIVATE_DISABILITY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PRIVATE_DISABILITY = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.PRIVATE_DISABILITY IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_65,N,'WORKERS_COMP NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'WORKERS_COMP NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WORKERS_COMP CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WORKERS_COMP = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.WORKERS_COMP IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_66,N,'TANF NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'TANF NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TANF = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.TANF IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_67,N,'GA NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'GA NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'GA CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.GA = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.GA IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_68,N,'SOC_SEC_RETIREMENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'SOC_SEC_RETIREMENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SOC_SEC_RETIREMENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SOC_SEC_RETIREMENT = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SOC_SEC_RETIREMENT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_69,N,'PENSION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'PENSION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PENSION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PENSION = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.PENSION IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_70,N,'CHILD_SUPPORT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'CHILD_SUPPORT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CHILD_SUPPORT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CHILD_SUPPORT = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.CHILD_SUPPORT IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_71,N,'ALIMONY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'ALIMONY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ALIMONY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ALIMONY = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.ALIMONY IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_72,N,'OTHER_INCOME_SOURCE NOT IN HUD LIST ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'OTHER_INCOME_SOURCE NOT IN HUD LIST ' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INCOME_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.OTHER_INCOME_SOURCE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.OTHER_INCOME_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_73,N,'BENEFITS_FROM_ANY_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'BENEFITS_FROM_ANY_SOURCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'BENEFITS_FROM_ANY_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.BENEFITS_FROM_ANY_SOURCE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.BENEFITS_FROM_ANY_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_74,N,'SNAP NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'SNAP NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SNAP CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SNAP = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.SNAP IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_75,N,'WIC NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'WIC NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WIC CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.WIC = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.WIC IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_76,N,'TANF_CHILD_CARE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'TANF_CHILD_CARE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF_CHILD_CARE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TANF_CHILD_CARE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.TANF_CHILD_CARE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_77,N,'TANF_TRANSPORTATION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'TANF_TRANSPORTATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF_TRANSPORTATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TANF_TRANSPORTATION = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.TANF_TRANSPORTATION IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_78,N,'OTHER_TANF NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'OTHER_TANF NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_TANF CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.OTHER_TANF = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.OTHER_TANF IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_79,N,OTHER_BENEFITS_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'OTHER_BENEFITS_SOURCE NOT IN HUT LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_BENEFITS_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.OTHER_BENEFITS_SOURCE = c.VALID_VALUES and c.List_Name = '1.7' WHERE c.VALID_VALUES IS NULL AND a.OTHER_BENEFITS_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_80,N,'INSURANCE_FROM_ANY_SOURCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'INSURANCE_FROM_ANY_SOURCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INSURANCE_FROM_ANY_SOURCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INSURANCE_FROM_ANY_SOURCE = c.VALID_VALUES and c.List_Name = '1.8' WHERE c.VALID_VALUES IS NULL AND a.INSURANCE_FROM_ANY_SOURCE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_81,N,'MEDICAID NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'MEDICAID NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MEDICAID CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MEDICAID = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) and (c.VALID_VALUES IS NULL AND a.MEDICAID IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_82,N,'NO_MEDICAID_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'NO_MEDICAID_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_MEDICAID_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_MEDICAID_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_MEDICAID_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_83,N,'MEDICARE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'MEDICARE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MEDICARE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MEDICARE = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.MEDICARE IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_84,N,'NO_MEDICARE_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_MEDICARE_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_MEDICARE_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_MEDICARE_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_MEDICARE_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_85,N,'SCHIP NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'SCHIP NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SCHIP CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SCHIP = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.SCHIP IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_86,N,'NO_SCHIP_REASON IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_SCHIP_REASON IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_SCHIP_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_SCHIP_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_SCHIP_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_87,N,'VHA_SERVICES NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'VHA_SERVICES NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VHA_SERVICES CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VHA_SERVICES = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.VHA_SERVICES IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_88,N,'NO_VHA_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_VHA_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_VHA_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_VHA_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ( c.VALID_VALUES IS NULL AND a.NO_VHA_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_89,N,'EMPLOYER_PROVIDED NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'EMPLOYER_PROVIDED NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYER_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.EMPLOYER_PROVIDED = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.EMPLOYER_PROVIDED IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_90,N,'NO_EMPLOYER_PROVIDED_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_EMPLOYER_PROVIDED_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_EMPLOYER_PROVIDED_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_EMPLOYER_PROVIDED_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_EMPLOYER_PROVIDED_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_91,N,'COBRA NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'COBRA NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'COBRA CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.COBRA = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.COBRA IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_92,N,'NO_COBRA_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_COBRA_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_COBRA_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_COBRA_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_COBRA_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_93,N,'PRIVATE_PAY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'PRIVATE_PAY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PRIVATE_PAY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PRIVATE_PAY = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.PRIVATE_PAY IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_94,N,'NO_PRIVATE_PAY_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_PRIVATE_PAY_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_PRIVATE_PAY_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_PRIVATE_PAY_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_PRIVATE_PAY_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_95,N,'STATE_HEALTH_INS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'STATE_HEALTH_INS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'STATE_HEALTH_INS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.STATE_HEALTH_INS = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.STATE_HEALTH_INS IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_96,N,'NO_STATE_HEALTH_INS_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then a.stg_md5_hash_value else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_STATE_HEALTH_INS_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_STATE_HEALTH_INS_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_STATE_HEALTH_INS_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_STATE_HEALTH_INS_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_97,N,'INDIAN_HEALTH_SERVICES NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'INDIAN_HEALTH_SERVICES NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INDIAN_HEALTH_SERVICES CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.INDIAN_HEALTH_SERVICES = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.INDIAN_HEALTH_SERVICES IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_98,N,'NO_INDIAN_HEALTH_SERVICES_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_INDIAN_HEALTH_SERVICES_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_INDIAN_HEALTH_SERVICES_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_INDIAN_HEALTH_SERVICES_REASON = c.VALID_VALUES and c.List_Name = '4.04.A' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_INDIAN_HEALTH_SERVICES_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_99,N,'OTHER_INSURANCE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'OTHER_INSURANCE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INSURANCE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.OTHER_INSURANCE = c.VALID_VALUES and c.List_Name = '1.7' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.OTHER_INSURANCE IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_100,N,'ADAP NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'ADAP NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ADAP CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ADAP = c.VALID_VALUES and c.List_Name = '1.8' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.ADAP IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_101,N,'NO_ADAP_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_ADAP_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_ADAP_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_ADAP_REASON = c.VALID_VALUES and c.List_Name = 'W3' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_ADAP_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_102,N,'RYAN_WHITE_MED_DENT NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'RYAN_WHITE_MED_DENT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'RYAN_WHITE_MED_DENT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RYAN_WHITE_MED_DENT = c.VALID_VALUES and c.List_Name = '1.8' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.RYAN_WHITE_MED_DENT IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_103,N,'NO_RYAN_WHITE_REASON NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'NO_RYAN_WHITE_REASON NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_RYAN_WHITE_REASON CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.NO_RYAN_WHITE_REASON = c.VALID_VALUES and c.List_Name = 'W3' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.NO_RYAN_WHITE_REASON IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_104,N,'CONNECTION_WITH_SOAR NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'CONNECTION_WITH_SOAR NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CONNECTION_WITH_SOAR CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CONNECTION_WITH_SOAR = c.VALID_VALUES and c.List_Name = '1.8' JOIN STAGING.PSTG_ENROLLMENT D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE JOIN STAGING.PSTG_FUNDER E ON D.PROJECT_ID = E.PROJECT_ID AND D.SOURCE_FILE = E.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND (c.VALID_VALUES IS NULL AND a.CONNECTION_WITH_SOAR IS NOT NULL)"
INCOME_BENEFITS,INCOME_BENEFITS_105,N,'DATA_COLLECTION_STAGE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME ,(case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, CASE WHEN A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DATA_COLLECTION_STAGE = c.VALID_VALUES and c.List_Name = '5.03.1' WHERE c.VALID_VALUES IS NULL AND a.DATA_COLLECTION_STAGE IS NOT NULL"
INCOME_BENEFITS,INCOME_BENEFITS_106,N,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INFORMATION_DATE,1,10) NOT LIKE '%____-__-__%'"
INCOME_BENEFITS,INCOME_BENEFITS_107,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
INCOME_BENEFITS,INCOME_BENEFITS_108,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
INCOME_BENEFITS,INCOME_BENEFITS_109,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
INCOME_BENEFITS,INCOME_BENEFITS_110,N,'TOTAL_MONTHLY_INCOME NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'TOTAL_MONTHLY_INCOME NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TotalMonthlyIncome must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TOTAL_MONTHLY_INCOME IS NOT NULL AND (TRY_TO_NUMBER(TOTAL_MONTHLY_INCOME) IS NULL OR TO_DECIMAL(TOTAL_MONTHLY_INCOME) < 0 OR TOTAL_MONTHLY_INCOME NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_111,N,'EARNED_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EARNED_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EARNED_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EARNED_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(EARNED_AMOUNT) IS NULL OR TO_DECIMAL(EARNED_AMOUNT) < 0 OR EARNED_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_112,N,'UNEMPLOYMENT_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'UNEMPLOYMENT_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'UNEMPLOYMENT_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE UNEMPLOYMENT_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(UNEMPLOYMENT_AMOUNT) IS NULL OR TO_DECIMAL(UNEMPLOYMENT_AMOUNT) < 0 OR UNEMPLOYMENT_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_113,N,'SSI_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SSI_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SSI_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SSI_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(SSI_AMOUNT) IS NULL OR TO_DECIMAL(SSI_AMOUNT) < 0 OR SSI_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_114,N,'SSDI_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SSDI_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SSDI_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SSDI_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(SSDI_AMOUNT) IS NULL OR TO_DECIMAL(SSDI_AMOUNT) < 0 OR SSDI_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_115,N,'VA_DISABILITY_SERVICE_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VA_DISABILITY_SERVICE_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VA_DISABILITY_SERVICE_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE VA_DISABILITY_SERVICE_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(VA_DISABILITY_SERVICE_AMOUNT) IS NULL OR TO_DECIMAL(VA_DISABILITY_SERVICE_AMOUNT) < 0 OR VA_DISABILITY_SERVICE_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_116,N,'VA_DISABILITY_NON_SERVICE_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VA_DISABILITY_NON_SERVICE_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'VA_DISABILITY_NON_SERVICE_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE VA_DISABILITY_NON_SERVICE_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(VA_DISABILITY_NON_SERVICE_AMOUNT) IS NULL OR TO_DECIMAL(VA_DISABILITY_NON_SERVICE_AMOUNT) < 0 OR VA_DISABILITY_NON_SERVICE_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_117,N,'PRIVATE_DISABILITY_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PRIVATE_DISABILITY_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PRIVATE_DISABILITY_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PRIVATE_DISABILITY_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(PRIVATE_DISABILITY_AMOUNT) IS NULL OR TO_DECIMAL(PRIVATE_DISABILITY_AMOUNT) < 0 OR PRIVATE_DISABILITY_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_118,N,'WORKERS_COMP_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WORKERS_COMP_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WORKERS_COMP_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INCOME_FROM_ANY_SOURCE=1 AND (WORKERS_COMP_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(WORKERS_COMP_AMOUNT) IS NULL OR TO_DECIMAL(WORKERS_COMP_AMOUNT) < 0 OR WORKERS_COMP_AMOUNT NOT LIKE '%.__'))"
INCOME_BENEFITS,INCOME_BENEFITS_119,N,'TANF_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'TANF_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TANF_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TANF_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(TANF_AMOUNT) IS NULL OR TO_DECIMAL(TANF_AMOUNT) < 0 OR TANF_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_120,N,'GA_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'GA_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'GA_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE GA_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(GA_AMOUNT) IS NULL OR TO_DECIMAL(GA_AMOUNT) < 0 OR GA_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_121,N,'SOC_SEC_RETIREMENT_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SOC_SEC_RETIREMENT_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'SOC_SEC_RETIREMENT_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOC_SEC_RETIREMENT_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(SOC_SEC_RETIREMENT_AMOUNT) IS NULL OR TO_DECIMAL(SOC_SEC_RETIREMENT_AMOUNT) < 0 OR SOC_SEC_RETIREMENT_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_122,N,'PENSION_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PENSION_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PENSION_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PENSION_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(PENSION_AMOUNT) IS NULL OR TO_DECIMAL(PENSION_AMOUNT) < 0 OR PENSION_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_123,N,'CHILD_SUPPORT_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CHILD_SUPPORT_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CHILD_SUPPORT_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CHILD_SUPPORT_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(CHILD_SUPPORT_AMOUNT) IS NULL OR TO_DECIMAL(CHILD_SUPPORT_AMOUNT) < 0 OR CHILD_SUPPORT_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_124,N,'ALIMONY_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ALIMONY_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ALIMONY_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ALIMONY_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(ALIMONY_AMOUNT) IS NULL OR TO_DECIMAL(ALIMONY_AMOUNT) < 0 OR ALIMONY_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_125,N,'OTHER_INCOME_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INCOME_AMOUNT NOT A NON-NEGATIVE NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INCOME_AMOUNT must be a non-negative number with two decimal places (no commas and no currency symbols).' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE OTHER_INCOME_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(OTHER_INCOME_AMOUNT) IS NULL OR TO_DECIMAL(OTHER_INCOME_AMOUNT) < 0 OR OTHER_INCOME_AMOUNT NOT LIKE '%.__')"
INCOME_BENEFITS,INCOME_BENEFITS_126,N,'INCOME_BENEFITS_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INCOME_BENEFITS_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INCOME_BENEFITS_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT INCOME_BENEFITS_ID, SOURCE_FILE FROM STAGING.PSTG_INCOME_BENEFITS GROUP BY INCOME_BENEFITS_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.INCOME_BENEFITS_ID = C.INCOME_BENEFITS_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.INCOME_BENEFITS_ID IS NOT NULL"
INVENTORY,INVENTORY_1,N,'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECTCOC.CSV',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECTCOC.CSV' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECTCoC.CSV' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT_COC C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NULL"
INVENTORY,INVENTORY_2,N,'HOUSEHOLD_TYPE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'HOUSEHOLD_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HOUSEHOLD_TYPE IS NULL"
INVENTORY,INVENTORY_3,N,"'AVAILABILITY IS NULL UNLESS PROJECT_TYPE  IN(0,1)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'AVAILABILITY IS NULL UNLESS PROJECT_TYPE  IN(0,1)' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'AVAILABILITY IS NULL UNLESS PROJECT_TYPE EQUALS 0 OR 1.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE A.AVAILABILITY IS NULL AND C.PROJECT_TYPE IN (0,1)"
INVENTORY,INVENTORY_4,N,'UNIT_INVENTORY IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'UNIT_INVENTORY IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'UNIT_INVENTORY IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE UNIT_INVENTORY IS NULL"
INVENTORY,INVENTORY_5,N,'BED_INVENTORY IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'BED_INVENTORY IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'BED_INVENTORY IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE BED_INVENTORY IS NULL"
INVENTORY,INVENTORY_6,N,'INVENTORY_START_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_START_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'INVENTORY_START_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INVENTORY_START_DATE IS NULL"
INVENTORY,INVENTORY_7,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
INVENTORY,INVENTORY_8,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
INVENTORY,INVENTORY_9,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
INVENTORY,INVENTORY_10,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when INVENTORY_ID||'|'||PROJECT_ID||'|'||COC_CODE||'|'||HOUSEHOLD_TYPE is null then SRC.STG_MD5_HASH_VALUE else INVENTORY_ID||'|'||PROJECT_ID||'|'||COC_CODE||'|'||HOUSEHOLD_TYPE end) AS BUSINESS_KEY_VALUE, SRC.INVENTORY_END_DATE FROM STAGING.PSTG_INVENTORY SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
INVENTORY,INVENTORY_11,N,'COC_CODE DOES NOT MATCH A COC_CODE IN PROJECTCOC.CSV FOR THE SAME PROJECT_ID',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'COC_CODE DOES NOT MATCH A COC_CODE IN PROJECTCOC.CSV FOR THE SAME PROJECT_ID' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'COC_CODE IS NULL OR DOES NOT MATCH A COC_CODE IN PROJECTCOC.CSV FOR THE SAME PROJECT_ID' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT_COC c ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE AND a.COC_CODE = c.COC_CODE WHERE C.COC_CODE IS NULL"
INVENTORY,INVENTORY_12,N,'ES_BED_TYPE IS NULL UNLESS PROJECT_TYPE = 0 OR 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'ES_BED_TYPE IS NULL UNLESS PROJECT_TYPE = 0 OR 1' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'ES_BED_TYPE IS NULL UNLESS PROJECT_TYPE = 0 OR 1' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_PROJECT C ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE WHERE (A.ES_BED_TYPE IS NULL AND C.PROJECT_TYPE IN (0,1)) OR (A.ES_BED_TYPE IS NOT NULL AND C.PROJECT_TYPE NOT IN (0,1))"
INVENTORY,INVENTORY_13,N,'HOUSEHOLD_TYPE = 3 AND PROJECT_TYPE = 8',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE = 3 AND PROJECT_TYPE = 8' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'Safe havens are expected to only have beds for households without children or households with only children.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID AND a.SOURCE_FILE = c.SOURCE_FILE WHERE a.HOUSEHOLD_TYPE = 3 AND c.PROJECT_TYPE = 8"
INVENTORY,INVENTORY_14,N,'AVAILABILITY = 2 AND INVENTORY_END_DATE IS NULL',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'AVAILABILITY = 2 AND INVENTORY_END_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'Seasonal inventory records need to have an end date.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 WHERE AVAILABILITY = 2 AND INVENTORY_END_DATE IS NULL"
INVENTORY,INVENTORY_15,N,'UNIT_INVENTORY IS NOT NULL AND UNIT_INVENTORY > BED_INVENTORY',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'UNIT_INVENTORY IS NOT NULL AND UNIT_INVENTORY > BED_INVENTORY' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'The number of units cannot be greater than the number of beds.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE a.UNIT_INVENTORY is not NULL and a.UNIT_INVENTORY > a.BED_INVENTORY"
INVENTORY,INVENTORY_16,N,"'THE TOTAL NUMBER OF BEDS MUST EQUAL THE SUM OF THE DEDICATED AND NON-DEDICATED BEDS, BY POPULATION (.7-.13)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'THE TOTAL NUMBER OF BEDS MUST EQUAL THE SUM OF THE DEDICATED AND NON-DEDICATED BEDS, BY POPULATION (.7-.13)' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'The total number of beds must equal the sum of the dedicated and non-dedicated beds, by population.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE BED_INVENTORY <> (CH_VET_BED_INVENTORY + YOUTH_VET_BED_INVENTORY + VET_BED_INVENTORY + CH_YOUTH_BED_INVENTORY + YOUTH_BED_INVENTORY + CH_BED_INVENTORY + OTHER_BED_INVENTORY)"
INVENTORY,INVENTORY_17,N,'HOUSEHOLD_TYPE = 4 AND CH_VET_BED_INVENTORY > 0',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE = 4 AND CH_VET_BED_INVENTORY > 0' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'There cannot be veteran beds for households with only children.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HOUSEHOLD_TYPE = 4 AND CH_VET_BED_INVENTORY > 0"
INVENTORY,INVENTORY_18,N,'HOUSEHOLD_TYPE = 4 AND YOUTH_VET_BED_INVENTORY > 0',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE = 4 AND YOUTH_VET_BED_INVENTORY > 0' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'There cannot be veteran beds for households with only children.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HOUSEHOLD_TYPE = 4 AND YOUTH_VET_BED_INVENTORY > 0"
INVENTORY,INVENTORY_19,N,'HOUSEHOLD_TYPE = 4 AND VET_BED_INVENTORY > 0',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE = 4 AND VET_BED_INVENTORY > 0' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'There cannot be veteran beds for households with only children.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE HOUSEHOLD_TYPE = 4 AND VET_BED_INVENTORY > 0"
INVENTORY,INVENTORY_20,N,'INVENTORY_END_DATE < INVENTORY_START_DATE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_END_DATE < INVENTORY_START_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'The Inventory End Date cannot be before the Inventory Start Date.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE(a.Inventory_End_Date) < DATE(a.Inventory_Start_Date)"
INVENTORY,INVENTORY_21,N,'INVENTORY_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'INVENTORY_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INVENTORY_ID IS NULL"
INVENTORY,INVENTORY_22,N,'PROJECT_ID IS NULL ',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL ' DESCR, 'ERROR' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_ID IS NULL"
INVENTORY,INVENTORY_23,N,'INVENTORY_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'INVENTORY_ID EXCEEDS 32 CHARACTERS'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(INVENTORY_ID)>32"
INVENTORY,INVENTORY_24,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'PROJECT_ID EXCEEDS 32 CHARACTERS'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_ID)>32"
INVENTORY,INVENTORY_25,N,'COC_CODE EXCEEDS 6 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'COC_CODE EXCEEDS 6 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'COC_CODE EXCEEDS 6 CHARACTERS'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(COC_CODE)>6"
INVENTORY,INVENTORY_26,N,'HOUSEHOLD_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'HOUSEHOLD_TYPE MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(HOUSEHOLD_TYPE) not like '%.00' and IS_INTEGER(HOUSEHOLD_TYPE)=FALSE"
INVENTORY,INVENTORY_27,N,'AVAILABILITY IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'AVAILABILITY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'AVAILABILITY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(AVAILABILITY) not like '%.00' and IS_INTEGER(AVAILABILITY)=FALSE"
INVENTORY,INVENTORY_28,N,'UNIT_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'UNIT_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'UNIT_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(UNIT_INVENTORY) not like '%.00' and IS_INTEGER(UNIT_INVENTORY)=FALSE"
INVENTORY,INVENTORY_29,N,'BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(BED_INVENTORY) not like '%.00' and IS_INTEGER(BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_30,N,'CH_VET_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'CH_VET_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'CH_VET_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CH_VET_BED_INVENTORY) not like '%.00' and IS_INTEGER(CH_VET_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_31,N,'YOUTH_VET_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'YOUTH_VET_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'YOUTH_VET_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(YOUTH_VET_BED_INVENTORY) not like '%.00' and IS_INTEGER(YOUTH_VET_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_32,N,'VET_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'VET_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'VET_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(VET_BED_INVENTORY) not like '%.00' and IS_INTEGER(VET_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_33,N,'CH_YOUTH_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'CH_YOUTH_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'CH_YOUTH_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CH_YOUTH_BED_INVENTORY) not like '%.00' and IS_INTEGER(CH_YOUTH_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_34,N,'YOUTH_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'YOUTH_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'YOUTH_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(YOUTH_BED_INVENTORY) not like '%.00' and IS_INTEGER(YOUTH_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_35,N,'CH_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'CH_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'CH_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CH_BED_INVENTORY) not like '%.00' and IS_INTEGER(CH_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_36,N,'OTHER_BED_INVENTORY IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'OTHER_BED_INVENTORY IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'OTHER_BED_INVENTORY MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(OTHER_BED_INVENTORY) not like '%.00' and IS_INTEGER(OTHER_BED_INVENTORY)=FALSE"
INVENTORY,INVENTORY_37,N,'ES_BED_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'ES_BED_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'ES_BED_TYPE MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(ES_BED_TYPE) not like '%.00' and IS_INTEGER(ES_BED_TYPE)=FALSE"
INVENTORY,INVENTORY_38,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
INVENTORY,INVENTORY_39,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
INVENTORY,INVENTORY_40,N,'HOUSEHOLD_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME ,(case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'HOUSEHOLD_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'HOUSEHOLD_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HOUSEHOLD_TYPE = c.VALID_VALUES and c.List_Name = '2.07.4' WHERE c.VALID_VALUES IS NULL AND a.HOUSEHOLD_TYPE IS NOT NULL"
INVENTORY,INVENTORY_41,N,'AVAILABILITY NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME ,(case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'AVAILABILITY NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'AVAILABILITY CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.AVAILABILITY = c.VALID_VALUES and c.List_Name = '2.07.6' WHERE c.VALID_VALUES IS NULL AND a.AVAILABILITY IS NOT NULL"
INVENTORY,INVENTORY_42,N,'ES_BED_TYPE NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME ,(case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'ES_BED_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'ES_BED_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.ES_BED_TYPE = c.VALID_VALUES and c.List_Name = '2.07.5' WHERE c.VALID_VALUES IS NULL AND a.ES_BED_TYPE IS NOT NULL"
INVENTORY,INVENTORY_43,N,'INVENTORY_START_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_START_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'INVENTORY_START_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INVENTORY_START_DATE,1,10) NOT LIKE '%____-__-__%'"
INVENTORY,INVENTORY_44,N,'INVENTORY_END_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_END_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR,	'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'INVENTORY_END_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(INVENTORY_END_DATE,1,10) NOT LIKE '%____-__-__%'"
INVENTORY,INVENTORY_45,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
INVENTORY,INVENTORY_46,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
INVENTORY,INVENTORY_47,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
INVENTORY,INVENTORY_48,N,'INVENTORY_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'INVENTORY_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'INVENTORY_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT INVENTORY_ID, SOURCE_FILE FROM STAGING.PSTG_INVENTORY GROUP BY INVENTORY_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.INVENTORY_ID = C.INVENTORY_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.INVENTORY_ID IS NOT NULL"
ORGANIZATION,ORGANIZATION_1,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE DATE_CREATED IS NULL"
ORGANIZATION,ORGANIZATION_2,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE DATE_UPDATED IS NULL"
ORGANIZATION,ORGANIZATION_3,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE USER_ID IS NULL"
ORGANIZATION,ORGANIZATION_4,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.ORGANIZATION_ID IS NULL then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME,  (case when SRC.ORGANIZATION_ID IS NULL THEN SRC.STG_MD5_HASH_VALUE ELSE SRC.ORGANIZATION_ID END) AS BUSINESS_KEY_VALUE, OPERATING_END_DATE FROM STAGING.PSTG_ORGANIZATION SRC  join staging.rt_coc_control b on src.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project  group by organization_id, source_file) C on SRC.organization_id = c.organization_id  and SRC.source_file = c.source_file LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED,  SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN  SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,  CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE  FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
ORGANIZATION,ORGANIZATION_5,N,'VICTIM_SERVICES_PROVIDER IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'VICTIM_SERVICES_PROVIDER IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'VICTIM_SERVICES_PROVIDER IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE VICTIM_SERVICES_PROVIDER IS NULL"
ORGANIZATION,ORGANIZATION_6,N,'ORGANIZATION_NAME IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME, (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_NAME IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ORGANIZATION_NAME IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE ORGANIZATION_NAME IS NULL"
ORGANIZATION,ORGANIZATION_7,N,'ACTIVE CLIENTS AND VICTIM_SERVICES_PROVIDER = 1',HIGH PRIORITY,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME, (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE, 'ACTIVE CLIENTS AND VICTIM_SERVICES_PROVIDER = 1' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'Victim services providers are generally prohibited from participating in HMIS.' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_EXPORT c ON a.EXPORT_ID = c.EXPORT_ID and a.SOURCE_FILE = c.SOURCE_FILE JOIN STAGING.PSTG_PROJECT d ON a.ORGANIZATION_ID = d.ORGANIZATION_ID and a.SOURCE_FILE = d.SOURCE_FILE JOIN STAGING.PSTG_ENROLLMENT e ON d.PROJECT_ID = e.PROJECT_ID and d.SOURCE_FILE = e.SOURCE_FILE JOIN STAGING.PSTG_EXIT f ON f.ENROLLMENT_ID = e.ENROLLMENT_ID and e.SOURCE_FILE = f.SOURCE_FILE WHERE a.VICTIM_SERVICES_PROVIDER = 1 AND  (f.EXIT_DATE is NULL or f.EXIT_DATE >= (CASE WHEN EXTRACT(month from DATE(c.EXPORT_END_DATE)) in (1,2,3) THEN CONCAT(EXTRACT(year FROM DATE(c.EXPORT_END_DATE)),'-01-01')  WHEN EXTRACT(month from DATE(c.EXPORT_END_DATE)) in (4,5,6) THEN CONCAT(EXTRACT(year FROM DATE(c.EXPORT_END_DATE)),'-04-01')  WHEN EXTRACT(month from DATE(c.EXPORT_END_DATE)) in (7,8,9) THEN CONCAT(EXTRACT(year FROM DATE(c.EXPORT_END_DATE)),'-07-01')  WHEN EXTRACT(month from DATE(c.EXPORT_END_DATE)) in (10,11,12) THEN CONCAT(EXTRACT(year FROM DATE(c.EXPORT_END_DATE)),'-10-01') END))"
ORGANIZATION,ORGANIZATION_8,N,'ORGANIZATION_ID IS NULL',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ORGANIZATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE A.ORGANIZATION_ID IS NULL"
ORGANIZATION,ORGANIZATION_9,N,'ORGANIZATION_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ORGANIZATION_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE LEN(A.ORGANIZATION_ID)>32"
ORGANIZATION,ORGANIZATION_10,N,'ORGANIZATION_NAME EXCEEDS 200 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_NAME EXCEEDS 200 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ORGANIZATION_NAME EXCEEDS 200 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE LEN(ORGANIZATION_NAME)>200"
ORGANIZATION,ORGANIZATION_11,N,'VICTIM_SERVICES_PROVIDER IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'VICTIM_SERVICES_PROVIDER IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'VICTIM_SERVICES_PROVIDER MUST BE AN INTEGER' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE to_char(VICTIM_SERVICES_PROVIDER) not like '%.00' and IS_INTEGER(VICTIM_SERVICES_PROVIDER)=FALSE"
ORGANIZATION,ORGANIZATION_12,N,'ORGANIZATION_COMMON_NAME EXCEEDS 200 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_COMMON_NAME EXCEEDS 200 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ORGANIZATION_COMMON_NAME EXCEEDS 200 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE LEN(ORGANIZATION_COMMON_NAME)>200"
ORGANIZATION,ORGANIZATION_13,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE LEN(USER_ID)>32"
ORGANIZATION,ORGANIZATION_14,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE LEN(EXPORT_ID)>32"
ORGANIZATION,ORGANIZATION_15,N,'VICTIM_SERVICES_PROVIDER NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME ,(case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, A.ORGANIZATION_ID BUSINESS_KEY_VALUE,'VICTIM_SERVICES_PROVIDER NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'VICTIM_SERVICES_PROVIDER CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.VICTIM_SERVICES_PROVIDER = c.VALID_VALUES and c.List_Name = '1.10' left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) D on a.organization_id = D.organization_id and a.source_file = D.source_file WHERE c.VALID_VALUES IS NULL AND a.VICTIM_SERVICES_PROVIDER IS NOT NULL"
ORGANIZATION,ORGANIZATION_16,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ORGANIZATION' TABLE_NAME, (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
ORGANIZATION,ORGANIZATION_17,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ORGANIZATION' TABLE_NAME, (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
ORGANIZATION,ORGANIZATION_18,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_ORGANIZATION' TABLE_NAME, (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) C on a.organization_id = c.organization_id and a.source_file = c.source_file WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
ORGANIZATION,ORGANIZATION_19,N,'ORGANIZATION_ID IS NOT UNIQUE',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ORGANIZATION' TABLE_NAME , (case when A.ORGANIZATION_ID is null then 'STG_MD5_HASH_VALUE' else 'ORGANIZATION_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ORGANIZATION_ID is null then A.STG_MD5_HASH_VALUE else A.ORGANIZATION_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_ID IS NOT UNIQUE' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ORGANIZATION_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_ORGANIZATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join (select max(operating_end_date) operating_end_date, organization_id, source_file from staging.pstg_project group by organization_id, source_file) d on a.organization_id = d.organization_id and a.source_file = d.source_file LEFT JOIN (SELECT ORGANIZATION_ID, SOURCE_FILE FROM STAGING.PSTG_ORGANIZATION GROUP BY ORGANIZATION_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.ORGANIZATION_ID = C.ORGANIZATION_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ORGANIZATION_ID IS NOT NULL"
PROJECT,PROJECT_1,N,'CONTINUUM_PROJECT IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CONTINUUM_PROJECT IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'CONTINUUM_PROJECT IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CONTINUUM_PROJECT IS NULL"
PROJECT,PROJECT_2,N,'OPERATING_START_DATE IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'OPERATING_START_DATE IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'OPERATING_START_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE OPERATING_START_DATE IS NULL"
PROJECT,PROJECT_3,N,'PROJECT_NAME IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_NAME IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_NAME IS NULL"
PROJECT,PROJECT_4,N,'ORGANIZATION_ID DOES NOT MATCH A RECORD IN ORGANIZATION.CSV',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_ID DOES NOT MATCH A RECORD IN ORGANIZATION.CSV' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'ORGANIZATION_ID DOES NOT MATCH A RECORD IN ORGANIZATION.CSV' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_ORGANIZATION C ON A.ORGANIZATION_ID = C.ORGANIZATION_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.ORGANIZATION_ID IS NULL"
PROJECT,PROJECT_5,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE, (case when SRC.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME,  (case when SRC.PROJECT_ID is null then SRC.STG_MD5_HASH_VALUE else SRC.PROJECT_ID end) AS BUSINESS_KEY_VALUE, SRC.OPERATING_END_DATE FROM STAGING.PSTG_PROJECT SRC join staging.rt_coc_control b on src.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
PROJECT,PROJECT_6,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
PROJECT,PROJECT_7,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
PROJECT,PROJECT_8,N,'PROJECT_TYPE IS NULL AND CONTINUUM_PROJECT = 1',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_TYPE IS NULL AND CONTINUUM_PROJECT = 1' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'ProjectType may only be null if ContinuumProject is not equal to 1.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_TYPE IS NULL AND CONTINUUM_PROJECT =1"
PROJECT,PROJECT_9,N,'TARGET_POPULATION IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'TARGET_POPULATION IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'TARGET_POPULATION IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TARGET_POPULATION IS NULL"
PROJECT,PROJECT_10,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE A.DATE_CREATED IS NULL"
PROJECT,PROJECT_11,N,'MIN INVENTORY_START_DATE < OPERATING_START_DATE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'MIN INVENTORY_START_DATE < OPERATING_START_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'The earliest inventory start date is before the operating start date for the project. Please review the inventory for this project and update the earliest inventory start date to at least match the operating start date for this project.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN (SELECT MIN(DATE(INVENTORY_START_DATE)) as INVENTORY_START_DATE, PROJECT_ID, SOURCE_FILE FROM STAGING.PSTG_INVENTORY GROUP BY PROJECT_ID, SOURCE_FILE) C ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE WHERE DATE(a.OPERATING_START_DATE) > DATE(c.INVENTORY_START_DATE)"
PROJECT,PROJECT_12,N,'MAX INVENTORY_END_DATE > OPERATING_END_DATE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'MAX INVENTORY_END_DATE > OPERATING_END_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'The latest inventory end date is later than the operating end date for the project. There could also be an inventory record with a null/missing end date, implying the inventory record is still active, but the project has already closed according to the operating date.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and run_ind = 1 JOIN (SELECT MAX(DATE(INVENTORY_END_DATE)) AS INVENTORY_END_DATE, PROJECT_ID, SOURCE_FILE FROM STAGING.PSTG_INVENTORY GROUP BY PROJECT_ID, SOURCE_FILE) C ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE WHERE DATE(a.OPERATING_END_DATE) < DATE(c.INVENTORY_END_DATE)"
PROJECT,PROJECT_13,N,'OPERATING_END_DATE < OPERATING_START_DATE',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'OPERATING_END_DATE < OPERATING_START_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'Operating End Date cannot occur before the Operating Start Date.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE(a.Operating_End_Date) < DATE(a.Operating_Start_Date)"
PROJECT,PROJECT_14,N,'ACTIVE CLIENTS IN AC HOUSEHOLDS WHERE PROJECT_TYPE = 4',,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ACTIVE CLIENTS IN AC HOUSEHOLDS WHERE PROJECT_TYPE = 4' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'We expect safe havens to only serve adult-only and child-only households.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_INVENTORY c ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE JOIN STAGING.PSTG_EXIT d ON d.EXPORT_ID = c.EXPORT_ID and d.SOURCE_FILE = c.SOURCE_FILE JOIN STAGING.PSTG_EXPORT e ON a.EXPORT_ID = e.EXPORT_ID and a.SOURCE_FILE = e.SOURCE_FILE WHERE c.HOUSEHOLD_TYPE = 3 AND (DATE(d.EXIT_DATE) is NULL or DATE(d.EXIT_DATE) >= (CASE WHEN month(DATE(e.EXPORT_END_DATE)) in (1,2,3) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-01-01') WHEN month(DATE(e.EXPORT_END_DATE)) in (4,5,6) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-04-01') WHEN month(DATE(e.EXPORT_END_DATE)) in (7,8,9) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-07-01') WHEN month(DATE(e.EXPORT_END_DATE)) in (10,11,12) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-10-01') END)) AND a.PROJECT_TYPE = 4"
PROJECT,PROJECT_15,N,'ACTIVE CLIENTS WHERE TARGET_POPULATION = 1',,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ACTIVE CLIENTS WHERE TARGET_POPULATION = 1' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'We expect safe havens to only serve adult-only and child-only households.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT c ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE JOIN STAGING.PSTG_EXIT d ON d.ENROLLMENT_ID = c.ENROLLMENT_ID and d.SOURCE_FILE = c.SOURCE_FILE JOIN STAGING.PSTG_EXPORT e ON a.EXPORT_ID = e.EXPORT_ID and a.SOURCE_FILE = d.SOURCE_FILE WHERE a.TARGET_POPULATION = 1 AND (DATE(d.EXIT_DATE) is NULL or DATE(d.EXIT_DATE) >= (CASE WHEN month(DATE(e.EXPORT_END_DATE)) in (1,2,3) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-01-01') WHEN month(DATE(e.EXPORT_END_DATE)) in (4,5,6) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-04-01') WHEN month(DATE(e.EXPORT_END_DATE)) in (7,8,9) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-07-01') WHEN month(DATE(e.EXPORT_END_DATE)) in (10,11,12) THEN CONCAT(YEAR(DATE(e.EXPORT_END_DATE)),'-10-01') END))"
PROJECT,PROJECT_16,N,'PROJECT_ID IS NULL',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PROJECT_ID IS NULL"
PROJECT,PROJECT_17,N,'ORGANIZATION_ID IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'ORGANIZATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ORGANIZATION_ID IS NULL"
PROJECT,PROJECT_18,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_ID)>32"
PROJECT,PROJECT_19,N,'ORGANIZATION_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ORGANIZATION_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'ORGANIZATION_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ORGANIZATION_ID)>32"
PROJECT,PROJECT_20,N,'PROJECT_NAME EXCEEDS 200 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_NAME EXCEEDS 200 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_NAME EXCEEDS 200 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_NAME)>200"
PROJECT,PROJECT_21,N,'PROJECT_COMMON_NAME EXCEEDS 200 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_COMMON_NAME EXCEEDS 200 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_COMMON_NAME EXCEEDS 200 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_COMMON_NAME)>200"
PROJECT,PROJECT_22,N,'CONTINUUM_PROJECT IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CONTINUUM_PROJECT IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'CONTINUUM_PROJECT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(CONTINUUM_PROJECT) not like '%.00' and IS_INTEGER(CONTINUUM_PROJECT)=FALSE"
PROJECT,PROJECT_23,N,'PROJECT_TYPE IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_TYPE IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(PROJECT_TYPE) not like '%.00' and IS_INTEGER(PROJECT_TYPE)=FALSE"
PROJECT,PROJECT_24,N,'HOUSING_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HOUSING_TYPE IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'HOUSING_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(HOUSING_TYPE) not like '%.00' and IS_INTEGER(HOUSING_TYPE)=FALSE"
PROJECT,PROJECT_25,N,'RESIDENTIAL_AFFILIATION IS NOT AN INTEGER',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'RESIDENTIAL_AFFILIATION IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'RESIDENTIAL_AFFILIATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(RESIDENTIAL_AFFILIATION) not like '%.00' and IS_INTEGER(RESIDENTIAL_AFFILIATION)=FALSE"
PROJECT,PROJECT_26,N,'TARGET_POPULATION IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'TARGET_POPULATION IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'TARGET_POPULATION MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(TARGET_POPULATION) not like '%.00' and IS_INTEGER(TARGET_POPULATION)=FALSE"
PROJECT,PROJECT_27,N,'HOPWA_MED_ASSISTED_LIVING_FAC IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HOPWA_MED_ASSISTED_LIVING_FAC IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'HOPWA_MED_ASSISTED_LIVING_FAC MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(HOPWA_MED_ASSISTED_LIVING_FAC) not like '%.00' and IS_INTEGER(HOPWA_MED_ASSISTED_LIVING_FAC)=FALSE"
PROJECT,PROJECT_28,N,'PIT_COUNT IS NOT AN INTEGER',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PIT_COUNT IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PIT_COUNT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(PIT_COUNT) not like '%.00' and IS_INTEGER(PIT_COUNT)=FALSE"
PROJECT,PROJECT_29,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
PROJECT,PROJECT_30,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
PROJECT,PROJECT_31,N,'CONTINUUM_PROJECT NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME ,(case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, PROJECT_ID BUSINESS_KEY_VALUE,'CONTINUUM_PROJECT NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'CONTINUUM_PROJECT CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CONTINUUM_PROJECT = c.VALID_VALUES and c.List_Name = '1.10' WHERE c.VALID_VALUES IS NULL AND a.CONTINUUM_PROJECT IS NOT NULL"
PROJECT,PROJECT_32,N,'PROJECT_TYPE NOT IN HUD LIST',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME ,(case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, PROJECT_ID BUSINESS_KEY_VALUE,'PROJECT_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.PROJECT_TYPE = c.VALID_VALUES and c.List_Name = '2.02.6' WHERE c.VALID_VALUES IS NULL AND a.PROJECT_TYPE IS NOT NULL"
PROJECT,PROJECT_33,N,'HOUSING_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME ,(case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, PROJECT_ID BUSINESS_KEY_VALUE,'HOUSING_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'HOUSING_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HOUSING_TYPE = c.VALID_VALUES and c.List_Name = '2.02.D' WHERE c.VALID_VALUES IS NULL AND a.PROJECT_TYPE IS NOT NULL AND a.HOUSING_TYPE IS NOT NULL"
PROJECT,PROJECT_34,N,'RESIDENTIAL_AFFILIATION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME ,(case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, PROJECT_ID BUSINESS_KEY_VALUE,'RESIDENTIAL_AFFILIATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'RESIDENTIAL_AFFILIATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RESIDENTIAL_AFFILIATION = c.VALID_VALUES and c.List_Name = '1.10' WHERE c.VALID_VALUES IS NULL AND a.RESIDENTIAL_AFFILIATION IS NOT NULL"
PROJECT,PROJECT_35,N,'TARGET_POPULATION NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME ,(case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, PROJECT_ID BUSINESS_KEY_VALUE,'TARGET_POPULATION NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'TARGET_POPULATION CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TARGET_POPULATION = c.VALID_VALUES and c.List_Name = '2.02.7' WHERE c.VALID_VALUES IS NULL AND a.TARGET_POPULATION IS NOT NULL"
PROJECT,PROJECT_36,N,'HOPWA_MED_ASSISTED_LIVING_FAC NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME ,(case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, PROJECT_ID BUSINESS_KEY_VALUE,'HOPWA_MED_ASSISTED_LIVING_FAC NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'HOPWAMED_ASSISTED_LIVING_FAC CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 	LEFT JOIN STAGING.RT_HUD_LISTS c ON a.HOPWA_MED_ASSISTED_LIVING_FAC = c.VALID_VALUES and c.List_Name = '2.02.8' WHERE c.VALID_VALUES IS NULL AND a.HOPWA_MED_ASSISTED_LIVING_FAC IS NOT NULL"
PROJECT,PROJECT_37,N,'OPERATING_START_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'OPERATING_START_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR,	'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'OPERATING_START_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(OPERATING_START_DATE,1,10) NOT LIKE '%____-__-__%'"
PROJECT,PROJECT_38,N,'OPERATING_END_DATE NOT IN FORMAT YYYY-MM-DD ',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'OPERATING_END_DATE NOT IN FORMAT YYYY-MM-DD ' DESCR,	'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'OPERATING_END_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(OPERATING_END_DATE,1,10) NOT LIKE '%____-__-__%'"
PROJECT,PROJECT_39,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
PROJECT,PROJECT_40,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
PROJECT,PROJECT_41,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT' TABLE_NAME, (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,	'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
PROJECT,PROJECT_42,N,'PROJECT_ID IS NOT UNIQUE',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT' TABLE_NAME , (case when A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NOT UNIQUE' DESCR ,'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, DATE(OPERATING_END_DATE) ERROR_DATE_VALUE, 'PROJECT_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT PROJECT_ID, SOURCE_FILE FROM STAGING.PSTG_PROJECT GROUP BY PROJECT_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NOT NULL"
PROJECT_COC,PROJECT_COC_1,N,'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECT.CSV',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID DOES NOT MATCH A RECORD IN PROJECT.CSV' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'PROJECT_ID IS NULL OR DOES NOT MATCH PROJECT.CSV 'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NULL"
PROJECT_COC,PROJECT_COC_2,N,'COC_CODE IS NULL OR NOT FORMATTED PROPERLY',HIGH PRIORITY,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'COC_CODE IS NULL OR NOT FORMATTED PROPERLY' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'COC_CODE IS NULL OR NOT FORMATTED CORRECTLY' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join staging.pstg_project c on a.project_id = c.project_id and a.source_file = c.source_file WHERE NOT regexp_like(COC_CODE,'^[a-zA-Z]{2}-[[:digit:]]{3}$') OR COC_CODE IS NULL"
PROJECT_COC,PROJECT_COC_3,N,'GEOCODE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'GEOCODE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'GEOCODE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE GEOCODE IS NULL"
PROJECT_COC,PROJECT_COC_4,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE a.DATE_CREATED IS NULL"
PROJECT_COC,PROJECT_COC_5,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE A.DATE_UPDATED IS NULL"
PROJECT_COC,PROJECT_COC_6,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE A.USER_ID IS NULL"
PROJECT_COC,PROJECT_COC_7,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (CASE WHEN SRC.PROJECT_COC_ID||'|'||SRC.PROJECT_ID IS NULL THEN SRC.STG_MD5_HASH_VALUE ELSE SRC.PROJECT_COC_ID||'|'||SRC.PROJECT_ID END) AS BUSINESS_KEY_VALUE,OPERATING_END_DATE FROM STAGING.PSTG_PROJECT_COC SRC  join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON SRC.PROJECT_ID = C.PROJECT_ID AND SRC.SOURCE_FILE = C.SOURCE_FILE  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
PROJECT_COC,PROJECT_COC_8,N,'STATE NOT 2 LETTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME,(case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'STATE NOT 2 LETTERS' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'STATE NOT TWO LETTERS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NOT REGEXP_LIKE(STATE,'^[a-zA-Z]{2}$')"
PROJECT_COC,PROJECT_COC_9,N,'ZIP NOT 5 DIGITS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ZIP NOT 5 DIGITS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'ZIP NOT 5 DIGITS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE NOT REGEXP_LIKE(ZIP,'^[[:digit:]]{5}$')"
PROJECT_COC,PROJECT_COC_10,N,'PROJECT_COC_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_COC_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'PROJECT_COC_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE PROJECT_COC_ID IS NULL"
PROJECT_COC,PROJECT_COC_11,N,'PROJECT_ID IS NULL',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'PROJECT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE A.PROJECT_ID IS NULL"
PROJECT_COC,PROJECT_COC_12,N,'PROJECT_COC_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_COC_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'PROJECT_COC_ID EXCEEDS 32 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(PROJECT_COC_ID)>32"
PROJECT_COC,PROJECT_COC_13,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(A.PROJECT_ID)>32"
PROJECT_COC,PROJECT_COC_14,N,'COC_CODE EXCEEDS 6 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'COC_CODE EXCEEDS 6 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'COC_CODE EXCEEDS 6 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(COC_CODE)>6"
PROJECT_COC,PROJECT_COC_15,N,'GEOCODE EXCEEDS 6 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'GEOCODE EXCEEDS 6 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'GEOCODE EXCEEDS 6 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(GEOCODE)>6"
PROJECT_COC,PROJECT_COC_16,N,'ADDRESS_1 EXCEEDS 100 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ADDRESS_1 EXCEEDS 100 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'ADDRESS_1 EXCEEDS 100 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(ADDRESS_1)>100"
PROJECT_COC,PROJECT_COC_17,N,'ADDRESS_2 EXCEEDS 100 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ADDRESS_2 EXCEEDS 100 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'ADDRESS_2 EXCEEDS 100 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(ADDRESS_2)>100"
PROJECT_COC,PROJECT_COC_18,N,'CITY EXCEEDS 50 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CITY EXCEEDS 50 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'CITY EXCEEDS 50 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(CITY)>50"
PROJECT_COC,PROJECT_COC_19,N,'STATE EXCEEDS 2 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'STATE EXCEEDS 2 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'STATE EXCEEDS 2 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(STATE)>2"
PROJECT_COC,PROJECT_COC_20,N,'ZIP EXCEEDS 5 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ZIP EXCEEDS 5 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'ZIP EXCEEDS 5 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(ZIP)>5"
PROJECT_COC,PROJECT_COC_21,N,'GEOGRAPHY_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'GEOGRAPHY_TYPE IS NOT AN INTEGER' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'GEOGRAPHY_TYPE MUST BE AN INTEGER.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE to_char(GEOGRAPHY_TYPE) not like '%.00' and IS_INTEGER(GEOGRAPHY_TYPE)=FALSE"
PROJECT_COC,PROJECT_COC_22,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'USER_ID EXCEEDS 32 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(A.USER_ID)>32"
PROJECT_COC,PROJECT_COC_23,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS.'ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE LEN(A.EXPORT_ID)>32"
PROJECT_COC,PROJECT_COC_24,N,'GEOGRAPHY_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME ,(case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, A.PROJECT_COC_ID||'|'||A.PROJECT_ID BUSINESS_KEY_VALUE,'GEOGRAPHY_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'GEOGRAPHY_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.GEOGRAPHY_TYPE = c.VALID_VALUES and c.List_Name = '2.03.4' LEFT JOIN STAGING.PSTG_PROJECT D ON A.PROJECT_ID = D.PROJECT_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE c.VALID_VALUES IS NULL AND a.GEOGRAPHY_TYPE IS NOT NULL"
PROJECT_COC,PROJECT_COC_25,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT_COC' TABLE_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(A.DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(A.DATE_CREATED)<>19"
PROJECT_COC,PROJECT_COC_26,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT_COC' TABLE_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(A.DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(A.DATE_UPDATED)<>19"
PROJECT_COC,PROJECT_COC_27,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_PROJECT_COC' TABLE_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE SUBSTR(A.DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(A.DATE_DELETED)<>19"
PROJECT_COC,PROJECT_COC_28,N,'PROJECT_COC_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, a.EXPORT_ID, a.SOURCE_FILE, 'PSTG_PROJECT_COC' TABLE_NAME , (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_COC_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PROJECT_COC_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.PROJECT_COC_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_COC_ID IS NOT UNIQUE' DESCR , 'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE,'PROJECT_COC_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT_COC a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT PROJECT_COC_ID, SOURCE_FILE FROM STAGING.PSTG_PROJECT_COC GROUP BY PROJECT_COC_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.PROJECT_COC_ID = C.PROJECT_COC_ID AND A.SOURCE_FILE = C.SOURCE_FILE LEFT JOIN STAGING.PSTG_PROJECT D ON A.PROJECT_ID = D.PROJECT_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE C.PROJECT_COC_ID IS NOT NULL"
SERVICES,SERVICES_1,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
SERVICES,SERVICES_2,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
SERVICES,SERVICES_3,N,'DATE_PROVIDED IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_PROVIDED IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_PROVIDED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_PROVIDED IS NULL"
SERVICES,SERVICES_4,N,'RECORD_TYPE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'RECORD_TYPE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'RECORD_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE RECORD_TYPE IS NULL"
SERVICES,SERVICES_5,N,'TYPE_PROVIDED IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TYPE_PROVIDED IS NULL"
SERVICES,SERVICES_6,N,'OTHER_TYPE_PROVIDED IS NULL UNLESS RECORD_TYPE = 144 AND TYPE_PROVIDED = 6 OR RECORD_TYPE = 210 AND TYPE_PROVIDED = 12',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'OTHER_TYPE_PROVIDED IS NULL UNLESS RECORD_TYPE = 144 AND TYPE_PROVIDED = 6 OR RECORD_TYPE = 210 AND TYPE_PROVIDED = 12' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'OTHER_TYPE_PROVIDED IS NULL UNLESS RECORD_TYPE = 144 AND TYPE_PROVIDED = 6 OR RECORD_TYPE = 210 AND TYPE_PROVIDED = 12' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (OTHER_TYPE_PROVIDED IS NULL AND (RECORD_TYPE = 144 AND TYPE_PROVIDED = 6) OR (RECORD_TYPE = 210 AND TYPE_PROVIDED = 12))"
SERVICES,SERVICES_7,N,'MOVING_ON_OTHER_TYPE IS NULL UNLESS RECORD_TYPE = 300 AND TYPE_PROVIDED = 5',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'MOVING_ON_OTHER_TYPE IS NULL UNLESS RECORD_TYPE = 300 AND TYPE_PROVIDED = 5' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'MOVING_ON_OTHER_TYPE IS NULL UNLESS RECORD_TYPE = 300 AND TYPE_PROVIDED = 5' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (MOVING_ON_OTHER_TYPE IS NULL AND RECORD_TYPE = 300 AND TYPE_PROVIDED = 5) OR (MOVING_ON_OTHER_TYPE IS NOT NULL AND RECORD_TYPE <> 300 AND TYPE_PROVIDED <> 5)"
SERVICES,SERVICES_8,N,"'SUB_TYPE_PROVIDED IS NULL UNLESS RECORD_TYPE = 144 AND TYPE_PROVIDED IN (3,4,5)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SUB_TYPE_PROVIDED IS NULL UNLESS RECORD_TYPE = 144 AND TYPE_PROVIDED IN (3,4,5)' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SUB_TYPE_PROVIDED IS NULL UNLESS RECORD_TYPE = 144 AND TYPE_PROVIDED IN (3,4,5)' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (SUB_TYPE_PROVIDED IS NULL AND RECORD_TYPE = 144 AND TYPE_PROVIDED IN (3,4,5)) OR (SUB_TYPE_PROVIDED IS NOT NULL AND RECORD_TYPE <> 144 AND TYPE_PROVIDED NOT IN (3,4,5))"
SERVICES,SERVICES_9,N,"'FA_AMOUNT IS NULL UNLESS RECORD_TYPE IN (151,152)'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'FA_AMOUNT IS NULL UNLESS RECORD_TYPE IN (151,152)' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'FA_AMOUNT IS NULL UNLESS RECORD_TYPE IN (151,152)' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (FA_AMOUNT IS NULL AND RECORD_TYPE IN (151,152)) OR (FA_AMOUNT IS NOT NULL AND RECORD_TYPE NOT IN (151,152))"
SERVICES,SERVICES_10,N,'REFERRAL_OUTCOME IS NULL UNLESS RECORD_TYPE = 161',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'REFERRAL_OUTCOME IS NULL UNLESS RECORD_TYPE = 161' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'REFERRAL_OUTCOME IS NULL UNLESS RECORD_TYPE = 161' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (REFERRAL_OUTCOME IS NULL AND RECORD_TYPE = 161) OR (REFERRAL_OUTCOME IS NOT NULL AND RECORD_TYPE <> 161)"
SERVICES,SERVICES_11,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
SERVICES,SERVICES_12,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
SERVICES,SERVICES_13,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
SERVICES,SERVICES_14,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (CASE WHEN SERVICES_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||DATE_PROVIDED||'|'||RECORD_TYPE||'|'||TYPE_PROVIDED IS NULL THEN SRC.STG_MD5_HASH_VALUE ELSE SERVICES_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||DATE_PROVIDED||'|'||RECORD_TYPE||'|'||TYPE_PROVIDED END) AS BUSINESS_KEY_VALUE, SRC.DATE_PROVIDED FROM STAGING.PSTG_SERVICES SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
SERVICES,SERVICES_15,N,'SERVICES_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SERVICES_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SERVICES_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SERVICES_ID IS NULL"
SERVICES,SERVICES_16,N,'SERVICES_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SERVICES_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SERVICES_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(SERVICES_ID)>32"
SERVICES,SERVICES_17,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
SERVICES,SERVICES_18,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
SERVICES,SERVICES_19,N,'RECORD_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'RECORD_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'RECORD_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(RECORD_TYPE) not like '%.00' and IS_INTEGER(RECORD_TYPE)=FALSE"
SERVICES,SERVICES_20,N,'TYPE_PROVIDED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE to_char(TYPE_PROVIDED) not like '%.00' and IS_INTEGER(TYPE_PROVIDED)=FALSE"
SERVICES,SERVICES_21,N,'OTHER_TYPE_PROVIDED EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'OTHER_TYPE_PROVIDED EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'OTHER_TYPE_PROVIDED EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(OTHER_TYPE_PROVIDED)>50"
SERVICES,SERVICES_22,N,'MOVING_ON_OTHER_TYPE EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'MOVING_ON_OTHER_TYPE EXCEEDS 50 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'MOVING_ON_OTHER_TYPE EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(MOVING_ON_OTHER_TYPE)>50"
SERVICES,SERVICES_23,N,'SUB_TYPE_PROVIDED IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SUB_TYPE_PROVIDED IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SUB_TYPE_PROVIDED MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(SUB_TYPE_PROVIDED)=FALSE AND TO_CHAR(SUB_TYPE_PROVIDED) NOT LIKE '%.00'"
SERVICES,SERVICES_24,N,'REFERRAL_OUTCOME IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'REFERRAL_OUTCOME IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'REFERRAL_OUTCOME MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(REFERRAL_OUTCOME)=FALSE AND TO_CHAR(REFERRAL_OUTCOME) NOT LIKE '%.00'"
SERVICES,SERVICES_25,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
SERVICES,SERVICES_26,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
SERVICES,SERVICES_27,N,'RECORD_TYPE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'RECORD_TYPE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'RECORD_TYPE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.RECORD_TYPE = c.VALID_VALUES and c.List_Name = '1.4' WHERE c.VALID_VALUES IS NULL AND RECORD_TYPE IS NOT NULL"
SERVICES,SERVICES_28,N,'TYPE_PROVIDED NOT IN LIST P1.2 WHEN RECORD_TYPE = 141',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST P1.2 WHEN RECORD_TYPE = 141' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'P1.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 141 AND TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_29,N,'TYPE_PROVIDED NOT IN LIST R14.2 WHEN RECORD_TYPE = 142',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST R14.2 WHEN RECORD_TYPE = 142' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'R14.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 142 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_30,N,'TYPE_PROVIDED NOT IN LIST W1.2 WHEN RECORD_TYPE = 143',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST W1.2 WHEN RECORD_TYPE = 143' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'W1.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 143 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_31,N,'TYPE_PROVIDED NOT IN LIST V2.2 WHEN RECORD_TYPE = 144',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST V2.2 WHEN RECORD_TYPE = 144' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'V2.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 144 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_32,N,'TYPE_PROVIDED NOT IN LIST W2.2 WHEN RECORD_TYPE = 151',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST W2.2 WHEN RECORD_TYPE = 151' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'W2.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 151 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_33,N,'TYPE_PROVIDED NOT IN LIST V3.3 WHEN RECORD_TYPE = 152',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST V3.3 WHEN RECORD_TYPE = 152' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'V3.3' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 152 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_34,N,'TYPE_PROVIDED NOT IN LIST P2.2 WHEN RECORD_TYPE = 161',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST P2.2 WHEN RECORD_TYPE = 161' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'P2.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 161 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_35,N,'TYPE_PROVIDED NOT IN LIST 4.14 WHEN RECORD_TYPE = 200',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST 4.14 WHEN RECORD_TYPE = 200' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = '4.14' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 200 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_36,N,'TYPE_PROVIDED NOT IN LIST V8.2 WHEN RECORD_TYPE = 210',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST V8.2 WHEN RECORD_TYPE = 210' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'V8.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 210 AND a.TYPE_PROVIDED"
SERVICES,SERVICES_37,N,'TYPE_PROVIDED NOT IN LIST C2.2 WHEN RECORD_TYPE = 300',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'TYPE_PROVIDED NOT IN LIST C2.2 WHEN RECORD_TYPE = 300' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'C2.2' WHERE c.VALID_VALUES IS NULL AND a.RECORD_TYPE = 300 AND a.TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_38,N,'SUB_TYPE_PROVIDED NOT IN LIST V2.A WHEN TYPE_PROVIDED = 3',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SUB_TYPE_PROVIDED NOT IN LIST V2.A WHEN TYPE_PROVIDED = 3' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SUB_TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SUB_TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'V2.A' WHERE c.VALID_VALUES IS NULL AND a.TYPE_PROVIDED = 3 and a.SUB_TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_39,N,'SUB_TYPE_PROVIDED NOT IN LIST V2.B WHEN TYPE_PROVIDED = 4',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SUB_TYPE_PROVIDED NOT IN LIST V2.B WHEN TYPE_PROVIDED = 4' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SUB_TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SUB_TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'V2.B' WHERE c.VALID_VALUES IS NULL AND a.TYPE_PROVIDED = 4 AND a.SUB_TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_40,N,'SUB_TYPE_PROVIDED NOT IN LIST V2.C WHEN TYPE_PROVIDED = 5',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SUB_TYPE_PROVIDED NOT IN LIST V2.C WHEN TYPE_PROVIDED = 5' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SUB_TYPE_PROVIDED CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.SUB_TYPE_PROVIDED = c.VALID_VALUES and c.List_Name = 'V2.C' WHERE c.VALID_VALUES IS NULL AND a.TYPE_PROVIDED = 5 AND a.SUB_TYPE_PROVIDED IS NOT NULL"
SERVICES,SERVICES_41,N,'REFERRAL_OUTCOME NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME ,(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'REFERRAL_OUTCOME NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'REFERRAL_OUTCOME CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.REFERRAL_OUTCOME = c.VALID_VALUES and c.List_Name = 'P2.A' WHERE c.VALID_VALUES IS NULL AND a.REFERRAL_OUTCOME IS NOT NULL"
SERVICES,SERVICES_42,N,'DATE_PROVIDED NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_PROVIDED NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_PROVIDED NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_PROVIDED,1,10) NOT LIKE '%____-__-__%'"
SERVICES,SERVICES_43,N,'FA_START_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'FA_START_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'FA_START_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(FA_START_DATE,1,10) NOT LIKE '%____-__-__%'"
SERVICES,SERVICES_44,N,'FA_END_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'FA_END_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'FA_END_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(FA_END_DATE,1,10) NOT LIKE '%____-__-__%'"
SERVICES,SERVICES_45,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
SERVICES,SERVICES_46,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
SERVICES,SERVICES_47,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	(case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
SERVICES,SERVICES_48,N,'FA_AMOUNT NOT A NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'FA_AMOUNT NOT A NUMBER WITH TWO DECIMAL PLACES WITHOUT CURRENCY SYMBOLS OR COMMAS' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'FA_AMOUNT MUST BE A NUMBER WITH TWO DECIMAL PLACES' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE FA_AMOUNT IS NOT NULL AND (TRY_TO_NUMBER(FA_AMOUNT) IS NULL OR FA_AMOUNT NOT LIKE '%.__')"
SERVICES,SERVICES_49,N,'SERVICES_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE,'SERVICES_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE, 'SERVICES_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT SERVICES_ID, SOURCE_FILE FROM STAGING.PSTG_SERVICES GROUP BY SERVICES_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.SERVICES_ID = C.SERVICES_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.SERVICES_ID IS NOT NULL"
USER,USER_1,N,'USER_PHONE IS INCORRECTLY FORMATTED',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_PHONE IS INCORRECTLY FORMATTED' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_PHONE IS INCORRECTLY FORMATTED (10 DIGITS NO PUNCTUATION)' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE NOT REGEXP_LIKE(USER_PHONE,'^[[:digit:]]{10}$')"
USER,USER_2,N,'USER_EXTENSION IS INCORRECTLY FORMATTED',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_EXTENSION IS INCORRECTLY FORMATTED' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_EXTENSION NOT FORMATTED CORRECTLY (5 DIGITS NO PUNCTUATION)' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE NOT REGEXP_LIKE(USER_EXTENSION,'^[[:digit:]]{5}$')"
USER,USER_3,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
USER,USER_4,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
USER,USER_5,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (CASE WHEN USER_ID IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'USER_ID' END) BUSINESS_KEY_FIELD_NAME, (CASE WHEN USER_ID IS NULL THEN SRC.STG_MD5_HASH_VALUE ELSE USER_ID END) AS BUSINESS_KEY_VALUE FROM STAGING.PSTG_USER SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
USER,USER_6,N,'USER_EMAIL IS NOT VALID',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_EMAIL IS NOT VALID' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_EMAIL IS INVALID' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_EMAIL NOT LIKE '%_@__%.__%'"
USER,USER_7,N,'USER_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR , 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
USER,USER_8,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
USER,USER_9,N,'USER_FIRST_NAME EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_FIRST_NAME EXCEEDS 50 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_FIRST_NAME EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_FIRST_NAME)>50"
USER,USER_10,N,'USER_LAST_NAME EXCEEDS 50 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_LAST_NAME EXCEEDS 50 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_LAST_NAME EXCEEDS 50 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_LAST_NAME)>50"
USER,USER_11,N,'USER_PHONE EXCEEDS 10 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_PHONE EXCEEDS 10 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_PHONE EXCEEDS 10 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_PHONE)>10"
USER,USER_12,N,'USER_EXTENSION EXCEEDS 5 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_EXTENSION EXCEEDS 5 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_EXTENSION EXCEEDS 5 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_EXTENSION)>5"
USER,USER_13,N,'USER_EMAIL EXCEEDS 320 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_EMAIL EXCEEDS 320 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_EMAIL EXCEEDS 320 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_EMAIL)>320"
USER,USER_14,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
USER,USER_15,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_USER' TABLE_NAME, (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_USER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
USER,USER_16,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_USER' TABLE_NAME, (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_USER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
USER,USER_17,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_USER' TABLE_NAME, (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR,'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_USER A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
USER,USER_18,N,'USER_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_USER' TABLE_NAME , (case when A.USER_ID is null then 'STG_MD5_HASH_VALUE' else 'USER_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.USER_ID is null then A.STG_MD5_HASH_VALUE else A.USER_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NOT UNIQUE' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_USER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT USER_ID, SOURCE_FILE FROM STAGING.PSTG_USER GROUP BY USER_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.USER_ID = C.USER_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.USER_ID IS NOT NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_1,N,'MOST_RECENT_ED_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME ,(case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'MOST_RECENT_ED_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MOST_RECENT_ED_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.MOST_RECENT_ED_STATUS = c.VALID_VALUES and c.List_Name = 'C3.A' WHERE c.VALID_VALUES IS NULL AND a.MOST_RECENT_ED_STATUS IS NOT NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_2,N,'CURRENT_ED_STATUS NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME ,(case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENT_ED_STATUS NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_ED_STATUS CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CURRENT_ED_STATUS = c.VALID_VALUES and c.List_Name = 'C3.B' WHERE c.VALID_VALUES IS NULL AND a.CURRENT_ED_STATUS IS NOT NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_3,N,'DATA_COLLECTION_STAGE NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME ,(case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.DATA_COLLECTION_STAGE = c.VALID_VALUES and c.List_Name = '5.03.1' WHERE c.VALID_VALUES IS NULL AND a.DATA_COLLECTION_STAGE IS NOT NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_4,N,'CURRENT_SCHOOL_ATTEND NOT IN HUD LIST',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME ,(case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENT_SCHOOL_ATTEND NOT IN HUD LIST' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_SCHOOL_ATTEND CONTAINS INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS c ON a.CURRENT_SCHOOL_ATTEND = c.VALID_VALUES and c.List_Name = 'C3.2' WHERE c.VALID_VALUES IS NULL AND a.CURRENT_SCHOOL_ATTEND IS NOT NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_5,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_6,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_7,N,'INFORMATION_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INFORMATION_DATE IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_8,N,'MOST_RECENT_ED_STATUS IS NULL UNLESS CURRENT_SCHOOL_ATTEND = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'MOST_RECENT_ED_STATUS IS NULL UNLESS CURRENT_SCHOOL_ATTEND = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MostRecentEdStatus cannot be null when CurrentSchoolAttend = 0' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE MOST_RECENT_ED_STATUS IS NULL AND CURRENT_SCHOOL_ATTEND = 0 "
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_9,N,'CURRENT_ED_STATUS IS NULL UNLESS CURRENT_SCHOOL_ATTEND = 1 OR CURRENT_SCHOOL_ATTEND = 2',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENT_ED_STATUS IS NULL UNLESS CURRENT_SCHOOL_ATTEND = 1 OR CURRENT_SCHOOL_ATTEND = 2' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CurrentEdStatus cannot be null when CurrentSchoolAttend = 1 or 2.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CURRENT_ED_STATUS IS NULL AND CURRENT_SCHOOL_ATTEND IN (1,2) "
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_10,N,'DATA_COLLECTION_STAGE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATA_COLLECTION_STAGE IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_11,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_12,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_13,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_14,N,'YOUTH_EDUCATION_STATUS_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'YOUTH_EDUCATION_STATUS_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'YOUTH_EDUCATION_STATUS_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE YOUTH_EDUCATION_STATUS_ID IS NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_15,N,'YOUTH_EDUCATION_STATUS_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'YOUTH_EDUCATION_STATUS_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'YOUTH_EDUCATION_STATUS_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(YOUTH_EDUCATION_STATUS_ID)>32"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_16,N,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(ENROLLMENT_ID)>32"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_17,N,'PERSONAL_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PERSONAL_ID)>32"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_18,N,'CURRENT_SCHOOL_ATTEND IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENT_SCHOOL_ATTEND IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_SCHOOL_ATTEND MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CURRENT_SCHOOL_ATTEND)=FALSE AND TO_CHAR(CURRENT_SCHOOL_ATTEND) NOT LIKE '%.00'"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_19,N,'MOST_RECENT_ED_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'MOST_RECENT_ED_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'MOST_RECENT_ED_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(MOST_RECENT_ED_STATUS)=FALSE AND TO_CHAR(MOST_RECENT_ED_STATUS) NOT LIKE '%.00'"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_20,N,'CURRENT_ED_STATUS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENT_ED_STATUS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENT_ED_STATUS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CURRENT_ED_STATUS)=FALSE AND TO_CHAR(CURRENT_ED_STATUS) NOT LIKE '%.00'"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_21,N,'DATA_COLLECTION_STAGE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DATA_COLLECTION_STAGE)=FALSE AND TO_CHAR(DATA_COLLECTION_STAGE) NOT LIKE '%.00'"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_22,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_23,N,'EXPORT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EXPORT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EXPORT_ID EXCEEDS 32 CHARACTERS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(EXPORT_ID)>32"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_24,N,'YOUTH_EDUCATION_STATUS_ID IS NOT UNIQUE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'YOUTH_EDUCATION_STATUS_ID IS NOT UNIQUE' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'YOUTH_EDUCATION_STATUS_ID IS NOT UNIQUE' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN (SELECT YOUTH_EDUCATION_STATUS_ID, SOURCE_FILE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS GROUP BY YOUTH_EDUCATION_STATUS_ID, SOURCE_FILE HAVING COUNT(*)>1) C ON A.YOUTH_EDUCATION_STATUS_ID = C.YOUTH_EDUCATION_STATUS_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.YOUTH_EDUCATION_STATUS_ID IS NOT NULL"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_25,N,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, INFORMATION_DATE ERROR_DATE_VALUE, 'INFORMATION_DATE NOT IN FORMAT YYYY-MM-DD' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 WHERE INFORMATION_DATE NOT LIKE '%____-__-__%'"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_26,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_27,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_28,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.YOUTH_EDUCATION_STATUS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' ERROR_MESSAGE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_29,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (CASE WHEN YOUTH_EDUCATION_STATUS_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE IS NULL THEN SRC.STG_MD5_HASH_VALUE ELSE YOUTH_EDUCATION_STATUS_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE END) AS BUSINESS_KEY_VALUE, SRC.INFORMATION_DATE FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'YOUTH_EDUCATION_STATUS_ID||ENROLLMENT_ID||PERSONAL_ID||INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
HEALTH_AND_DV,HEALTH_AND_DV_29,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_30,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_31,N,'INFORMATION_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INFORMATION_DATE IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_32,N,'WHEN_OCCURRED IS NULL UNLESS DOMESTIC_VIOLENCE_SURVIVOR = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WHEN_OCCURRED IS NULL UNLESS DOMESTIC_VIOLENCE_SURVIVOR = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'WHEN_OCCURRED IS NULL UNLESS DOMESTIC_VIOLENCE_SURVIVOR = 1' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (WHEN_OCCURRED IS NULL AND DOMESTIC_VIOLENCE_SURVIVOR = 1) OR (WHEN_OCCURRED IS NOT NULL AND DOMESTIC_VIOLENCE_SURVIVOR <> 1)"
HEALTH_AND_DV,HEALTH_AND_DV_33,N,'CURRENTLY_FLEEING IS NULL UNLESS DOMESTIC_VIOLENCE_SURVIVOR = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENTLY_FLEEING IS NULL UNLESS DOMESTIC_VIOLENCE_SURVIVOR = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'CURRENTLY_FLEEING IS NULL UNLESS DOMESTIC_VIOLENCE_SURVIVOR = 1' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (CURRENTLY_FLEEING IS NULL AND DOMESTIC_VIOLENCE_SURVIVOR = 1) OR (CURRENTLY_FLEEING IS NOT NULL AND DOMESTIC_VIOLENCE_SURVIVOR <> 1)"
HEALTH_AND_DV,HEALTH_AND_DV_34,N,'DUE_DATE IS NULL UNLESS PREGNANCY_STATUS = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DUE_DATE IS NULL UNLESS PREGNANCY_STATUS = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DUE_DATE IS NULL UNLESS PREGNANCY_STATUS = 1' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (DUE_DATE IS NULL AND PREGNANCY_STATUS = 1) OR (DUE_DATE IS NOT NULL AND PREGNANCY_STATUS <> 1)"
HEALTH_AND_DV,HEALTH_AND_DV_35,N,'DATA_COLLECTION_STAGE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATA_COLLECTION_STAGE IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_36,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_37,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_38,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
HEALTH_AND_DV,HEALTH_AND_DV_39,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE is null then SRC.STG_MD5_HASH_VALUE else HEALTH_AND_DV_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE end) AS BUSINESS_KEY_VALUE, DATE(INFORMATION_DATE) AS ERROR_DATE_VALUE FROM STAGING.PSTG_HEALTH_AND_DV SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE) SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME ,  (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
HEALTH_AND_DV,HEALTH_AND_DV_40,N,"'DOMESTIC_VIOLENCE_SURVIVOR IN (8,9,99)'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DOMESTIC_VIOLENCE_SURVIVOR IN (8,9,99)' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DOMESTIC_VIOLENCE_SURVIVOR IN (8,9,99)"
HEALTH_AND_DV,HEALTH_AND_DV_41,N,"'WHEN_OCCURRED IN (8,9,99) AND DOMESTIC_VIOLENCE_SURVIVOR = 1'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WHEN_OCCURRED IN (8,9,99) AND DOMESTIC_VIOLENCE_SURVIVOR = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE WHEN_OCCURRED IN (8,9,99) AND DOMESTIC_VIOLENCE_SURVIVOR = 1"
HEALTH_AND_DV,HEALTH_AND_DV_42,N,"'CURRENTLY_FLEEING IN (8,9,99) AND DOMESTIC_VIOLENCE_SURVIVOR = 1'",,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HEALTH_AND_DV' TABLE_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.HEALTH_AND_DV_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CURRENTLY_FLEEING IN (8,9,99) AND DOMESTIC_VIOLENCE_SURVIVOR = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'Value is missing.' ERROR_MESSAGE FROM STAGING.PSTG_HEALTH_AND_DV a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CURRENTLY_FLEEING IN (8,9,99) AND DOMESTIC_VIOLENCE_SURVIVOR = 1"
INCOME_BENEFITS,INCOME_BENEFITS_127,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_128,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_129,N,'INFORMATION_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INFORMATION_DATE IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_130,N,'OTHER_INCOME_SOURCE_IDENTIFY IS NULL UNLESS OTHER_INCOME_SOURCE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INCOME_SOURCE_IDENTIFY IS NULL UNLESS OTHER_INCOME_SOURCE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_INCOME_SOURCE_IDENTIFY NULL UNLESS OTHER_INCOME_SOURCE = 1' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (OTHER_INCOME_SOURCE_IDENTIFY IS NULL AND OTHER_INCOME_SOURCE =1) OR (OTHER_INCOME_SOURCE_IDENTIFY IS NOT NULL AND OTHER_INCOME_SOURCE <> 1)"
INCOME_BENEFITS,INCOME_BENEFITS_131,N,'OTHER_BENEFITS_SOURCE_IDENTIFY IS NULL UNLESS OTHER_BENEFITS_SOURCE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_BENEFITS_SOURCE_IDENTIFY IS NULL UNLESS OTHER_BENEFITS_SOURCE = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'OTHER_BENEFITS_SOURCE_IDENTIFY NULL UNLESS OTHER_BENEFITS_SOURCE = 1' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE OTHER_BENEFITS_SOURCE_IDENTIFY IS NULL AND OTHER_BENEFITS_SOURCE = 1"
INCOME_BENEFITS,INCOME_BENEFITS_132,N,NO_MEDICAID_REASON IS NULL UNLESS MEDICAID = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_MEDICAID_REASON IS NULL UNLESS MEDICAID = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if Medicaid is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_MEDICAID_REASON IS NULL AND MEDICAID = 0) OR (NO_MEDICAID_REASON IS NOT NULL AND MEDICAID <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_133,N,'NO_MEDICARE_REASON IS NULL UNLESS MEDICARE = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_MEDICARE_REASON IS NULL UNLESS MEDICARE = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if Medicare is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_MEDICARE_REASON IS NULL AND MEDICARE = 0) OR (NO_MEDICARE_REASON IS NOT NULL AND MEDICARE <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_134,N,'NO_SCHIP_REASON IS NULL UNLESS SCHIP = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_SCHIP_REASON IS NULL UNLESS SCHIP = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if SCHIP is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_SCHIP_REASON IS NULL AND SCHIP = 0) OR (NO_SCHIP_REASON IS NOT NULL AND SCHIP <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_135,N,'NO_VHA_REASON_HA IS NULL UNLESS VHA_SERVICES_HA = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_VHA_REASON_HA IS NULL UNLESS VHA_SERVICES_HA = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if VHA Services is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_VHA_REASON IS NULL AND VHA_SERVICES = 0) OR (NO_VHA_REASON IS NOT NULL AND VHA_SERVICES <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_136,N,'NO_EMPLOYER_PROVIDED_REASON IS NULL UNLESS EMPLOYER_PROVIDED = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_EMPLOYER_PROVIDED_REASON IS NULL UNLESS EMPLOYER_PROVIDED = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if employer-provided insurance is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_EMPLOYER_PROVIDED_REASON IS NULL AND EMPLOYER_PROVIDED = 0) OR (NO_EMPLOYER_PROVIDED_REASON IS NOT NULL AND EMPLOYER_PROVIDED <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_137,N,'NO_COBRA_REASON IS NULL UNLESS COBRA = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'For HUD HOPWA funding sources, a reason must be provided if COBRA insurance is not selected. If selected, do not provide a reason.' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_COBRA_REASON NULL UNLESS COBRA = 0' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE D.FUNDER IN (13,14,15,16,17,18,19) AND ((NO_COBRA_REASON IS NULL AND COBRA = 0) OR (NO_COBRA_REASON IS NOT NULL AND COBRA <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_138,N,'NO_PRIVATE_PAY_REASON IS NULL UNLESS PRIVATE_PAY = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'For HUD HOPWA funding sources, a reason must be provided if private pay is not selected. If selected, do not provide a reason.' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_PRIVATE_PAY_REASON NULL UNLESS PRIVATE_PAY = 0' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE  D.FUNDER IN (13,14,15,16,17,18,19) AND ((NO_PRIVATE_PAY_REASON IS NULL AND PRIVATE_PAY = 0) OR (NO_PRIVATE_PAY_REASON IS NOT NULL AND PRIVATE_PAY <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_139,N,NO_STATE_HEALTH_INS_REASON IS NULL UNLESS STATE_HEALTH_INS = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_STATE_HEALTH_INS_REASON IS NULL UNLESS STATE_HEALTH_INS = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if state health insurance is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_STATE_HEALTH_INS_REASON IS NULL AND STATE_HEALTH_INS = 0) OR (NO_STATE_HEALTH_INS_REASON IS NOT NULL AND STATE_HEALTH_INS <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_140,N,'NO_INDIAN_HEALTH_SERVICES_REASON IS NULL UNLESS INDIAN_HEALTH_SERVICES = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_INDIAN_HEALTH_SERVICES_REASON IS NULL UNLESS INDIAN_HEALTH_SERVICES = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if Indian Health Services is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_INDIAN_HEALTH_SERVICES_REASON IS NULL AND INDIAN_HEALTH_SERVICES = 0) OR (NO_INDIAN_HEALTH_SERVICES_REASON IS NOT NULL AND INDIAN_HEALTH_SERVICES <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_141,N,'OTHER_INSURANCE_IDENTIFY IS NULL UNLESS OTHER_INSURANCE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INSURANCE_IDENTIFY IS NULL UNLESS OTHER_INSURANCE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, identify other insurance if it is selected. If other insurance is not selected, do not provide an identification.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((OTHER_INSURANCE_IDENTIFY IS NULL AND OTHER_INSURANCE = 1) OR (OTHER_INSURANCE_IDENTIFY IS NOT NULL AND OTHER_INSURANCE <>1))"
INCOME_BENEFITS,INCOME_BENEFITS_142,N,'NO_ADAP_REASON IS NULL UNLESS ADAP = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'For HUD HOPWA funding sources, a reason must be provided if ADAP is not selected. If selected, do not provide a reason.' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NO_ADAP_REASON NULL UNLESS ADAP = 0' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE D.FUNDER IN (13,14,15,16,17,18,19) AND ((NO_ADAP_REASON IS NULL AND ADAP = 0) OR (NO_ADAP_REASON IS NOT NULL AND ADAP <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_143,N,'NO_RYAN_WHITE_REASON IS NULL UNLESS RYAN_WHITE_MED_DENT = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NO_RYAN_WHITE_REASON IS NULL UNLESS RYAN_WHITE_MED_DENT = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'For HUD HOPWA funding sources, a reason must be provided if RyanWhiteMedDent is not selected. If selected, do not provide a reason.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_FUNDER D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE WHERE FUNDER IN (13,14,15,16,17,18,19) AND ((NO_RYAN_WHITE_REASON IS NULL AND RYAN_WHITE_MED_DENT = 0) OR (NO_RYAN_WHITE_REASON IS NOT NULL AND RYAN_WHITE_MED_DENT <> 0))"
INCOME_BENEFITS,INCOME_BENEFITS_144,N,'DATA_COLLECTION_STAGE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATA_COLLECTION_STAGE IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_145,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_146,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_147,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
INCOME_BENEFITS,INCOME_BENEFITS_148,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,1,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then SRC.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) AS BUSINESS_KEY_VALUE, DATE(INFORMATION_DATE) AS ERROR_DATE_VALUE FROM STAGING.PSTG_INCOME_BENEFITS SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME , (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
INCOME_BENEFITS,INCOME_BENEFITS_149,N,'INCOME_FROM_ANY_SOURCE = 1 AND NO SOURCE IS POPULATED',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INCOME_FROM_ANY_SOURCE = 1 AND NO SOURCE IS POPULATED' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated that the client has received income, but no source is identified.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INCOME_FROM_ANY_SOURCE = 1 AND (EARNED IS NULL OR EARNED IN (0,99)) AND (UNEMPLOYMENT IS NULL OR UNEMPLOYMENT IN (0,99)) AND (SSI IS NULL OR SSI IN (0,99)) AND (SSDI IS NULL OR SSDI IN (0,99)) AND (VA_DISABILITY_SERVICE IS NULL OR VA_DISABILITY_SERVICE IN (0,99)) AND (VA_DISABILITY_NON_SERVICE IS NULL OR VA_DISABILITY_NON_SERVICE IN (0,99)) AND (PRIVATE_DISABILITY IS NULL OR PRIVATE_DISABILITY IN (0,99)) AND (WORKERS_COMP IS NULL OR WORKERS_COMP IN (0,99)) AND (TANF IS NULL OR TANF IN (0,99)) AND (GA IS NULL OR GA IN (0,99)) AND (SOC_SEC_RETIREMENT IS NULL OR SOC_SEC_RETIREMENT IN (0,99)) AND (PENSION IS NULL OR PENSION IN (0,99)) AND (CHILD_SUPPORT IS NULL OR CHILD_SUPPORT IN (0,99)) AND (ALIMONY IS NULL OR ALIMONY IN (0,99)) AND (OTHER_INCOME_SOURCE IS NULL OR OTHER_INCOME_SOURCE IN (0,99))"
INCOME_BENEFITS,INCOME_BENEFITS_150,N,'EARNED_AMOUNT IS NULL OR <= 0 IF EARNED = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EARNED_AMOUNT IS NULL OR <= 0 IF EARNED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE EARNED = 1 AND (EARNED_AMOUNT IS NULL OR TO_DECIMAL(EARNED_AMOUNT,38,2) <=0) "
INCOME_BENEFITS,INCOME_BENEFITS_151,N,'UNEMPLOYMENT_AMOUNT IS NULL OR <= 0 IF UNEMPLOYMENT = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'UNEMPLOYMENT_AMOUNT IS NULL OR <= 0 IF UNEMPLOYMENT = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE UNEMPLOYMENT = 1 AND (UNEMPLOYMENT_AMOUNT IS NULL OR TO_DECIMAL(UNEMPLOYMENT_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_152,N,'SSI_AMOUNT IS NULL OR <= 0 IF SSI = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SSI_AMOUNT IS NULL OR <= 0 IF SSI = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SSI = 1 AND (SSI_AMOUNT IS NULL OR TO_DECIMAL(SSI_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_153,N,'SSDI_AMOUNT IS NULL OR <= 0 IF SSDI = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SSDI_AMOUNT IS NULL OR <= 0 IF SSDI = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SSDI= 1 AND (SSDI_AMOUNT IS NULL OR TO_DECIMAL(SSDI_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_154,N,'VA_DISABILITY_SERVICE_AMOUNT IS NULL OR <= 0 IF VA_DISABILITY_SERVICE = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VA_DISABILITY_SERVICE_AMOUNT IS NULL OR <= 0 IF VA_DISABILITY_SERVICE = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE VA_DISABILITY_SERVICE = 1 AND (VA_DISABILITY_SERVICE_AMOUNT IS NULL OR TO_DECIMAL(VA_DISABILITY_SERVICE_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_155,N,'VA_DISABILITY_NON_SERVICE_AMOUNT IS NULL OR <= 0 IF VA_DISABILITY_NON_SERVICE = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'VA_DISABILITY_NON_SERVICE_AMOUNT IS NULL OR <= 0 IF VA_DISABILITY_NON_SERVICE = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE VA_DISABILITY_NON_SERVICE = 1 AND (VA_DISABILITY_NON_SERVICE_AMOUNT IS NULL OR TO_DECIMAL(VA_DISABILITY_NON_SERVICE_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_156,N,'PRIVATE_DISABILITY_AMOUNT IS NULL OR <= 0 IF PRIVATE_DISABILITY = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PRIVATE_DISABILITY_AMOUNT IS NULL OR <= 0 IF PRIVATE_DISABILITY = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PRIVATE_DISABILITY = 1 AND (PRIVATE_DISABILITY_AMOUNT IS NULL OR TO_DECIMAL(PRIVATE_DISABILITY_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_157,N,'WORKERS_COMP_AMOUNT IS NULL OR <= 0 IF WORKERS_COMP = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'WORKERS_COMP_AMOUNT IS NULL OR <= 0 IF WORKERS_COMP = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE WORKERS_COMP = 1 AND (WORKERS_COMP_AMOUNT IS NULL OR TO_DECIMAL(WORKERS_COMP_AMOUNT,38,2) <=0) "
INCOME_BENEFITS,INCOME_BENEFITS_158,N,'TANF_AMOUNT IS NULL OR <= 0 IF TANF = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'TANF_AMOUNT IS NULL OR <= 0 IF TANF = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TANF = 1 AND (TANF_AMOUNT IS NULL OR TO_DECIMAL(TANF_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_159,N,'GA_AMOUNT IS NULL OR <= 0 IF GA = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'GA_AMOUNT IS NULL OR <= 0 IF GA = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE GA = 1 AND (GA_AMOUNT IS NULL OR TO_DECIMAL(GA_AMOUNT,38,2) <=0) "
INCOME_BENEFITS,INCOME_BENEFITS_160,N,'SOC_SEC_RETIREMENT_AMOUNT IS NULL OR <= 0 IF SOC_SEC_RETIREMENT = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'SOC_SEC_RETIREMENT_AMOUNT IS NULL OR <= 0 IF SOC_SEC_RETIREMENT = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SOC_SEC_RETIREMENT = 1 AND (SOC_SEC_RETIREMENT_AMOUNT IS NULL OR TO_DECIMAL(SOC_SEC_RETIREMENT_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_161,N,'PENSION_AMOUNT IS NULL OR <= 0 IF PENSION = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PENSION_AMOUNT IS NULL OR <= 0 IF PENSION = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PENSION = 1 AND (PENSION_AMOUNT IS NULL OR TO_DECIMAL(PENSION_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_162,N,'CHILD_SUPPORT_AMOUNT IS NULL OR <= 0 IF CHILD_SUPPORT = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'CHILD_SUPPORT_AMOUNT IS NULL OR <= 0 IF CHILD_SUPPORT = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE CHILD_SUPPORT = 1 AND (CHILD_SUPPORT_AMOUNT IS NULL OR TO_DECIMAL(CHILD_SUPPORT_AMOUNT,38,2) <=0) "
INCOME_BENEFITS,INCOME_BENEFITS_163,N,'ALIMONY_AMOUNT IS NULL OR <= 0 IF ALIMONY = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ALIMONY_AMOUNT IS NULL OR <= 0 IF ALIMONY = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ALIMONY = 1 AND (ALIMONY_AMOUNT IS NULL OR TO_DECIMAL(ALIMONY_AMOUNT,38,2) <=0) "
INCOME_BENEFITS,INCOME_BENEFITS_164,N,'OTHER_INCOME_AMOUNT IS NULL OR <= 0 IF OTHER_INCOME = 1',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'OTHER_INCOME_AMOUNT IS NULL OR <= 0 IF OTHER_INCOME = 1' DESCR,'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated an income source without providing an amount.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE OTHER_INCOME_SOURCE = 1 AND (OTHER_INCOME_AMOUNT IS NULL OR TO_DECIMAL(OTHER_INCOME_AMOUNT,38,2) <=0)"
INCOME_BENEFITS,INCOME_BENEFITS_165,N,'BENEFITS_FROM_ANY_SOURCE = 1 AND NO SOURCE IS POPULATED',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INCOME_BENEFITS' TABLE_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.INCOME_BENEFITS_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'BENEFITS_FROM_ANY_SOURCE = 1 AND NO SOURCE IS POPULATED' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'This record has indicated that the client has received benefits, but no source is identified.' ERROR_MESSAGE FROM STAGING.PSTG_INCOME_BENEFITS a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE BENEFITS_FROM_ANY_SOURCE = 1 AND (SNAP IS NULL OR SNAP in (0,99)) AND (WIC is null or WIC in (0,99)) AND (TANF_CHILD_CARE is null or TANF_CHILD_CARE in (0,99)) AND (TANF_TRANSPORTATION is null or TANF_TRANSPORTATION in (0,99)) AND (OTHER_TANF is null or OTHER_TANF in (0,99)) AND (OTHER_BENEFITS_SOURCE is null or OTHER_BENEFITS_SOURCE in (0,99))"
ENROLLMENT,ENROLLMENT_145,N,"'MAX INFORMATION_DATE > 60 DAYS PRIOR TO EXIT_DATE OR EXPORT_END_DATE FOR PROJECT_TYPE IN (4,6,7,11,14)'",,WARNING,1,1,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED, F.EXPORT_ID, F.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then F.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MAX INFORMATION_DATE > 60 DAYS PRIOR TO EXIT_DATE OR EXPORT_END_DATE FOR PROJECT_TYPE IN (4,6,7,11,14)' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(F.ENTRY_DATE) ERROR_DATE_VALUE,'The most recent current living situation record for this enrollment is more than 60 days prior to the enrollment end date.' ERROR_MESSAGE FROM (select max(DATE(INFORMATION_DATE)) as MAX_INFORMATION_DATE, ENROLLMENT_ID, SOURCE_FILE FROM STAGING.PSTG_CURRENT_LIVING_SITUATION  GROUP BY ENROLLMENT_ID, SOURCE_FILE) a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  JOIN STAGING.PSTG_ENROLLMENT F ON A.ENROLLMENT_ID = F.ENROLLMENT_ID AND A.SOURCE_FILE = F.SOURCE_FILE  JOIN STAGING.PSTG_PROJECT c ON F.PROJECT_ID = C.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE  JOIN STAGING.PSTG_EXIT d ON a.ENROLLMENT_ID = d.ENROLLMENT_ID and a.SOURCE_FILE = d.SOURCE_FILE  JOIN STAGING.PSTG_EXPORT e ON F.EXPORT_ID = e.EXPORT_ID and F.SOURCE_FILE = e.SOURCE_FILE  WHERE c.PROJECT_TYPE in (4,6,7,11,14) AND (DATEDIFF(day,a.MAX_INFORMATION_DATE,DATE(d.EXIT_DATE)) > 60  OR (DATE(d.EXIT_DATE) IS NULL AND DATEDIFF(day,a.MAX_INFORMATION_DATE,DATE(e.EXPORT_END_DATE))>60))"
AFFILIATION,AFFILIATION_17,N,"'RES_PROJECT_ID DOES NOT MATCH A RECORD IN PROJECT.CSV WHERE PROJECT_TYPE = 1, 2, 3, 8, 10 OR 13. IF PROJECT_TYPE = 13, RRH_SUB_TYPE MUST BE 2.'",,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||A.PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID is null then A.STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'RES_PROJECT_ID DOES NOT MATCH A RECORD IN PROJECT.CSV WHERE PROJECT_TYPE = 1, 2, 3, 8, 10 OR 13. IF PROJECT_TYPE = 13, RRH_SUB_TYPE MUST BE 2.' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ResProjectID must match a record in Project.csv where ProjectType = 1,2,3,8,10, or 13. If ProjectType = 13, RRHSubType must be 2.' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT c ON a.RES_PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE WHERE (c.PROJECT_ID IS NULL AND c.PROJECT_TYPE IN (1,2,3,8)) OR (c.PROJECT_ID IS NOT NULL AND c.PROJECT_TYPE=13 AND c.RRH_SUB_TYPE <> 2)"
AFFILIATION,AFFILIATION_18,N,'PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV WHERE (PROJECT_TYPE = 6) OR (PROJECT_TYPE = 13 AND RRH_SUB_TYPE = 1)',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_AFFILIATION' TABLE_NAME , (case when AFFILIATION_ID||'|'||A.PROJECT_ID||'|'||RES_PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID is null then A.STG_MD5_HASH_VALUE else AFFILIATION_ID||a.PROJECT_ID||RES_PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV WHERE (PROJECT_TYPE = 6) OR (PROJECT_TYPE = 13 AND RRH_SUB_TYPE = 1)' DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ProjectID must match a ProjectID in Project.csv where ProjectType = 6 or ProjectType =13 AND RRHSubType = 1' ERROR_MESSAGE FROM STAGING.PSTG_AFFILIATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT c ON a.PROJECT_ID = c.PROJECT_ID and a.SOURCE_FILE = c.SOURCE_FILE WHERE (c.PROJECT_ID IS NULL AND c.PROJECT_TYPE=6) OR (c.PROJECT_ID IS NULL AND c.PROJECT_TYPE=13 AND c.RRH_SUB_TYPE = 1)"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_24,N,'NOT_EMPLOYED_REASON NULL UNLESS EMPLOYED = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'NOT_EMPLOYED_REASON NULL UNLESS EMPLOYED = 0' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NotEmployedReason cannot be null if Employed = 0.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (NOT_EMPLOYED_REASON IS NULL AND EMPLOYED = 0) OR (NOT_EMPLOYED_REASON IS NOT NULL AND EMPLOYED <> 0)"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_25,N,'EMPLOYMENT_TYPE NULL UNLESS EMPLOYED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,(case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE BUSINESS_KEY_VALUE,'EMPLOYMENT_TYPE NULL UNLESS EMPLOYED = 1' DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EmploymentType cannot be null if Employed = 1.' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (EMPLOYMENT_TYPE IS NULL AND EMPLOYED = 1) OR (EMPLOYMENT_TYPE IS NOT NULL AND EMPLOYED <> 1)"
ENROLLMENT,ENROLLMENT_146,N,'ENTRY_DATE IS PAST OPERATING_END_DATE',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENTRY_DATE IS PAST OPERATING_END_DATE' DESCR, 'ERROR' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENTRY DATE IS PAST OPERATING END DATE' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 LEFT OUTER JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DATE(A.ENTRY_DATE) > DATE(C.OPERATING_END_DATE)"
ENROLLMENT,ENROLLMENT_147,N,'ENTRY_DATE IS PAST EXIT_DATE',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENTRY_DATE IS PAST EXIT_DATE' DESCR, 'ERROR' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENTRY DATE IS PAST EXIT DATE' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 JOIN STAGING.PSTG_EXIT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DATE(A.ENTRY_DATE) > DATE(C.EXIT_DATE)"
CLIENT,CLIENT_125,N,'DOB MORE THAN 100 YEARS BEFORE ENROLLMENT',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DOB MORE THAN 100 YEARS BEFORE ENROLLMENT' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE OF BIRTH MORE THAN 100 YEARS BEFORE ENROLLMENT. AGE SET TO BE UNKNOWN' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 INNER JOIN STAGING.PSTG_ENROLLMENT C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) D ON A.PERSONAL_ID = D.PERSONAL_ID AND A.SOURCE_FILE = D.SOURCE_FILE WHERE A.DOB IS NOT NULL AND SUBSTR(DOB,1,10) LIKE '%____-__-__%' AND datediff('year',DATE(A.DOB), DATE(C.ENTRY_DATE))>=100"
CLIENT,CLIENT_126,N,'DOB IN FUTURE',HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CLIENT' TABLE_NAME, (case when A.PERSONAL_ID is null then 'STG_MD5_HASH_VALUE' else 'PERSONAL_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.PERSONAL_ID is null then A.STG_MD5_HASH_VALUE else A.PERSONAL_ID end) BUSINESS_KEY_VALUE,'DOB IN FUTURE' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, EXIT_DATE ERROR_DATE_VALUE, 'DATE OF BIRTH IS IN THE FUTURE' ERROR_MESSAGE FROM STAGING.PSTG_CLIENT a join staging.rt_coc_control b on a.source_file = b.source_file and B.RUN_IND = 1 LEFT JOIN (SELECT MAX(EXIT_DATE) EXIT_DATE, PERSONAL_ID, SOURCE_FILE FROM STAGING.PSTG_EXIT GROUP BY PERSONAL_ID, SOURCE_FILE) C ON A.PERSONAL_ID = C.PERSONAL_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE DATE(DOB) > CURRENT_DATE"
ENROLLMENT,ENROLLMENT_148,N,'ENROLLMENT VALIDATION - MORE THAN ONE PERSONAL ID WITH HOH=1 AND HOUSEHOLD_ID',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT VALIDATION - MORE THAN ONE PERSONAL ID WITH HOH=1 AND HOUSEHOLD_ID' DESCR ,'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE,'MORE THAN ONE PERSONAL_ID WITH RELATIONSHIP_TO_HOH = 1 FOR HOUSEHOLD_ID' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL C ON A.SOURCE_FILE = C.SOURCE_FILE AND C.RUN_IND = 1 WHERE A.RELATIONSHIP_TO_HOH = 1 AND EXISTS (SELECT 1 FROM STAGING.PSTG_ENROLLMENT B WHERE A.SOURCE_FILE = B.SOURCE_FILE AND A.HOUSEHOLD_ID = B.HOUSEHOLD_ID  AND B.RELATIONSHIP_TO_HOH = 1 AND A.PERSONAL_ID <> B.PERSONAL_ID)"
ENROLLMENT,ENROLLMENT_149,N,'ENROLLMENT VALIDATION - RECORD INCLUDED AS PART OF CA-515',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, B.EXPORT_ID, B.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT VALIDATION - RECORD INCLUDED AS PART OF CA-515' DESCR, 'ERROR' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(A.ENTRY_DATE) ERROR_DATE_VALUE, 'THIS RECORD IS INCLUDED AS PART OF CA-515' ERROR_MESSAGE from (select a.*, b.coc_code from staging.PSTG_ENROLLMENT a left outer join staging.PSTG_ENROLLMENT_coc b on a.enrollment_id = b.enrollment_id and a.source_file = b.source_file where b.data_collection_stage = 1 or  b.data_collection_stage is null) a inner join (select a.*, b.coc_code from staging.PSTG_ENROLLMENT a left outer join staging.PSTG_ENROLLMENT_coc b on a.enrollment_id = b.enrollment_id and  a.source_file = b.source_file where b.data_collection_stage = 1 or b.data_collection_stage is null) b on a.enrollment_id = b.enrollment_id  and a.entry_date = b.entry_date and a.personal_id = b.personal_id and a.project_id = b.project_id and  (a.coc_code = b.coc_code or b.coc_code is null) where a.source_file = 'CA-515' and b.source_file = 'CA-531';"
ENROLLMENT,ENROLLMENT_150,N,'PERSON WITH MORE THAN ONE RELATIONSHIP TO HOH',,WARNING,1,0,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID ,A.SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'PERSON WITH MORE THAN ONE RELATIONSHIP TO HOH' DESCR,'WARNING' ERROR_LEVEL,'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'PERSON WITH MORE THAN ONE RELATIONSHIP TO HOH' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 WHERE EXISTS (SELECT 1 FROM STAGING.PSTG_ENROLLMENT C WHERE A.PERSONAL_ID = C.PERSONAL_ID AND A.HOUSEHOLD_ID = C.HOUSEHOLD_ID AND A.SOURCE_FILE = C.SOURCE_FILE  AND A.RELATIONSHIP_TO_HOH <> C.RELATIONSHIP_TO_HOH)"
ENROLLMENT,ENROLLMENT_151,N,'ENROLLMENT VALIDATION - CLIENT RECORD DOES NOT EXIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID ,A.SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'ENROLLMENT VALIDATION - CLIENT RECORD DOES NOT EXIST' DESCR ,'WARNING' ERROR_LEVEL ,'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'NO MATCHING CLIENT RECORD FOR THIS ENROLLMENT' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL C ON A.SOURCE_FILE = C.SOURCE_FILE AND C.RUN_IND = 1 LEFT OUTER JOIN STAGING.PSTG_CLIENT B ON A.PERSONAL_ID = B.PERSONAL_ID AND A.SOURCE_FILE = B.SOURCE_FILE WHERE B.PERSONAL_ID IS NULL"
ENROLLMENT,ENROLLMENT_152,N,'ENROLLMENT VALIDATION - NO HEAD OF HOUSEHOLD',,WARNING,1,0,1,"SELECT DISTINCT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID,A.SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'ENROLLMENT VALIDATION - NO HEAD OF HOUSEHOLD' DESCR ,'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE,'NO INDIVIDUAL IDENTIFIED AS HEAD OF HOUSEHOLD' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL C ON A.SOURCE_FILE = C.SOURCE_FILE AND C.RUN_IND = 1 WHERE NOT EXISTS (SELECT 1 FROM STAGING.PSTG_ENROLLMENT B WHERE A.HOUSEHOLD_ID = B.HOUSEHOLD_ID AND A.SOURCE_FILE = B.SOURCE_FILE AND B.RELATIONSHIP_TO_HOH = 1)"
ENROLLMENT,ENROLLMENT_153,N,'ENROLLMENT VALIDATION - ENTRY_DATE IS EARLIER THAN PROJECT START DATE',,WARNING,1,1,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID ,A.SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'ENROLLMENT VALIDATION - ENTRY_DATE IS EARLIER THAN PROJECT START DATE' DESCR ,'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE,'ENTRY DATE IS EARLIER THAN PROJECT START DATE' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL C ON A.SOURCE_FILE = C.SOURCE_FILE AND C.RUN_IND = 1 INNER JOIN STAGING.PSTG_PROJECT B ON A.PROJECT_ID = B.PROJECT_ID AND A.SOURCE_FILE = B.SOURCE_FILE WHERE DATE(A.ENTRY_DATE) < DATE(B.OPERATING_START_DATE)"
ENROLLMENT,ENROLLMENT_154,N,'ENROLLMENT VALIDATION - MOVE IN DATE IS EARLIER THAN ENTRY DATE',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID ,A. SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'ENROLLMENT VALIDATION - MOVE IN DATE IS EARLIER THAN ENTRY DATE' DESCR ,'WARNING' ERROR_LEVEL ,'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MOVE IN DATE IS EARLIER THAN ENTRY DATE' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 WHERE DATE(MOVE_IN_DATE) < DATE(ENTRY_DATE)"
PROJECT,PROJECT_43,N,'COC SUBMITTED FIVE OR FEWER PROJECTS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID ,A.SOURCE_FILE ,'PSTG_PROJECT' TABLE_NAME ,'SOURCE_FILE' BUSINESS_KEY_FIELD_NAME ,A.SOURCE_FILE BUSINESS_KEY_VALUE ,'COC SUBMITTED FIVE OR FEWER PROJECTS' DESCR ,'WARNING' ERROR_LEVEL, 'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME, OPERATING_END_DATE ERROR_DATE_VALUE, 'COC SUBMITTED FIVE OR FEWER PROJECTS' ERROR_MESSAGE FROM STAGING.PSTG_PROJECT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 WHERE (SELECT COUNT(DISTINCT PROJECT_ID) FROM STAGING.PSTG_PROJECT C WHERE C.SOURCE_FILE = A.SOURCE_FILE) <=5"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_1,N,'PROJECT_ID IS NULL OR DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_2,N,'HMIS_PARTICIPATION_TYPE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_TYPE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE HMIS_PARTICIPATION_TYPE IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_3,N,'HMIS_PARTICIPATION_STATUS_START_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_STATUS_START_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_STATUS_START_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE HMIS_PARTICIPATION_STATUS_START_DATE IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_4,N,'HMIS_PARTICIPATION_STATUS_END_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_STATUS_END_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_STATUS_END_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE HMIS_PARTICIPATION_STATUS_END_DATE IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_5,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE DATE_CREATED IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_6,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE DATE_UPDATED IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_7,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE USER_ID IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_8,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,0,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when HMIS_PARTICIPATION_ID||'|'||PROJECT_ID is null then SRC.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||PROJECT_ID end) AS BUSINESS_KEY_VALUE FROM STAGING.PSTG_HMIS_PARTICIPATION SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME ,  (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
CE_PARTICIPATION,CE_PARTICIPATION_1,N,PROJECT_ID DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL OR DOES NOT MATCH A PROJECT_ID IN PROJECT.CSV' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'PROJECT_ID IS NOT IN PROJECT.CSV.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_PROJECT C ON A.PROJECT_ID = C.PROJECT_ID AND A.SOURCE_FILE = C.SOURCE_FILE WHERE C.PROJECT_ID IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_2,N,'ACCESS_POINT IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ACCESS_POINT IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'ACCESS_POINT IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE ACCESS_POINT IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_3,N,'PREVENTION_ASSESSMENT IS NULL UNLESS ACCESS_POINT = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PREVENTION_ASSESSMENT IS NULL UNLESS ACCESS_POINT = 1' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'PREVENTION_ASSESSMENT NULL UNLESS ACCESS_POINT = 1' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE (PREVENTION_ASSESSMENT IS NULL AND ACCESS_POINT = 1) OR (PREVENTION_ASSESSMENT IS NOT NULL AND ACCESS_POINT <> 1)"
CE_PARTICIPATION,CE_PARTICIPATION_4,N,'CRISIS_ASSESSMENT IS NULL UNLESS ACCESS_POINT = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CRISIS_ASSESSMENT IS NULL UNLESS ACCESS_POINT = 1' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'CRISIS_ASSESSMENT NULL UNLESS ACCESS_POINT = 1' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE (CRISIS_ASSESSMENT IS NULL AND ACCESS_POINT = 1) OR (CRISIS_ASSESSMENT IS NOT NULL AND ACCESS_POINT <> 1)"
CE_PARTICIPATION,CE_PARTICIPATION_5,N,'HOUSING_ASSESSMENT IS NULL UNLESS ACCESS_POINT = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HOUSING_ASSESSMENT IS NULL UNLESS ACCESS_POINT = 1' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HOUSING_ASSESSMENT NULL UNLESS ACCESS_POINT = 1' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE (HOUSING_ASSESSMENT IS NULL AND ACCESS_POINT = 1) OR (HOUSING_ASSESSMENT IS NOT NULL AND ACCESS_POINT <> 1)"
CE_PARTICIPATION,CE_PARTICIPATION_6,N,'DIRECT_SERVICES IS NULL UNLESS ACCESS_POINT = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DIRECT_SERVICES IS NULL UNLESS ACCESS_POINT = 1' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DIRECT_SERVICES NULL UNLESS ACCESS_POINT = 1' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE (DIRECT_SERVICES IS NULL AND ACCESS_POINT = 1) OR (DIRECT_SERVICES IS NOT NULL AND ACCESS_POINT <> 1)"
CE_PARTICIPATION,CE_PARTICIPATION_7,N,'RECEIVES_REFERRALS IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'RECEIVES_REFERRALS IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'RECEIVES_REFERRALS IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE RECEIVES_REFERRALS IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_8,N,'CE_PARTICIPATION_STATUS_START_DATE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CE_PARTICIPATION_STATUS_START_DATE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'CE_PARTICIPATION_STATUS_START_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE CE_PARTICIPATION_STATUS_START_DATE IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_9,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE DATE_CREATED IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_10,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE DATE_UPDATED IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_11,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE USER_ID IS NULL"
CE_PARTICIPATION,CE_PARTICIPATION_12,N,'EXPORT_ID DOES NOT MATCH OR IS NULL',,WARNING,1,0,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE,  (case when SRC.CE_PARTICIPATION_ID||'|'||SRC.PROJECT_ID is null then SRC.CE_PARTICIPATION_ID||'|'||SRC.PROJECT_ID else SRC.STG_MD5_HASH_VALUE end) AS BUSINESS_KEY_VALUE FROM STAGING.PSTG_CE_PARTICIPATION SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' TABLE_NAME ,  (case when a.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME,  BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID  AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME,  NULL ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND  EXPORT_EXPORT_ID IS NOT NULL)  THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end  ERROR_MESSAGE FROM  A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID  AND A.SOURCE_EXPORT_ID IS NOT NULL)  OR (A.SOURCE_EXPORT_ID is null)"
CE_PARTICIPATION,CE_PARTICIPATION_13,N,'CE_PARTICIPATION_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CE_PARTICIPATION_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'CE_PARTICIPATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE CE_PARTICIPATION_ID IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_9,N,'HMIS_PARTICIPATION_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE HMIS_PARTICIPATION_ID IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_10,N,'HMIS_PARTICIPATION_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_ID CANNOT EXCEED 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(HMIS_PARTICIPATION_ID)>32"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_11,N,'HMIS_PARTICIPATION_TYPE IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_TYPE IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_TYPE MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(HMIS_PARTICIPATION_TYPE)=FALSE AND TO_CHAR(HMIS_PARTICIPATION_TYPE) NOT LIKE '%.00'"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_12,N,'HMIS_PARTICIPATION_STATUS_START_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_STATUS_START_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_STATUS_START_DATE NOT IN FORMAT YYYY-MM-DD.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(HMIS_PARTICIPATION_STATUS_START_DATE,1,10) NOT LIKE '%____-__-__%'"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_13,N,'HMIS_PARTICIPATION_STATUS_END_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_STATUS_END_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'HMIS_PARTICIPATION_STATUS_END_DATE NOT IN FORMAT YYYY-MM-DD.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(HMIS_PARTICIPATION_STATUS_END_DATE,1,10) NOT LIKE '%____-__-__%'"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_14,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_15,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_16,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'USER_ID CANNOT EXCEED 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_17,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'DATE_DELETED NOT IN FORMAT YYYY-MM-DD HH:MM:SS.' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_18,N,'HMIS_PARTICIPATION_TYPE NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME,(case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HMIS_PARTICIPATION_TYPE NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'HMIS_PARTICIPATION_TYPE CONTAINS AN INVALID VALUE' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON A.HMIS_PARTICIPATION_TYPE = C.VALID_VALUES AND C.LIST_NAME = '2.08.1' WHERE C.VALID_VALUES IS NULL AND A.HMIS_PARTICIPATION_TYPE IS NOT NULL"
CE_PARTICIPATION,CE_PARTICIPATION_14,N,'CE_PARTICIPATION_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CE_PARTICIPATION_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'CE_PARTICIPATION_ID CANNOT EXCEED 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(CE_PARTICIPATION_ID)>32"
CE_PARTICIPATION,CE_PARTICIPATION_15,N,'PROJECT_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'PROJECT_ID CANNOT EXCEED 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(PROJECT_ID)>32"
CE_PARTICIPATION,CE_PARTICIPATION_16,N,'ACCESS_POINT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ACCESS_POINT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'ACCESS_POINT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(ACCESS_POINT)=FALSE AND TO_CHAR(ACCESS_POINT) NOT LIKE '%.00'"
CE_PARTICIPATION,CE_PARTICIPATION_17,N,'PREVENTION_ASSESSMENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PREVENTION_ASSESSMENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'PREVENTION_ASSESSMENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(PREVENTION_ASSESSMENT)=FALSE AND TO_CHAR(PREVENTION_ASSESSMENT) NOT LIKE '%.00'"
CE_PARTICIPATION,CE_PARTICIPATION_18,N,'CRISIS_ASSESSMENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CRISIS_ASSESSMENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'CRISIS_ASSESSMENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(CRISIS_ASSESSMENT)=FALSE AND TO_CHAR(CRISIS_ASSESSMENT) NOT LIKE '%.00'"
CE_PARTICIPATION,CE_PARTICIPATION_19,N,'HOUSING_ASSESSMENT IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HOUSING_ASSESSMENT IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'HOUSING_ASSESSMENT MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(HOUSING_ASSESSMENT)=FALSE AND TO_CHAR(HOUSING_ASSESSMENT) NOT LIKE '%.00'"
CE_PARTICIPATION,CE_PARTICIPATION_20,N,'DIRECT_SERVICES IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DIRECT_SERVICES IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'DIRECT_SERVICES MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(DIRECT_SERVICES)=FALSE AND TO_CHAR(DIRECT_SERVICES) NOT LIKE '%.00'"
CE_PARTICIPATION,CE_PARTICIPATION_21,N,'RECEIVES_REFERRALS IS NOT AN INTEGER',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'RECEIVES_REFERRALS IS NOT AN INTEGER' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'RECEIVES_REFERRALS MUST BE AN INTEGER.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE IS_INTEGER(RECEIVES_REFERRALS)=FALSE AND TO_CHAR(RECEIVES_REFERRALS) NOT LIKE '%.00'"
CE_PARTICIPATION,CE_PARTICIPATION_22,N,'CE_PARTICIPATION_STATUS_START_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CE_PARTICIPATION_STATUS_START_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'CE_PARTICIPATION_STATUS_START_DATE MUST BE IN FORMAT YYYY-MM-DD.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(CE_PARTICIPATION_STATUS_START_DATE,1,10) NOT LIKE '%____-__-__%'"
CE_PARTICIPATION,CE_PARTICIPATION_23,N,'CE_PARTICIPATION_STATUS_END_DATE NOT IN FORMAT YYYY-MM-DD',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CE_PARTICIPATION_STATUS_END_DATE NOT IN FORMAT YYYY-MM-DD' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'CE_PARTICIPATION_STATUS_END_DATE MUST BE IN FORMAT YYYY-MM-DD.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(CE_PARTICIPATION_STATUS_END_DATE,1,10) NOT LIKE '%____-__-__%'"
CE_PARTICIPATION,CE_PARTICIPATION_24,N,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_CREATED NOT IN FORMAT YYYY-MM-DD HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'DATE_CREATED MUST BE IN FORMAT YYYY-MM-DD HH:MM:SS.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_CREATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_CREATED)<>19"
CE_PARTICIPATION,CE_PARTICIPATION_25,N,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'DATE_UPDATED MUST BE IN FORMAT YYYY-MM-DD HH:MM:SS.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_UPDATED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_UPDATED)<>19"
CE_PARTICIPATION,CE_PARTICIPATION_26,N,'USER_ID EXCEEDS 32 CHARACTERS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'USER_ID EXCEEDS 32 CHARACTERS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'USER_ID CANNOT EXCEED 32 CHARACTERS.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE LEN(USER_ID)>32"
CE_PARTICIPATION,CE_PARTICIPATION_27,N,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DATE_DELETED NOT IN FORMAT YYYY-MM-DD  HH:MM:SS' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'DATE_DELETED MUST BE IN FORMAT YYYY-MM-DD HH:MM:SS.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE SUBSTR(DATE_DELETED,1,10) NOT LIKE '%____-__-__%' AND LEN(DATE_DELETED)<>19"
CE_PARTICIPATION,CE_PARTICIPATION_28,N,'ACCESS_POINT NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'ACCESS_POINT NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'ACCESS_POINT CONTAINS AN INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON CAST(CAST(A.ACCESS_POINT AS INTEGER) AS VARCHAR) = C.VALID_VALUES AND C.LIST_NAME = '1.10' WHERE C.VALID_VALUES IS NULL AND A.ACCESS_POINT IS NOT NULL"
CE_PARTICIPATION,CE_PARTICIPATION_29,N,'PREVENTION_ASSESSMENT NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PREVENTION_ASSESSMENT NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'PREVENTION_ASSESSMENT CONTAINS AN INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON CAST(CAST(A.PREVENTION_ASSESSMENT AS INTEGER) AS VARCHAR) = C.VALID_VALUES AND C.LIST_NAME = '1.10' WHERE C.VALID_VALUES IS NULL AND A.PREVENTION_ASSESSMENT IS NOT NULL"
CE_PARTICIPATION,CE_PARTICIPATION_30,N,'CRISIS_ASSESSMENT NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'CRISIS_ASSESSMENT NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'CRISIS_ASSESSMENT CONTAINS AN INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON CAST(CAST(A.CRISIS_ASSESSMENT AS INTEGER) AS VARCHAR) = C.VALID_VALUES AND C.LIST_NAME = '1.10' WHERE C.VALID_VALUES IS NULL AND A.CRISIS_ASSESSMENT IS NOT NULL"
CE_PARTICIPATION,CE_PARTICIPATION_31,N,'HOUSING_ASSESSMENT NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'HOUSING_ASSESSMENT NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'HOUSING_ASSESSMENT CONTAINS AN INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON CAST(CAST(A.HOUSING_ASSESSMENT AS INTEGER) AS VARCHAR) = C.VALID_VALUES AND C.LIST_NAME = '1.10' WHERE C.VALID_VALUES IS NULL AND A.HOUSING_ASSESSMENT IS NOT NULL"
CE_PARTICIPATION,CE_PARTICIPATION_32,N,'DIRECT_SERVICES NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'DIRECT_SERVICES NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'DIRECT_SERVICES CONTAINS AN INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON CAST(CAST(A.DIRECT_SERVICES AS INTEGER) AS VARCHAR) = C.VALID_VALUES AND C.LIST_NAME = '1.10' WHERE C.VALID_VALUES IS NULL AND A.DIRECT_SERVICES IS NOT NULL"
CE_PARTICIPATION,CE_PARTICIPATION_33,N,'RECEIVES_REFERRALS NOT IN HUD LIST',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'RECEIVES_REFERRALS NOT IN HUD LIST' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'RECEIVES_REFERRALS CONTAINS AN INVALID VALUE.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 LEFT JOIN STAGING.RT_HUD_LISTS C ON CAST(CAST(A.RECEIVES_REFERRALS AS INTEGER) AS VARCHAR) = C.VALID_VALUES AND C.LIST_NAME = '1.10' WHERE C.VALID_VALUES IS NULL AND A.RECEIVES_REFERRALS IS NOT NULL"
DISABILITIES ,DISABILITIES_37,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
DISABILITIES ,DISABILITIES_38,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
DISABILITIES ,DISABILITIES_39,N,'INFORMATION_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INFORMATION_DATE IS NULL"
DISABILITIES ,DISABILITIES_40,N,'DISABILITY_TYPE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_TYPE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_TYPE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DISABILITY_TYPE IS NULL"
DISABILITIES ,DISABILITIES_41,N,'DISABILITY_RESPONSE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DISABILITY_RESPONSE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DISABILITY_RESPONSE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DISABILITY_RESPONSE IS NULL"
DISABILITIES ,DISABILITIES_42,N,'TCELL_COUNT_AVAILABLE NULL UNLESS DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_COUNT_AVAILABLE NULL UNLESS DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCellCountAvailable cannot be null when DisabilityType = 8 and DisabilityResponse = 1' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TCELL_COUNT_AVAILABLE IS NULL AND DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1"
DISABILITIES ,DISABILITIES_43,N,'TCELL_COUNT NULL UNLESS TCELL_COUNT_AVAILABLE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_COUNT NULL UNLESS TCELL_COUNT_AVAILABLE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCellCount cannot be null when TCellCountAvailable = 1' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (TCELL_COUNT IS NULL AND TCELL_COUNT_AVAILABLE = 1) OR (TCELL_COUNT IS NOT NULL AND TCELL_COUNT_AVAILABLE <> 1)"
DISABILITIES ,DISABILITIES_44,N,'TCELL_SOURCE IS NULL UNLESS TCELL_COUNT IS NOT NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'TCELL_SOURCE IS NULL UNLESS TCELL_COUNT IS NOT NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'TCellSource cannot be null when TCellCount is populated.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (TCELL_SOURCE IS NULL AND TCELL_COUNT IS NOT NULL) OR (TCELL_SOURCE IS NOT NULL AND TCELL_COUNT IS NULL)"
DISABILITIES ,DISABILITIES_45,N,'VIRAL_LOAD_AVAILABLE NULL UNLESS DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD_AVAILABLE NULL UNLESS DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ViralLoadAvailable cannot be null when DisabilityType = 8 and DisabilityResponse = 1.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE VIRAL_LOAD_AVAILABLE IS NULL AND DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1"
DISABILITIES ,DISABILITIES_46,N,'VIRAL_LOAD NULL UNLESS VIRAL_LOAD_AVAILABLE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD NULL UNLESS VIRAL_LOAD_AVAILABLE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ViralLoad cannot be null when ViralLoadAvailable = 1.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (VIRAL_LOAD IS NULL AND VIRAL_LOAD_AVAILABLE = 1) OR (VIRAL_LOAD IS NOT NULL AND VIRAL_LOAD_AVAILABLE <> 1)"
DISABILITIES ,DISABILITIES_47,N,'VIRAL_LOAD_SOURCE NULL UNLESS VIRAL_LOAD IS NOT NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'VIRAL_LOAD_SOURCE NULL UNLESS VIRAL_LOAD IS NOT NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ViralLoadSource cannot be null when ViralLoad is populated..' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE VIRAL_LOAD_SOURCE IS NULL AND VIRAL_LOAD IS NOT NULL"
DISABILITIES ,DISABILITIES_48,N,'ANTI_RETROVIRAL NULL UNLESS DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'ANTI_RETROVIRAL NULL UNLESS DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'AntiRetroviral cannot be null when DisabilityType = 8 and DisabilityResponse = 1.' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ANTI_RETROVIRAL IS NULL AND DISABILITY_TYPE = 8 AND DISABILITY_RESPONSE = 1"
DISABILITIES ,DISABILITIES_49,N,'DATA_COLLECTION_STAGE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATA_COLLECTION_STAGE IS NULL"
DISABILITIES ,DISABILITIES_50,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_DISABILITIES' TABLE_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then 'STG_MD5_HASH_VALUE' else 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE is null then A.STG_MD5_HASH_VALUE else A.DISABILITIES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE||'|'||A.DISABILITY_TYPE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_DISABILITIES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_26,N,'ENROLLMENT_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'ENROLLMENT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE ENROLLMENT_ID IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_27,N,'PERSONAL_ID IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'PERSONAL_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'PERSONAL_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE PERSONAL_ID IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_28,N,'INFORMATION_DATE IS NULL',,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'INFORMATION_DATE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'INFORMATION_DATE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE INFORMATION_DATE IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_29,N,'EMPLOYMENT_TYPE IS NULL UNLESS EMPLOYED = 1',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'EMPLOYMENT_TYPE IS NULL UNLESS EMPLOYED = 1' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'EMPLOYMENT_TYPE IS NULL UNLESS EMPLOYED = 1' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (EMPLOYMENT_TYPE IS NULL AND EMPLOYED = 1) OR (EMPLOYMENT_TYPE IS NOT NULL AND EMPLOYED <> 1)"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_30,N,'NOT_EMPLOYED_REASON IS NULL UNLESS EMPLOYED = 0',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'NOT_EMPLOYED_REASON IS NULL UNLESS EMPLOYED = 0' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'NOT_EMPLOYED_REASON IS NULL UNLESS EMPLOYED = 0' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE (NOT_EMPLOYED_REASON IS NULL AND EMPLOYED = 0) OR (NOT_EMPLOYED_REASON IS NOT NULL AND EMPLOYED <> 0)"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_31,N,'DATA_COLLECTION_STAGE IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATA_COLLECTION_STAGE IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATA_COLLECTION_STAGE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATA_COLLECTION_STAGE IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_32,N,'DATE_CREATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_CREATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_CREATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_CREATED IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_33,N,'DATE_UPDATED IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'DATE_UPDATED IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE DATE_UPDATED IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_34,N,'USER_ID IS NULL',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, (case when A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE is null then A.STG_MD5_HASH_VALUE else A.EMPLOYMENT_EDUCATION_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.INFORMATION_DATE end) BUSINESS_KEY_VALUE,'USER_ID IS NULL' DESCR, 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, 'USER_ID IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_EMPLOYMENT_EDUCATION a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE USER_ID IS NULL"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_35,N,'EXPORT_ID IS NULL OR DOES NOT MATCH',,WARNING,1,0,1,"WITH A AS (SELECT SRC.EXPORT_ID AS SOURCE_EXPORT_ID, EXPORT.EXPORT_ID AS EXPORT_EXPORT_ID, SRC.SOURCE_FILE AS SOURCE_FILE, SRC.INFORMATION_DATE AS INFORMATION_DATE,  (case when EMPLOYMENT_EDUCATION_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE is null then SRC.STG_MD5_HASH_VALUE else EMPLOYMENT_EDUCATION_ID||'|'||ENROLLMENT_ID||'|'||PERSONAL_ID||'|'||INFORMATION_DATE end) AS BUSINESS_KEY_VALUE FROM  STAGING.PSTG_EMPLOYMENT_EDUCATION SRC join staging.rt_coc_control b on SRC.source_file = b.source_file and b.run_ind = 1  LEFT JOIN STAGING.PSTG_EXPORT EXPORT ON SRC.EXPORT_ID = EXPORT.EXPORT_ID AND SRC.SOURCE_FILE = EXPORT.SOURCE_FILE)  SELECT CURRENT_TIMESTAMP DATE_LOADED, SOURCE_EXPORT_ID AS EXPORT_ID, A.SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' TABLE_NAME ,  (case when A.BUSINESS_KEY_VALUE not like '%|%' then 'STG_MD5_HASH_VALUE' else 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' end) BUSINESS_KEY_FIELD_NAME, BUSINESS_KEY_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end DESCR , 'WARNING' ERROR_LEVEL, 'INFORMATION_DATE' ERROR_DATE_FIELD_NAME, DATE(INFORMATION_DATE) ERROR_DATE_VALUE, CASE WHEN SOURCE_EXPORT_ID IS NULL THEN 'EXPORT_ID IS NULL' WHEN (SOURCE_EXPORT_ID <> EXPORT_EXPORT_ID AND EXPORT_EXPORT_ID IS NOT NULL) THEN 'EXPORT_ID DOES NOT MATCH EXPORT.CSV' end ERROR_MESSAGE FROM A WHERE (A.SOURCE_EXPORT_ID <> A.EXPORT_EXPORT_ID AND A.SOURCE_EXPORT_ID IS NOT NULL) OR (A.SOURCE_EXPORT_ID is null)"
AFFILIATION,AFFILIATION_19,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_AFFILIATION' AS TABLE_NAME, 'AFFILIATION_ID|PROJECT_ID|RES_PROJECT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_AFFILIATION GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
ASSESSMENT,ASSESSMENT_30,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_ASSESSMENT' AS TABLE_NAME, 'ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID|ASSESSMENT_DATE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_ASSESSMENT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
ASSESSMENT_QUESTIONS,ASSESSMENT_QUESTIONS_23,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_ASSESSMENT_QUESTIONS' AS TABLE_NAME, 'ASSESSMENT_QUESTIONS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_ASSESSMENT_QUESTIONS GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
ASSESSMENT_RESULTS,ASSESSMENT_RESULTS_22,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_ASSESSMENT_RESULTS' AS TABLE_NAME, 'ASSESSMENT_RESULTS_ID|ASSESSMENT_ID|ENROLLMENT_ID|PERSONAL_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_ASSESSMENT_QUESTIONS GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
CE_PARTICIPATION,CE_PARTICIPATION_34,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_CE_PARTICIPATION' AS TABLE_NAME, 'CE_PARTICIPATION_ID|PROJECT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_CE_PARTICIPATION GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
CLIENT,CLIENT_127,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_CLIENT' AS TABLE_NAME, 'PERSONAL_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_CLIENT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
CURRENT_LIVING_SITUATION,CURRENT_LIVING_SITUATION_44,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_CURRENT_LIVING_SITUATION' AS TABLE_NAME, 'CURRENT_LIVING_SIT_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|CURRENT_LIVING_SITUATION' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_CURRENT_LIVING_SITUATION GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
DISABILITIES ,DISABILITIES_51,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_DISABILITIES' AS TABLE_NAME, 'DISABILITIES_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE|DISABILITY_TYPE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_DISABILITIES GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
EMPLOYMENT_EDUCATION,EMPLOYMENT_EDUCATION_36,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_EMPLOYMENT_EDUCATION' AS TABLE_NAME, 'EMPLOYMENT_EDUCATION_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_EMPLOYMENT_EDUCATION GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
ENROLLMENT,ENROLLMENT_155,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_ENROLLMENT' AS TABLE_NAME, 'ENROLLMENT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_ENROLLMENT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
EVENT,EVENT_31,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_EVENT' AS TABLE_NAME, 'EVENT_ID|ENROLLMENT_ID|PERSONAL_ID|EVENT_DATE|EVENT' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_EVENT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
EXIT,EXIT_109,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_EXIT' AS TABLE_NAME, 'EXIT_ID|ENROLLMENT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_EXIT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
EXPORT,EXPORT_42,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_EXPORT' AS TABLE_NAME, 'EXPORT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_EXPORT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
FUNDER,FUNDER_58,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_FUNDER' AS TABLE_NAME, 'FUNDER_ID|PROJECT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_FUNDER GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
HEALTH_AND_DV,HEALTH_AND_DV_43,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_HEALTH_AND_DV' AS TABLE_NAME, 'HEALTH_AND_DV_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_HEALTH_AND_DV GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_19,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' AS TABLE_NAME, 'HMIS_PARTICIPATION_ID|PROJECT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_HMIS_PARTICIPATION GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
INCOME_BENEFITS,INCOME_BENEFITS_166,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_INCOME_BENEFITS' AS TABLE_NAME, 'INCOME_BENEFITS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_INCOME_BENEFITS GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
INVENTORY,INVENTORY_49,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_INVENTORY' AS TABLE_NAME, 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_INVENTORY GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
ORGANIZATION,ORGANIZATION_20,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_ORGANIZATION' AS TABLE_NAME, 'ORGANIZATION_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_ORGANIZATION GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
PROJECT,PROJECT_44,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_PROJECT' AS TABLE_NAME, 'PROJECT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_PROJECT GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
PROJECT_COC,PROJECT_COC_29,N,'SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_PROJECT_COC' AS TABLE_NAME, 'PROJECT_COC_ID|PROJECT_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_PROJECT_COC GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
SERVICES,SERVICES_50,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_SERVICES' AS TABLE_NAME, 'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_SERVICES GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
USER,USER_19,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_USER' AS TABLE_NAME, 'USER_ID' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_USER GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
YOUTH_EDUCATION_STATUS,YOUTH_EDUCATION_STATUS_30,N,SOURCE FILE IS EMPTY',,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP AS DATE_LOADED, 'NULL' AS EXPORT_ID, DC.COC_ID AS SOURCE_FILE, 'PSTG_YOUTH_EDUCATION_STATUS' AS TABLE_NAME, 'YOUTH_EDUCATION_STATUS_ID|ENROLLMENT_ID|PERSONAL_ID|INFORMATION_DATE' AS BUSINESS_KEY_FIELD_NAME,'NULL' AS BUSINESS_KEY_VALUE,'SOURCE FILE IS EMPTY' DESCR, 'WARNING' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE, 'SOURCE FILE IS EMPTY.' AS ERROR_MESSAGE FROM EDW.DIM_COC DC FULL JOIN (SELECT SOURCE_FILE, COUNT(*) FROM STAGING.PSTG_YOUTH_EDUCATION_STATUS GROUP BY SOURCE_FILE) PSTG ON DC.COC_ID = PSTG.SOURCE_FILE WHERE PSTG.SOURCE_FILE IS NULL AND DC.COC_SK > 0"
CE_PARTICIPATION,CE_PARTICIPATION_35,N,PROJECT_ID IS NULL',HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_CE_PARTICIPATION' TABLE_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'CE_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.CE_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE,'PROJECT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,'PROJECT_ID CANNOT BE NULL.' ERROR_MESSAGE FROM STAGING.PSTG_CE_PARTICIPATION A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE A.PROJECT_ID IS NULL"
HMIS_PARTICIPATION,HMIS_PARTICIPATION_20,N,PROJECT_ID IS NULL,HIGH PRIORITY,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_HMIS_PARTICIPATION' TABLE_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'HMIS_PARTICIPATION_ID|PROJECT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID is null then  A.STG_MD5_HASH_VALUE else HMIS_PARTICIPATION_ID||'|'||A.PROJECT_ID end) BUSINESS_KEY_VALUE, 'PROJECT_ID IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'NULL' ERROR_DATE_FIELD_NAME, NULL ERROR_DATE_VALUE,  'PROJECT_ID CANNOT BE NULL' ERROR_MESSAGE FROM STAGING.PSTG_HMIS_PARTICIPATION A  join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  WHERE A.PROJECT_ID IS NULL"
INVENTORY,INVENTORY_50,N,COC_CODE IS NULL,,ERROR,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_INVENTORY' TABLE_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then 'STG_MD5_HASH_VALUE' else 'INVENTORY_ID|PROJECT_ID|COC_CODE|HOUSEHOLD_TYPE' end) BUSINESS_KEY_FIELD_NAME, (case when A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE is null then A.STG_MD5_HASH_VALUE else A.INVENTORY_ID||'|'||A.PROJECT_ID||'|'||A.COC_CODE||'|'||A.HOUSEHOLD_TYPE end) BUSINESS_KEY_VALUE,'COC_CODE IS NULL' DESCR, 'ERROR' ERROR_LEVEL, 'INVENTORY_END_DATE' ERROR_DATE_FIELD_NAME, DATE(INVENTORY_END_DATE) ERROR_DATE_VALUE, 'COC_CODE IS NULL' ERROR_MESSAGE FROM STAGING.PSTG_INVENTORY A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE COC_CODE IS NULL"
SERVICES,SERVICES_51,N,BED NIGHTS MUST BE BETWEEN PROJECT OPERATING START AND END DATE,HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE,'PSTG_SERVICES' TABLE_NAME, (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then 'STG_MD5_HASH_VALUE' else  'SERVICES_ID|ENROLLMENT_ID|PERSONAL_ID|DATE_PROVIDED|RECORD_TYPE|TYPE_PROVIDED' end) BUSINESS_KEY_FIELD_NAME, 	 (case when A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED is null then  A.STG_MD5_HASH_VALUE else A.SERVICES_ID||'|'||A.ENROLLMENT_ID||'|'||A.PERSONAL_ID||'|'||A.DATE_PROVIDED||'|'||A.RECORD_TYPE||'|'||A.TYPE_PROVIDED end) BUSINESS_KEY_VALUE, 'BED NIGHTS MUST BE BETWEEN PROJECT OPERATING START AND END DATE' DESCR, 'WARNING' ERROR_LEVEL, 'DATE_PROVIDED' ERROR_DATE_FIELD_NAME, DATE(DATE_PROVIDED) ERROR_DATE_VALUE,  'BED NIGHTS MUST BE BETWEEN PROJECT OPERATING START AND END DATE' ERROR_MESSAGE  FROM STAGING.PSTG_SERVICES A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1  JOIN STAGING.PSTG_ENROLLMENT C ON A.ENROLLMENT_ID = C.ENROLLMENT_ID AND A.SOURCE_FILE = C.SOURCE_FILE JOIN STAGING.PSTG_PROJECT D ON C.PROJECT_ID = D.PROJECT_ID AND C.SOURCE_FILE = D.SOURCE_FILE  WHERE A.RECORD_TYPE = 200 AND DATE(A.DATE_PROVIDED) NOT BETWEEN DATE(D.OPERATING_START_DATE) AND DATE(D.OPERATING_END_DATE)"
ENROLLMENT,ENROLLMENT_156,N,ENROLLMENT_COC IS INCORRECTLY FORMATTED,,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED ,A.EXPORT_ID ,A. SOURCE_FILE ,'PSTG_ENROLLMENT' TABLE_NAME ,(case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME ,(case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE ,'ENROLLMENT_COC IS INCORRECTLY FORMATTED' DESCR ,'WARNING' ERROR_LEVEL ,'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'ENROLLMENT_COC IS INCORRECTLY FORMATTED.' ERROR_MESSAGE FROM STAGING.PSTG_ENROLLMENT A JOIN STAGING.RT_COC_CONTROL B ON A.SOURCE_FILE = B.SOURCE_FILE AND B.RUN_IND = 1 WHERE NOT REGEXP_LIKE(enrollment_coc,'^[A-Za-z]{2}-[[:digit:]]{3}$')"
EXIT,EXIT_110,N,DATE_UPDATED < EXIT_DATE,,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_EXIT' TABLE_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'EXIT_ID|ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.EXIT_ID||'|'||A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.EXIT_ID||'|'||A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'DATE_UPDATED < EXIT_DATE' DESCR, 'WARNING' ERROR_LEVEL, 'EXIT_DATE' ERROR_DATE_FIELD_NAME, DATE(EXIT_DATE) ERROR_DATE_VALUE, 'DATE_UPDATED < EXIT_DATE' ERROR_MESSAGE FROM STAGING.PSTG_EXIT A join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 WHERE TRY_TO_DATE(DATE_UPDATED) < TRY_TO_DATE(EXIT_DATE)"
ENROLLMENT,ENROLLMENT_157,N,HOUSEHOLD STAY EXCEEDS THE 98TH OR 99TH PERCENTILE FOR SIMILAR PROJECT TYPES BASED ON LENGTH OF STAY,,WARNING,1,0,1,"WITH HouseholdStayLengths AS ( SELECT en.enrollment_id, en.source_file, pro.project_type, DATEDIFF(day, try_to_date(en.entry_date), COALESCE(ex.exit_date, exp.export_end_date)) AS StayLength FROM hdis_dev.staging.pstg_enrollment en JOIN hdis_dev.staging.pstg_export exp ON en.export_id = exp.export_id AND en.source_file = exp.source_file JOIN hdis_dev.staging.pstg_project pro ON en.project_id = pro.project_id AND en.source_file = pro.source_file LEFT JOIN hdis_dev.staging.pstg_exit ex ON en.enrollment_id = ex.enrollment_id AND en.source_file = ex.source_file), Percentiles AS ( SELECT project_type, CASE WHEN project_type IN (0,1) THEN PERCENTILE_CONT(0.98) WITHIN GROUP (ORDER BY StayLength) END AS ES_PERCENTILE, CASE WHEN project_type = 2 THEN PERCENTILE_CONT(0.98) WITHIN GROUP (ORDER BY StayLength) END AS TH_PERCENTILE, CASE WHEN project_type = 8 THEN PERCENTILE_CONT(0.98) WITHIN GROUP (ORDER BY StayLength) END AS SH_PERCENTILE, CASE WHEN project_type = 12 THEN PERCENTILE_CONT(0.98) WITHIN GROUP (ORDER BY StayLength) END AS HP_PERCENTILE, CASE WHEN project_type = 13 THEN PERCENTILE_CONT(0.98) WITHIN GROUP (ORDER BY StayLength) END AS RRH_PERCENTILE, CASE WHEN project_type IN (9,10) THEN PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY StayLength) END AS PH_PERCENTILE FROM HouseholdStayLengths GROUP BY project_type) SELECT DISTINCT CURRENT_TIMESTAMP AS DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' AS TABLE_NAME, CASE WHEN A.ENROLLMENT_ID IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'ENROLLMENT_ID' END AS BUSINESS_KEY_FIELD_NAME, CASE WHEN A.ENROLLMENT_ID IS NULL THEN A.STG_MD5_HASH_VALUE ELSE A.ENROLLMENT_ID END AS BUSINESS_KEY_VALUE, 'LENGTH OF STAY EXCEEDS 98TH OR 99TH PERCENTILE FOR APPLICABLE PROJECTS' AS DESCR, 'WARNING' AS ERROR_LEVEL, 'ENTRY_DATE' AS ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) AS ERROR_DATE_VALUE, 'HOUSEHOLD STAY EXCEEDS THE 98TH PERCENTILE WITHIN SIMILAR PROJECT TYPES IN THE SYSTEM FOR ES, TH, SH, HP OR RRH PROJECTS, OR HOUSEHOLD TYPE EXCEEDS THE 99TH PERCENTILES WITHIN SIMILAR PROJECT TYPES IN THE SYSTEM FOR PH (HOUSING ONLY AND HOUSING WITH SERVICES) PROJECT TYPES.' AS ERROR_MESSAGE FROM hdis_dev.staging.pstg_enrollment a JOIN HouseholdStayLengths b ON a.enrollment_id = b.enrollment_id AND a.source_file = b.source_file JOIN staging.rt_coc_control c ON a.source_file = c.source_file AND c.run_ind = 1 JOIN Percentiles p ON p.project_type = b.project_type WHERE (b.project_type IN (0,1) AND b.StayLength > p.ES_PERCENTILE) OR (b.project_type = 2 AND b.StayLength > p.TH_PERCENTILE) OR (b.project_type = 8 AND b.StayLength > p.SH_PERCENTILE) OR (b.project_type = 12 AND b.StayLength > p.HP_PERCENTILE) OR (b.project_type = 13 AND b.StayLength > p.RRH_PERCENTILE) OR (b.project_type IN (9,10) AND b.StayLength > p.PH_PERCENTILE);"
ENROLLMENT,ENROLLMENT_158,N,ACTIVE ES-NBN ENROLLMENTS OLDER THAN 365 DAYS WITHOUT A BED NIGHT OR CURRENT LIVING SITUATION RECORD WITHIN THE LAST 90 DAYS,,WARNING,1,0,1,"select distinct current_timestamp as date_loaded ,en.export_id AS EXPORT_ID ,en.source_file AS SOURCE_FILE ,'PSTG_ENROLLMENT' AS TABLE_NAME ,CASE WHEN en.enrollment_id IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'ENROLLMENT_ID' END AS BUSINESS_KEY_FIELD_NAME ,CASE WHEN en.enrollment_id IS NULL THEN en.stg_md5_hash_value ELSE en.enrollment_id END AS BUSINESS_KEY_VALUE ,'ES-NBN ACTIVE ENROLLMENT ENTERED MORE THAN 365 DAYS AGO AND HAS NO BED NIGHT OR CURRENT LIVING SITUATION RECORD WITHIN 90 DAYS OF REPORT END' as DESCR ,'WARNING' AS ERROR_LEVEL ,'ENTRY_DATE' AS ERROR_DATE_FIELD_NAME ,DATE(en.entry_date) AS ERROR_DATE_VALUE ,'ES-NBN ENROLLMENTS MUST HAVE A BED NIGHT OR CURRENT LIVING SITUATION PROVIDED BEFORE 90 DAYS OF THE REPORT END DATE' as error_message from hdis_dev.staging.pstg_enrollment en join hdis_dev.staging.pstg_project pro on en.project_id = pro.project_id and en.source_file = pro.source_file join hdis_dev.staging.rt_coc_control rt on en.source_file = rt.source_file and rt.run_ind = 1 join hdis_dev.staging.pstg_export exp on en.export_id = exp.export_id and en.source_file = exp.source_file left join hdis_dev.staging.pstg_exit ex on en.enrollment_id = ex.enrollment_id and en.source_file = ex.source_file left join hdis_dev.staging.pstg_current_living_situation cls on en.enrollment_id = cls.enrollment_id and en.source_file = cls.source_file and cls.information_date= (SELECT MAX(cls1.information_date) FROM hdis_dev.staging.pstg_current_living_situation cls1 WHERE cls1.enrollment_id=en.enrollment_id and cls1.source_file=en.source_file)left join hdis_dev.staging.pstg_services ser on en.enrollment_id = ser.enrollment_id and en.source_file = ser.source_file and ser.record_type = 200 and ser.date_provided= (SELECT MAX(s1.date_provided) FROM hdis_dev.staging.pstg_services s1 WHERE en.enrollment_id = s1.enrollment_id AND en.source_file = s1.source_file and s1.record_type = 200)where pro.project_type = 1 and ((ex.exit_date is null and datediff(day,try_to_date(en.entry_date),try_to_date(exp.export_end_date))>= 365) and ((cls.current_living_situation is null or current_living_situation is not null and datediff(day,try_to_date(cls.information_date),try_to_date(exp.export_end_date))>= 90) or (ser.record_type is null or datediff(day,try_to_date(ser.date_provided),try_to_date(exp.export_end_date))>= 90)))"
ENROLLMENT,ENROLLMENT_159,N,"ACTIVE ENROLLMENTS IN STREET OUTREACH, COORDINATED ENTRY, OR SERVICES ONLY PROJECT TYPES >  365 DAYS OLD WITHOUT A CURRENT LIVING SITUATION RECORD WITHIN THE LAST 90 DAYS, OR INACTIVE ENROLLMENTS WITH EXIT DATES WITHIN THE PAST 12 MONTHS AND STAYS OVER 365 DAYS WITHOUT CURRENT LIVING SITUATION RECORDS",,WARNING,1,0,1,"select distinct current_timestamp as date_loaded ,en.export_id AS EXPORT_ID ,en.source_file AS SOURCE_FILE ,'PSTG_ENROLLMENT' AS TABLE_NAME ,CASE WHEN en.enrollment_id IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'ENROLLMENT_ID' END AS BUSINESS_KEY_FIELD_NAME ,CASE WHEN en.enrollment_id IS NULL THEN en.stg_md5_hash_value ELSE en.enrollment_id END AS BUSINESS_KEY_VALUE ,'ENROLLMENTS WITH STREET OUTREACH, COORDINATED ENTRY OR SERVICES ONLY PROJECT TYPES ARE EITHER ACTIVE WITH ENTRY DATES OVER 365 DAYS AGO AND CLS RECORDS OLDER THAN 90 DAYS OR MISSING, OR INACTIVE ENROLLMENTS WITH EXIT DATES WITHIN THE PAST 12 MONTHS WITH STAYS OVER 365 DAYS AND MISSING CLS RECORDS' as DESCR ,'WARNING' AS ERROR_LEVEL ,'ENTRY_DATE' AS ERROR_DATE_FIELD_NAME ,DATE(en.entry_date) AS ERROR_DATE_VALUE ,'ACTIVE ENROLLMENTS WITH ENTRY DATES OVER 365 DAYS AGO MUST HAVE CLS RECORDS UPDATED WITHIN THE LAST 90 DAYS OF REPORT END. INACTIVE ENROLLMENTS WITH EXIT DATES WITHIN THE PAST 12 MONTHS AND STAYS OVER 365 DAYS MUST HAVE CLS RECORDS PRESENT.' as error_message from hdis_dev.staging.pstg_enrollment en join hdis_dev.staging.pstg_project pro on en.project_id = pro.project_id and en.source_file = pro.source_file join hdis_dev.staging.rt_coc_control rt on en.source_file = rt.source_file and rt.run_ind = 1 join hdis_dev.staging.pstg_export exp on en.export_id = exp.export_id and en.source_file = exp.source_file left join hdis_dev.staging.pstg_exit ex on en.enrollment_id = ex.enrollment_id and en.source_file = ex.source_file left join hdis_dev.staging.pstg_current_living_situation cls on en.enrollment_id = cls.enrollment_id and en.source_file = cls.source_file and cls.information_date= (SELECT MAX(cls1.information_date) FROM hdis_dev.staging.pstg_current_living_situation cls1 WHERE cls1.enrollment_id=en.enrollment_id and cls1.source_file=en.source_file)where pro.project_type in (4,6,14) and ((ex.exit_date is null and datediff(day,try_to_date(en.entry_date),try_to_date(exp.export_end_date))>= 365 and (cls.current_living_situation is null or (cls.current_living_situation is not null and datediff(day,try_to_date(cls.information_date),try_to_date(exp.export_end_date))>= 90))) or (ex.exit_date >= DATEADD(month, -12, try_to_date(exp.export_end_date)) and datediff(day,try_to_date(en.entry_date),try_to_date(ex.exit_date))>= 365 and cls.current_living_situation is null))"
FUNDER,FUNDER_59,N,INVALID AB977 OTHER_FUNDER CODE,HIGH PRIORITY,WARNING,1,0,1,"select distinct current_timestamp date_loaded,a.export_id,a.source_file,'PSTG_FUNDER' table_name,(case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'FUNDER_ID|PROJECT_ID' end) business_key_field_name,(case when A.FUNDER_ID||'|'||A.PROJECT_ID is null then A.STG_MD5_HASH_VALUE else A.FUNDER_ID||'|'||A.PROJECT_ID end) business_key_value,'INVALID AB977 OTHER_FUNDER CODE' descr,'WARNING' error_level,(case when end_date is null and start_date is null then 'DATE_UPDATED' when end_date is null then 'START_DATE' else 'END_DATE' end) error_date_field_name,(case when end_date is null and start_date is null then DATE(a.DATE_UPDATED) when end_date is null then DATE(START_DATE) else DATE(END_DATE) end) error_date_value,'OTHER_FUNDER CODE IS ENTERED INCORRECTLY' FROM STAGING.PSTG_FUNDER a join staging.rt_coc_control b on a.source_file = b.source_file and b.run_ind = 1 left join staging.pstg_project c on a.project_id = c.project_id and a.source_file = c.source_file where ((replace(upper(other_funder),' ','') like '%HOMEKEY%' OR replace(upper(other_funder),' ','') like '%NPLH%' OR replace(upper(other_funder),' ','') like '%HHAP%' OR replace(upper(other_funder),' ','') like '%-ERF%' OR replace(upper(other_funder),' ','') like '%BFH%' OR replace(upper(other_funder),' ','') like '%HDAP%' OR replace(upper(other_funder),' ','') like '%-HSP%' OR replace(upper(other_funder),' ','') like '%HOMESAFE%' OR replace(upper(other_funder),' ','') like '%DHCS%' ) AND other_funder not in ('CA-HCD-Homekey','CA-HCD-MHP','CA-HCD-VHHP','CA-HCD-HHCII','CA-HCD-NPLH','CA-County-NPLH','CA-HCFC-HHAP1','CA-HCFC-HHAP2','CA-CALICH-HHAP3','CA-CALICH-HHAP4','CA-HCD-HHAP5','CA-CALICH-ERF1','CA-CALICH-ERF2L','CA-CALICH-ERF2R','CA-CALICH-ERF3L','CA-HCD-ERF3R','CA-CALICH-FHC','CA-CDSS-BFH','CA-CDSS-HDAP','CA-CDSS-HSP','CA-CDSS-HomeSafe','CA-CCCCO-CCHHIP','CA-CALVET-VSSR','CA-DHCS-BHBH'))"
FUNDER,FUNDER_60,N,AB977 OTHER FUNDER DETECTED IN PROJECT_NAME FIELD WHEN OTHER_FUNDER FIELD MISSING PROPERLY FORMATTED AB977 CODE,HIGH PRIORITY,WARNING,1,0,1,"SELECT DISTINCT  current_timestamp AS date_loaded, a.export_id, a.source_file, 'PSTG_FUNDER' AS table_name, CASE  WHEN A.FUNDER_ID || '|' || A.PROJECT_ID IS NULL THEN 'STG_MD5_HASH_VALUE'  ELSE 'FUNDER_ID|PROJECT_ID'  END AS business_key_field_name, CASE WHEN A.FUNDER_ID || '|' || A.PROJECT_ID IS NULL THEN A.STG_MD5_HASH_VALUE  ELSE A.FUNDER_ID || '|' || A.PROJECT_ID  END AS business_key_value, 'AB977 other funder detected in project_name field when other_funder field missing properly formatted AB977 code.' AS descr, 'WARNING' AS error_level, CASE WHEN end_date IS NULL AND start_date IS NULL THEN 'DATE_UPDATED'  WHEN end_date IS NULL THEN 'START_DATE'  ELSE 'END_DATE'  END AS error_date_field_name, CASE  WHEN end_date is NULL AND start_date is NULL THEN DATE(a.DATE_UPDATED)  WHEN end_date is NULL THEN DATE(START_DATE) ELSE DATE(END_DATE) END AS error_date_value, 'AB977 other funder detected in project_name field when other_funder field missing properly formatted AB977 code.' AS error_message FROM STAGING.PSTG_FUNDER a  JOIN staging.rt_coc_control b ON a.source_file = b.source_file AND b.run_ind = 1  LEFT JOIN staging.pstg_project c ON a.project_id = c.project_id AND a.source_file = c.source_file WHERE  ( REPLACE(UPPER(c.project_name), ' ', '') LIKE '%HOMEKEY%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%NPLH%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%HHAP%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%-ERF%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%BFH%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%HDAP%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%-HSP%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%HOMESAFE%'  OR REPLACE(UPPER(c.project_name), ' ', '') LIKE '%DHCS%' )  AND ( REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%HOMEKEY%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%NPLH%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%HHAP%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%-ERF%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%BFH%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%HDAP%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%-HSP%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%HOMESAFE%'  AND REPLACE(UPPER(other_funder), ' ', '') NOT LIKE '%DHCS%' )"
ENROLLMENT,ENROLLMENT_160,N,ENROLLMENT WITH ES-EE PROJECT_TYPE WITH LENGTH OF STAY >= 365,,WARNING,1,0,1,"select distinct current_timestamp as date_loaded,a.export_id AS EXPORT_ID,a.source_file AS SOURCE_FILE,'PSTG_ENROLLMENT' AS TABLE_NAME,CASE WHEN a.enrollment_id IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'ENROLLMENT_ID' END AS BUSINESS_KEY_FIELD_NAME ,CASE WHEN a.enrollment_id IS NULL THEN a.stg_md5_hash_value ELSE a.enrollment_id END AS BUSINESS_KEY_VALUE ,'ENROLLMENT WITH ES-EE PROJECT_TYPE WITH LENGTH OF STAY >= 365' as DESCR ,'WARNING' AS ERROR_LEVEL ,'ENTRY_DATE' AS ERROR_DATE_FIELD_NAME ,DATE(a.entry_date) AS ERROR_DATE_VALUE ,'ENROLLMENT WITH EMERGENCY SHELTER ENTRY EXIT PROJECT_TYPE HAS A LENGTH OF STAY >= 365 DAYS' as error_message from staging.pstg_enrollment a join staging.pstg_project b on a.project_id = b.project_id and a.source_file = b.source_file join staging.pstg_export c on a.export_id = c.export_id and a.source_file = c.source_file join staging.rt_coc_control d on a.source_file = d.source_file and d.run_ind = 1left join hdis_dev.staging.pstg_exit ex on a.enrollment_id = ex.enrollment_id and a.source_file = ex.source_file where project_type=0 and ((ex.exit_date is not null and datediff(day,try_to_date(a.entry_date),try_to_date(ex.exit_date))>= 365)OR(ex.exit_date is null and datediff(day,try_to_date(a.entry_date),try_to_date(c.export_end_date))>= 365))"
ENROLLMENT,ENROLLMENT_161,N,"RRH ENROLLMENT WITH NO MOVE-IN DATE HAS A LENGTH OF STAY OF 730+ DAYS, OR RRH ENROLLMENT HAS A VALID MOVE-IN DATE FROM 730+ DAYS AGO.",,WARNING,1,0,1,"select distinct current_timestamp as date_loaded, a.export_id AS EXPORT_ID, a.source_file AS SOURCE_FILE, 'PSTG_ENROLLMENT' AS TABLE_NAME, CASE WHEN a.enrollment_id IS NULL THEN 'STG_MD5_HASH_VALUE' ELSE 'ENROLLMENT_ID' END AS BUSINESS_KEY_FIELD_NAME ,CASE WHEN a.enrollment_id IS NULL THEN a.stg_md5_hash_value ELSE a.enrollment_id END AS BUSINESS_KEY_VALUE ,'RRH ENROLLMENT WITH NO MOVE-IN DATE HAS A LENGTH OF STAY OF 730+ DAYS, OR RRH ENROLLMENT HAS A VALID MOVE-IN DATE FROM 730+ DAYS AGO.' as DESCR ,'WARNING' AS ERROR_LEVEL ,'ENTRY_DATE' AS ERROR_DATE_FIELD_NAME , DATE(a.entry_date) AS ERROR_DATE_VALUE , 'RRH ENROLLMENT WITH NO MOVE-IN DATE HAS A LENGTH OF STAY OF 730+ DAYS, OR RRH ENROLLMENT HAS A VALID MOVE-IN DATE FROM 730+ DAYS AGO.' as error_message from staging.pstg_enrollment a join staging.pstg_project b on a.project_id = b.project_id and a.source_file = b.source_file join staging.pstg_export c on a.export_id = c.export_id and a.source_file = c.source_file join staging.rt_coc_control d on a.source_file = d.source_file and d.run_ind = 1 left join staging.pstg_exit ex on a.enrollment_id = ex.enrollment_id and a.source_file = ex.source_file where project_type = 13 and ((try_to_date(move_in_date) is null and ((ex.exit_date is not null and datediff(day,try_to_date(a.entry_date), try_to_date(ex.exit_date))>= 730) OR (ex.exit_date is null and datediff(day,try_to_date(a.entry_date), try_to_date(c.export_end_date))>= 730))) OR (try_to_date(move_in_date) is not null and ((ex.exit_date is not null and datediff(day,try_to_date(a.move_in_date), try_to_date(ex.exit_date))>= 730) OR (ex.exit_date is null and datediff(day, try_to_date(a.move_in_date), try_to_date(c.export_end_date))>= 730))))"
ENROLLMENT,ENROLLMENT_162,N,ENROLLMENT TIED TO PROJECT 362 FOR CA-505,,ERROR,1,0,1,"select current_timestamp date_loaded,export_id,source_file,'PSTG_ENROLLMENT' table_name,(case when ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME,(case when ENROLLMENT_ID is null then STG_MD5_HASH_VALUE else ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'ENROLLMENT TIED TO PROJECT 362 FOR CA-505' DESCR,'ERROR' ERROR_LEVEL,'ENTRY_DATE' ERROR_DATE_FIELD_NAME,DATE(ENTRY_DATE) ERROR_DATE_VALUE,'ENROLLMENT TIED TO PROJECT 362 FOR CA-505' ERROR_MESSAGE from staging.pstg_enrollment where project_id = '362' and source_file = 'CA-505'"
PROJECT,PROJECT_45,N,PROJECT 362 FOR CA-505,,ERROR,1,0,1,"select current_timestamp date_loaded,export_id,source_file,'PSTG_PROJECT' table_name,(case when PROJECT_ID is null then 'STG_MD5_HASH_VALUE' else 'PROJECT_ID' end) business_key_field_name,(case when PROJECT_ID is null then STG_MD5_HASH_VALUE else PROJECT_ID end) business_key_value,'PROJECT 362 FOR CA-505' DESCR ,'ERROR' ERROR_LEVEL,'OPERATING_END_DATE' ERROR_DATE_FIELD_NAME,DATE(OPERATING_END_DATE) ERROR_DATE_VALUE,'PROJECT 362 FOR CA-505' ERROR_MESSAGE from staging.pstg_project where project_id = '362' and source_file = 'CA-505'"
ENROLLMENT,ENROLLMENT_163,N,HOUSEHOLDS WITHOUT HEAD OF HOUSEHOLD,HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'HOUSEHOLDS WITHOUT HEAD OF HOUSEHOLD' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'HOUSEHOLD WITHOUT A HEAD OF HOUSEHOLD.' ERROR_MESSAGE from HDIS_DEV.STAGING.PSTG_ENROLLMENT a left join (select distinct HOUSEHOLD_ID, SOURCE_FILE from HDIS_DEV.STAGING.PSTG_ENROLLMENT where RELATIONSHIP_TO_HOH = 1) b on a.HOUSEHOLD_ID = b.HOUSEHOLD_ID and a.SOURCE_FILE = b.SOURCE_FILE where a.household_id is not null and a.source_file is not null and (b.household_id is null or b.source_file is null)"
ENROLLMENT,ENROLLMENT_164,N,MULTIPLE HEAD OF HOUSEHOLD,HIGH PRIORITY,WARNING,1,0,1,"SELECT CURRENT_TIMESTAMP DATE_LOADED, A.EXPORT_ID, A.SOURCE_FILE, 'PSTG_ENROLLMENT' TABLE_NAME, (case when A.ENROLLMENT_ID is null then 'STG_MD5_HASH_VALUE' else 'ENROLLMENT_ID' end) BUSINESS_KEY_FIELD_NAME, (case when A.ENROLLMENT_ID is null then A.STG_MD5_HASH_VALUE else A.ENROLLMENT_ID end) BUSINESS_KEY_VALUE,'MULTIPLE HEAD OF HOUSEHOLD' DESCR, 'WARNING' ERROR_LEVEL, 'ENTRY_DATE' ERROR_DATE_FIELD_NAME, DATE(ENTRY_DATE) ERROR_DATE_VALUE, 'MULTIPLE HEAD OF HOUSEHOLD.' ERROR_MESSAGE from HDIS_DEV.STAGING.PSTG_ENROLLMENT a join (select HOUSEHOLD_ID, SOURCE_FILE from HDIS_DEV.STAGING.PSTG_ENROLLMENT where RELATIONSHIP_TO_HOH = 1 group by HOUSEHOLD_ID, SOURCE_FILE having count(*) > 1) b on a.HOUSEHOLD_ID = b.HOUSEHOLD_ID and a.SOURCE_FILE = b.SOURCE_FILE"
